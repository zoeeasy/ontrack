<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<meta name="author" content="Damien Coraboeuf">
<title>Ontrack Reference Guide 3.1.3</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
</head>
<body id="index" class="book">
<div id="header">
<h1>Ontrack Reference Guide 3.1.3</h1>
<div class="details">
<span id="author" class="author">Damien Coraboeuf</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#installation">1. Installation</a>
<ul class="sectlevel2">
<li><a href="#installation-prerequisites">1.1. Prerequisites</a></li>
<li><a href="#installation-quick-start">1.2. Quick start</a></li>
<li><a href="#installation-postgres">1.3. Postgres database</a></li>
<li><a href="#installation-docker">1.4. Installing using Docker</a>
<ul class="sectlevel3">
<li><a href="#installation-docker-overview">1.4.1. Overview</a></li>
<li><a href="#installation-docker-basic">1.4.2. Basic deployment</a></li>
<li><a href="#installation-docker-compose">1.4.3. Docker Compose deployment</a></li>
</ul>
</li>
<li><a href="#installation-rpm">1.5. RPM installation</a></li>
<li><a href="#installation-debian">1.6. Debian installation</a></li>
<li><a href="#installation-sa">1.7. Standalone installation</a></li>
<li><a href="#configuration">1.8. Configuration</a></li>
</ul>
</li>
<li><a href="#basics">2. Basics</a>
<ul class="sectlevel2">
<li><a href="#projects">2.1. Managing projects</a></li>
<li><a href="#branches">2.2. Managing branches</a>
<ul class="sectlevel3">
<li><a href="#_managing_the_branches_in_the_project_page">2.2.1. Managing the branches in the project page</a></li>
<li><a href="#_branch_templating">2.2.2. Branch templating</a></li>
<li><a href="#branches-stale">2.2.3. Managing stale branches</a></li>
<li><a href="#branches-validation-stamp-filters">2.2.4. Validation stamp filters</a>
<ul class="sectlevel4">
<li><a href="#branches-validation-stamp-filters-usage">Using filters</a></li>
<li><a href="#branches-validation-stamp-filters-editing">Editing filters</a></li>
<li><a href="#branches-validation-stamp-filters-sharing">Sharing</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#validation-stamps">2.3. Managing validation stamps</a>
<ul class="sectlevel3">
<li><a href="#validation-stamps-auto">2.3.1. Auto creation of validation stamps</a>
<ul class="sectlevel4">
<li><a href="#validation-stamps-auto-predefined">Predefined validation stamps</a></li>
<li><a href="#validation-stamps-auto-projects">Configuring projects</a></li>
<li><a href="#validation-stamps-auto-creation">Auto creation of validation stamps</a></li>
<li><a href="#validation-stamps-auto-creation-if-not-predefined">Auto creation of validation stamps when not predefined</a></li>
</ul>
</li>
<li><a href="#validation-stamps-bulk-update">2.3.2. Bulk update of validation stamps</a></li>
</ul>
</li>
<li><a href="#promotion-levels">2.4. Managing promotion levels</a>
<ul class="sectlevel3">
<li><a href="#promotion-levels-auto-promotion">2.4.1. Auto promotion</a></li>
<li><a href="#promotion-levels-auto-creation">2.4.2. Auto creation</a>
<ul class="sectlevel4">
<li><a href="#promotion-levels-auto-creation-predefined">Predefined promotion levels</a></li>
<li><a href="#promotion-levels-auto-creation-projects">Configuring projects</a></li>
<li><a href="#promotion-levels-auto-creation-creation">Auto creation of promotion levels</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#builds">2.5. Managing the builds</a>
<ul class="sectlevel3">
<li><a href="#builds-filtering">2.5.1. Filtering the builds</a>
<ul class="sectlevel4">
<li><a href="#builds-filtering-sharing">Sharing filters</a></li>
</ul>
</li>
<li><a href="#builds-links">2.5.2. Build links</a>
<ul class="sectlevel4">
<li><a href="#builds-links-definition">Definition of links</a></li>
<li><a href="#builds-links-decorations">Decorations</a></li>
<li><a href="#builds-links-querying">Querying</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#properties">2.6. Properties</a>
<ul class="sectlevel3">
<li><a href="#property-message">2.6.1. Message property</a></li>
<li><a href="#property-meta">2.6.2. Meta information property</a>
<ul class="sectlevel4">
<li><a href="#property-meta-input">Input</a></li>
<li><a href="#property-meta-display">Representation</a></li>
<li><a href="#property-meta-query">Querying</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#topics">3. Topics</a>
<ul class="sectlevel2">
<li><a href="#templates">3.1. Branch templates</a>
<ul class="sectlevel3">
<li><a href="#templates-definition">3.1.1. Template Definition</a></li>
<li><a href="#templates-instance">3.1.2. Template Instances</a></li>
<li><a href="#templates-expressions">3.1.3. Template expressions</a>
<ul class="sectlevel4">
<li><a href="#templates-expressions-examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#usage-git">3.2. Working with Git</a>
<ul class="sectlevel3">
<li><a href="#usage-github">3.2.1. Working with GitHub</a>
<ul class="sectlevel4">
<li><a href="#usage-github-config">General configuration</a></li>
<li><a href="#usage-github-project">Project configuration</a></li>
</ul>
</li>
<li><a href="#usage-gitlab">3.2.2. Working with GitLab</a>
<ul class="sectlevel4">
<li><a href="#usage-gitlab-config">General configuration</a></li>
<li><a href="#usage-gitlab-config">Project configuration</a></li>
</ul>
</li>
<li><a href="#usage-bitbucket">3.2.3. Working with BitBucket</a>
<ul class="sectlevel4">
<li><a href="#usage-bitbucket-config">General configuration</a></li>
<li><a href="#usage-bitbucket-config">Project configuration</a></li>
</ul>
</li>
<li><a href="#usage-subversion">3.2.4. Working with Subversion</a>
<ul class="sectlevel4">
<li><a href="#usage-subversion-config">Subversion configurations</a></li>
<li><a href="#usage-subversion-indexation">Indexation</a></li>
<li><a href="#usage-subversion-project">Project configuration</a></li>
<li><a href="#usage-subversion-branch">Branch configuration</a>
<ul class="sectlevel5">
<li><a href="#usage-subversion-link-tag">Tag name</a></li>
<li><a href="#usage-subversion-link-tag-pattern">Tag pattern name</a></li>
<li><a href="#usage-subversion-link-revision">Revision name</a></li>
<li><a href="#usage-subversion-link-revision-pattern">Revision pattern</a></li>
</ul>
</li>
<li><a href="#usage-subversion-build-sync">Build / tag synchronization</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#changelogs">3.3. Change logs</a>
<ul class="sectlevel3">
<li><a href="#changelogs-selection">3.3.1. Selection</a></li>
<li><a href="#changelogs-commits">3.3.2. Commits/revisions</a></li>
<li><a href="#changelogs-issues">3.3.3. Issues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#changelogs-files">4. File changes</a></li>
<li><a href="#administration">5. Administration</a>
<ul class="sectlevel2">
<li><a href="#security">5.1. Security</a>
<ul class="sectlevel3">
<li><a href="#security-concepts">5.1.1. Concepts</a></li>
<li><a href="#security-roles">5.1.2. Roles</a>
<ul class="sectlevel4">
<li><a href="#security-roles-global">Global roles</a></li>
<li><a href="#security-roles-project">Project roles</a></li>
</ul>
</li>
<li><a href="#security-accounts">5.1.3. Accounts</a>
<ul class="sectlevel4">
<li><a href="#security-accounts-builtin">Built-in accounts</a></li>
<li><a href="#security-accounts-ldap">LDAP accounts</a></li>
</ul>
</li>
<li><a href="#security-groups">5.1.4. Account groups</a></li>
<li><a href="#security-general">5.1.5. General settings</a></li>
<li><a href="#security-extending">5.1.6. Extending the security</a></li>
</ul>
</li>
<li><a href="#ldap">5.2. LDAP setup</a>
<ul class="sectlevel3">
<li><a href="#ldap-setup">5.2.1. LDAP general setup</a></li>
<li><a href="#ldap-mapping">5.2.2. LDAP group mapping</a></li>
</ul>
</li>
<li><a href="#admin-console">5.3. Administration console</a>
<ul class="sectlevel3">
<li><a href="#admin-console-jobs">5.3.1. Managing running jobs</a>
<ul class="sectlevel4">
<li><a href="#admin-console-jobs-filter">Filtering the jobs</a></li>
<li><a href="#admin-console-jobs-control">Controlling the jobs</a></li>
</ul>
</li>
<li><a href="#admin-console-health">5.3.2. External connections</a></li>
<li><a href="#admin-console-extensions">5.3.3. List of extensions</a></li>
</ul>
</li>
<li><a href="#admin-log-entries">5.4. Application log messages</a></li>
</ul>
</li>
<li><a href="#integration">6. Integration</a>
<ul class="sectlevel2">
<li><a href="#integration-jenkins">6.1. Integration with Jenkins</a></li>
<li><a href="#monitoring">6.2. Monitoring</a>
<ul class="sectlevel3">
<li><a href="#monitoring-health">6.2.1. Health</a></li>
<li><a href="#monitoring-metrics">6.2.2. Metrics</a>
<ul class="sectlevel4">
<li><a href="#monitoring-metrics-graphite">Export to Graphite</a></li>
<li><a href="#monitoring-metrics-influxdb">Export to InfluxDB</a></li>
<li><a href="#monitoring-metrics-grafana">Grafana dashboard</a></li>
<li><a href="#monitoring-metrics-list">List of metrics</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#integration-graphql">6.3. GraphQL support</a></li>
<li><a href="#integration-graphql-curl">6.4. Calling with Curl</a></li>
<li><a href="#integration-graphql-dsl">6.5. Using the DSL</a></li>
<li><a href="#integration-graphql-graphiql">6.6. GraphiQL support</a></li>
<li><a href="#integration-graphql-extending">6.7. Extending the GraphQL schema</a></li>
<li><a href="#integration-encryption">6.8. Encryption service</a>
<ul class="sectlevel3">
<li><a href="#integration-encryption-selection">6.8.1. Selection of the confidential store</a></li>
<li><a href="#integration-encryption-file">6.8.2. File confidential store</a></li>
<li><a href="#integration-encryption-jdbc">6.8.3. JDBC confidential store</a></li>
<li><a href="#integration-encryption-vault">6.8.4. Vault confidential store</a></li>
<li><a href="#integration-encryption-migration">6.8.5. Migrating encryption keys</a></li>
<li><a href="#integration-encryption-lost">6.8.6. Losing the encryption keys</a></li>
<li><a href="#integration-encryption-extending">6.8.7. Adding custom confidential store</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#dsl">7. DSL</a>
<ul class="sectlevel2">
<li><a href="#dsl-usage">7.1. DSL Usage</a>
<ul class="sectlevel3">
<li><a href="#dsl-usage-embedded">7.1.1. Embedded</a></li>
<li><a href="#dsl-usage-shell">7.1.2. Standalone shell</a></li>
<li><a href="#dsl-usage-connection">7.1.3. Connection</a></li>
<li><a href="#dsl-usage-retry">7.1.4. Retry mechanism</a></li>
<li><a href="#dsl-usage-calling">7.1.5. Calling the DSL</a></li>
</ul>
</li>
<li><a href="#dsl-usecases">7.2. DSL Samples</a>
<ul class="sectlevel3">
<li><a href="#dsl-usecases-security">7.2.1. DSL Security</a>
<ul class="sectlevel4">
<li><a href="#dsl-usecases-security-accounts">Management of accounts</a></li>
<li><a href="#dsl-usecases-security-account-permissions">Account permissions</a></li>
<li><a href="#dsl-usecases-security-account-groups">Management of account groups</a></li>
<li><a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a></li>
<li><a href="#dsl-usecases-ldap-mapping">DSL LDAP mapping</a></li>
</ul>
</li>
<li><a href="#dsl-usecases-images">7.2.2. DSL Images and documents</a></li>
<li><a href="#dsl-usecases-changelogs">7.2.3. DSL Change logs</a>
<ul class="sectlevel4">
<li><a href="#dsl-usecases-changelogs-get">Getting the change log</a></li>
<li><a href="#dsl-usecases-changelogs-commits">Commits</a></li>
<li><a href="#dsl-usecases-changelogs-issues">Issues</a></li>
<li><a href="#dsl-usecases-changelogs-export">Exporting the change log</a></li>
<li><a href="#dsl-usecases-changelogs-files">File changes</a></li>
</ul>
</li>
<li><a href="#dsl-templates">7.2.4. DSL Branch template definitions</a></li>
<li><a href="#dsl-scm">7.2.5. DSL SCM extensions</a></li>
</ul>
</li>
<li><a href="#dsl-tool">7.3. DSL Tool</a></li>
<li><a href="#dsl-reference">7.4. DSL Reference</a></li>
<li><a href="#dsl-samples">7.5. DSL Samples</a></li>
</ul>
</li>
<li><a href="#contributing">8. Contributing</a>
<ul class="sectlevel2">
<li><a href="#contributing-branches">8.1. Branching strategy</a></li>
<li><a href="#development">8.2. Development</a>
<ul class="sectlevel3">
<li><a href="#development-setup">8.2.1. Environment set-up</a>
<ul class="sectlevel4">
<li><a href="#development-postgres">Postgres set-up</a></li>
</ul>
</li>
<li><a href="#development-build">8.2.2. Building locally</a></li>
<li><a href="#development-launch-gradle">8.2.3. Launching the application from the command line</a></li>
<li><a href="#development-launch">8.2.4. Launching the application in the IDE</a></li>
<li><a href="#development-web">8.2.5. Developing for the web</a></li>
<li><a href="#development-test">8.2.6. Running the tests</a></li>
<li><a href="#development-ide">8.2.7. Integration with IDE</a>
<ul class="sectlevel4">
<li><a href="#development-ide-intellij">With Intellij</a></li>
</ul>
</li>
<li><a href="#delivery">8.2.8. Delivery</a>
<ul class="sectlevel4">
<li><a href="#delivery-versioning">Versioning</a></li>
<li><a href="#delivery-deploying">Deploying in production</a></li>
</ul>
</li>
<li><a href="#development-glossary">8.2.9. Glossary</a></li>
</ul>
</li>
<li><a href="#architecture">8.3. Architecture</a>
<ul class="sectlevel3">
<li><a href="#architecture-modules">8.3.1. Modules</a></li>
<li><a href="#architecture-ui">8.3.2. UI</a>
<ul class="sectlevel4">
<li><a href="#architecture-ui-resources">Resources</a></li>
<li><a href="#architecture-ui-decorators">Resource decorators</a></li>
</ul>
</li>
<li><a href="#architecture-ui-forms">8.3.3. Forms</a>
<ul class="sectlevel4">
<li><a href="#architecture-ui-forms-object">Form object</a></li>
<li><a href="#architecture-ui-forms-fields">Fields</a>
<ul class="sectlevel5">
<li><a href="#architecture-ui-forms-fields-common">Common field properties</a></li>
<li><a href="#architecture-ui-forms-fields-help"><code>help</code> property</a></li>
<li><a href="#architecture-ui-forms-fields-visibleIf"><code>visibleIf</code> property</a></li>
<li><a href="#architecture-ui-forms-fields-text"><code>text</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-password"><code>password</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-memo"><code>memo</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-email"><code>email</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-url"><code>url</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-named-entries"><code>namedEntries</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-date"><code>date</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-yes-no"><code>yesno</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-date-time"><code>dateTime</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-int"><code>int</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-selection"><code>selection</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-multi-strings"><code>multi-strings</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-multi-selection"><code>multi-selection</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-multi-form"><code>multi-form</code> field</a></li>
<li><a href="#architecture-ui-forms-fields-custom">Creating your custom fields</a></li>
</ul>
</li>
<li><a href="#architecture-ui-forms-client">Form usage on the client</a></li>
<li><a href="#architecture-ui-forms-fields-rendering">Fields rendering</a></li>
</ul>
</li>
<li><a href="#architecture-model">8.3.4. Model</a></li>
<li><a href="#architecture-model-filtering">8.3.5. Model filtering</a></li>
<li><a href="#architecture-jobs">8.3.6. Jobs</a>
<ul class="sectlevel4">
<li><a href="#architecture-jobs-overview">Job architecture overview</a></li>
<li><a href="#architecture-jobs-registration">Job registration</a></li>
</ul>
</li>
<li><a href="#architecture-encryption">8.3.7. Encryption</a></li>
<li><a href="#architecture-build-filters">8.3.8. Build filters</a>
<ul class="sectlevel4">
<li><a href="#architecture-build-filters-usage">Usage</a></li>
<li><a href="#architecture-build-filters-implementation">Implementation</a></li>
</ul>
</li>
<li><a href="#reference-services">8.3.9. Reference services</a>
<ul class="sectlevel4">
<li><a href="#reference-service-entity-data-store"><code>EntityDataStore</code></a></li>
</ul>
</li>
<li><a href="#architecture-metrics">8.3.10. Metrics</a></li>
<li><a href="#artifacture-technology">8.3.11. Technology</a>
<ul class="sectlevel4">
<li><a href="#artifacture-technology-client">Client side</a></li>
<li><a href="#artifacture-technology-server">Server side</a></li>
<li><a href="#artifacture-technology-layers">Layers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#testing">8.4. Testing</a>
<ul class="sectlevel3">
<li><a href="#testing-unit">8.4.1. Running the unit and integration tests</a></li>
<li><a href="#testing-acceptance">8.4.2. Acceptance tests</a>
<ul class="sectlevel4">
<li><a href="#testing-acceptance-cmd">On the command line</a></li>
<li><a href="#testing-acceptance-ide">From the IDE</a></li>
<li><a href="#testing-acceptance-sa">Standalone mode</a></li>
</ul>
</li>
<li><a href="#testing-dev">8.4.3. Developing tests</a>
<ul class="sectlevel4">
<li><a href="#testing-dev-unit">Unit test context</a></li>
<li><a href="#testing-dev-it">Integration test context</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#extending">8.5. Extending Ontrack</a>
<ul class="sectlevel3">
<li><a href="#extending-preparing">8.5.1. Preparing an extension</a></li>
<li><a href="#extending-id">8.5.2. Extension ID</a></li>
<li><a href="#extending-coding">8.5.3. Coding an extension</a></li>
<li><a href="#extending-options">8.5.4. Extension options</a></li>
<li><a href="#extending-testing">8.5.5. Writing tests for your extension</a></li>
<li><a href="#extending-extensions">8.5.6. List of extension points</a></li>
<li><a href="#extending-running">8.5.7. Running an extension</a>
<ul class="sectlevel4">
<li><a href="#extending-running-gradle">Using Gradle</a></li>
</ul>
</li>
<li><a href="#extending-packaging">8.5.8. Packaging an extension</a></li>
<li><a href="#extending-dependencies">8.5.9. Extension dependencies</a></li>
<li><a href="#extending-deploying">8.5.10. Deploying an extension</a>
<ul class="sectlevel4">
<li><a href="#extending-deploying-docker">Using the Docker image</a></li>
<li><a href="#extending-deploying-os">Using the CentOS or Debian/Ubuntu package</a></li>
<li><a href="#extending-deploying-sa">In standalone mode</a></li>
</ul>
</li>
<li><a href="#extending-properties">8.5.11. Extending properties</a>
<ul class="sectlevel4">
<li><a href="#extending-properties-java">Java components</a></li>
<li><a href="#extending-properties-web">Web components</a></li>
</ul>
</li>
<li><a href="#extending-decorators">8.5.12. Extending decorators</a>
<ul class="sectlevel4">
<li><a href="#extending-decorators-java">Java components</a></li>
<li><a href="#extending-decorators-web">Web components</a></li>
</ul>
</li>
<li><a href="#extending-usermenu">8.5.13. Extending the user menu</a>
<ul class="sectlevel4">
<li><a href="#extending-usermenu-component">Extension component</a></li>
</ul>
</li>
<li><a href="#extending-pages">8.5.14. Extending pages</a>
<ul class="sectlevel4">
<li><a href="#extending-pages-menus">Extension menus</a>
<ul class="sectlevel5">
<li><a href="#extending-pages-menus-global">From the global user menu</a></li>
<li><a href="#extending-pages-menus-entity">From an entity page</a></li>
</ul>
</li>
<li><a href="#extending-pages-global">Extension global settings</a></li>
<li><a href="#extending-pages-specific">Extension page</a></li>
<li><a href="#extending-pages-api">Extension API</a></li>
<li><a href="#extending-pages-resources">Extension API resource decorators</a></li>
</ul>
</li>
<li><a href="#extending-event-types">8.5.15. Extending event types</a></li>
<li><a href="#extending-graphql">8.5.16. Extending GraphQL</a>
<ul class="sectlevel4">
<li><a href="#extending-graphql-module">Preparing the extension</a></li>
<li><a href="#extending-graphql-types">Custom types</a></li>
<li><a href="#extending-graphql-queries">Root queries</a></li>
<li><a href="#extending-graphql-fields">Extra fields</a></li>
<li><a href="#extending-graphql-scalars">Built-in scalar fields</a></li>
<li><a href="#extending-graphql-testing">Testing GraphQL</a></li>
</ul>
</li>
<li><a href="#extending-metrics">8.5.17. Extending metrics</a></li>
<li><a href="#extending-kotlin">8.5.18. Using Kotlin in extensions</a></li>
<li><a href="#extending-settings">8.5.19. Extending the settings</a></li>
<li><a href="#extending-security">8.5.20. Extending the security</a>
<ul class="sectlevel4">
<li><a href="#extending-security-functions">Adding functions</a></li>
<li><a href="#extending-security-roles">Adding roles</a></li>
</ul>
</li>
<li><a href="#extending-encryption">8.5.21. Extending confidential stores</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#appendixes">9. Appendixes</a>
<ul class="sectlevel2">
<li><a href="#configuration-properties">9.1. Configuration properties</a></li>
<li><a href="#appendix-deprecations">9.2. Deprecations and migration notes</a>
<ul class="sectlevel3">
<li><a href="#appendix-deprecations-2.28">9.2.1. Since 2.28</a></li>
<li><a href="#appendix-deprecations-2.16">9.2.2. Since 2.16</a></li>
</ul>
</li>
<li><a href="#roadmap">9.3. Roadmap</a>
<ul class="sectlevel3">
<li><a href="#roadmap-jpa">9.3.1. Use JPA / Hibernate for SQL queries</a></li>
<li><a href="#roadmap-neo4j">9.3.2. Using Neo4J as backend</a></li>
<li><a href="#roadmap-dsl">9.3.3. Global DSL</a></li>
<li><a href="#roadmap-webhooks">9.3.4. Web hooks</a></li>
</ul>
</li>
<li><a href="#appendix-certificates">9.4. Certificates</a>
<ul class="sectlevel3">
<li><a href="#appendix-certificates-registration">9.4.1. Registering a certificate in the JDK</a></li>
<li><a href="#appendix-certificates-saving">9.4.2. Saving the certificate on MacOS</a></li>
</ul>
</li>
<li><a href="#migration-postgres">9.5. Migration from H2 to Postgres</a>
<ul class="sectlevel3">
<li><a href="#migration-postgres-prerequisites">9.5.1. Prerequisites</a></li>
<li><a href="#migration-postgres-tool">9.5.2. Migration tool</a></li>
<li><a href="#migration-postgres-run">9.5.3. Running the migration</a></li>
<li><a href="#migration-postgres-options">9.5.4. Migration tool options</a></li>
<li><a href="#migration-postgres-options">9.5.5. Secret files</a></li>
</ul>
</li>
<li><a href="#appendix-postgres-flyway">9.6. Postgres and Flyway</a></li>
<li><a href="#postgres-production-data">9.7. Using production data</a></li>
<li><a href="#dsl-doc">9.8. DSL Reference</a>
<ul class="sectlevel3">
<li><a href="#dsl-ontrack">9.8.1. Ontrack</a></li>
<li><a href="#dsl-abstractprojectresource">9.8.2. AbstractProjectResource</a></li>
<li><a href="#dsl-abstractresource">9.8.3. AbstractResource</a></li>
<li><a href="#dsl-account">9.8.4. Account</a></li>
<li><a href="#dsl-accountgroup">9.8.5. AccountGroup</a></li>
<li><a href="#dsl-admin">9.8.6. Admin</a></li>
<li><a href="#dsl-authenticationsource">9.8.7. AuthenticationSource</a></li>
<li><a href="#dsl-branch">9.8.8. Branch</a></li>
<li><a href="#dsl-build">9.8.9. Build</a></li>
<li><a href="#dsl-config">9.8.10. Config</a></li>
<li><a href="#dsl-document">9.8.11. Document</a></li>
<li><a href="#dsl-groupmapping">9.8.12. GroupMapping</a></li>
<li><a href="#dsl-ldapsettings">9.8.13. LDAPSettings</a></li>
<li><a href="#dsl-predefinedpromotionlevel">9.8.14. PredefinedPromotionLevel</a></li>
<li><a href="#dsl-predefinedvalidationstamp">9.8.15. PredefinedValidationStamp</a></li>
<li><a href="#dsl-project">9.8.16. Project</a></li>
<li><a href="#dsl-projectentityproperties">9.8.17. ProjectEntityProperties</a></li>
<li><a href="#dsl-promotionlevel">9.8.18. PromotionLevel</a></li>
<li><a href="#dsl-promotionrun">9.8.19. PromotionRun</a></li>
<li><a href="#dsl-searchresult">9.8.20. SearchResult</a></li>
<li><a href="#dsl-validationrun">9.8.21. ValidationRun</a></li>
<li><a href="#dsl-validationstamp">9.8.22. ValidationStamp</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="installation"><a class="anchor" href="#installation"></a>1. Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are several ways to install Ontrack.</p>
</div>
<div class="sect2">
<h3 id="installation-prerequisites"><a class="anchor" href="#installation-prerequisites"></a>1.1. Prerequisites</h3>
<div class="paragraph">
<p>Ontrack has been tested on different Linux variants (Ubuntu, Debian, CentOS)
and should also work on Windows.</p>
</div>
<div class="paragraph">
<p>Ontrack relies on at least a JDK 8 build 25. More recent versions of the JDK8
are OK. However, no test has been done yet using early JDK 9 versions.</p>
</div>
<div class="paragraph">
<p>Ontrack runs fine with 512 Mb of memory. However, think of upgrading to 2 Gb of
memory if you intend to host a lot of projects. See the different installation
modes (Docker, RPM, etc.) to know how to setup the memory settings.</p>
</div>
<div class="paragraph">
<p>Ontrack stores its data in a Postgres database.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-quick-start"><a class="anchor" href="#installation-quick-start"></a>1.2. Quick start</h3>
<div class="paragraph">
<p>The fastest way to start Ontrack is to use <a href="#installation-docker-compose">Docker Compose</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-postgres"><a class="anchor" href="#installation-postgres"></a>1.3. Postgres database</h3>
<div class="paragraph">
<p>Unless you choose to deploy with <a href="#installation-docker-compose">Docker Compose</a>,
you will need to have a Postgres database accessible by Ontrack.</p>
</div>
<div class="paragraph">
<p>Version 9.5 of Postgres has been tested successfully with Ontrack, but
any later 9.x version should be OK as well.</p>
</div>
<div class="paragraph">
<p>No test with Postgres 10.x has been performed yet.</p>
</div>
<div class="paragraph">
<p>Ontrack will by default try to connect to
<code>jdbc:postgresql://postgresql/ontrack</code>, using <code>ontrack / ontrack</code>
as credentials.</p>
</div>
<div class="paragraph">
<p>Those parameters can be configured using normal Spring Boot JDBC <a href="#configuration">configuration</a>,
for example using arguments at startup:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>--spring.datasource.url=jdbc:postgresql://localhost:5432/ontrack
--spring.datasource.username=myuser
--spring.datasource.password=password</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://docs.spring.io/spring-boot/docs/1.5.8.RELEASE/reference/htmlsingle/#boot-features-external-config">Spring Boot documentation</a>
to see other and better ways to pass
those <a href="#configuration">configuration</a> parameters.</p>
</div>
</div>
<div class="sect2">
<h3 id="installation-docker"><a class="anchor" href="#installation-docker"></a>1.4. Installing using Docker</h3>
<div class="paragraph">
<p>Ontrack is distributed as a Docker image on the <a href="https://hub.docker.com">Docker Hub</a>, as <code>nemerosa/ontrack:3.1.3</code>.</p>
</div>
<div class="sect3">
<h4 id="installation-docker-overview"><a class="anchor" href="#installation-docker-overview"></a>1.4.1. Overview</h4>
<div class="paragraph">
<p>The Ontrack image exposes the ports <code>443</code> and <code>8080</code>.</p>
</div>
<div class="paragraph">
<p>Two volumes are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/var/ontrack/data</code> - contains some working files but also the log files.</p>
</li>
<li>
<p><code>/var/ontrack/conf</code> - contains the <a href="#configuration-properties">configuration files</a> for Ontrack (see later).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="installation-docker-basic"><a class="anchor" href="#installation-docker-basic"></a>1.4.2. Basic deployment</h4>
<div class="paragraph">
<p>You can start Ontrack as a container and a shared database and configuration on the host using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run --detach \
   --publish=8080:8080 \
   --volume=/var/ontrack/data:/var/ontrack/data \
   --volume=/var/ontrack/conf:/var/ontrack/conf \
   nemerosa/ontrack</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#configuration">configuration files</a> for Ontrack can be put on the host in
<code>/var/ontrack/conf</code> and the database and working files will be available
in <code>/var/ontrack/data</code>. The application will be available on port <code>8080</code> of
the host.</p>
</div>
<div class="paragraph">
<p>Java options, like memory settings, can be passed to the Docker container using
the <code>JAVA_OPTIONS</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run \
   ...
   --env "JAVA_OPTIONS=-Xmx2048m" \
   ...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="installation-docker-compose"><a class="anchor" href="#installation-docker-compose"></a>1.4.3. Docker Compose deployment</h4>
<div class="paragraph">
<p>Create the following file:</p>
</div>
<div class="listingblock">
<div class="title">docker-compose.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">version: "2.1"

services:
  # Ontrack container
  ontrack:
    image: nemerosa/ontrack:3
    environment:
        PROFILE: prod
    links:
      - "postgresql:postgresql"
    ports:
      - "8080:8080"

  # Postgresql database
  postgresql:
    image: postgres:9.5.2
    environment:
      POSTGRES_DB      : ontrack
      POSTGRES_USER    : ontrack
      POSTGRES_PASSWORD: ontrack
    ports:
      - "5432"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the same directory, run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker-compose up -d</code></pre>
</div>
</div>
<div class="paragraph">
<p>After some time, Ontrack becomes available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation-rpm"><a class="anchor" href="#installation-rpm"></a>1.5. RPM installation</h3>
<div class="paragraph">
<p>You can install Ontrack using a RPM file you can download from the
<a href="https://github.com/nemerosa/ontrack/releases">releases</a> page.</p>
</div>
<div class="paragraph">
<p>The RPM is continuously tested on CentOS 6.7 and CentOS 7.1.</p>
</div>
<div class="paragraph">
<p>To install Ontrack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">rpm -i ontrack.rpm</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following directories are created:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binaries and scripts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Working and <a href="#configuration-properties">configuration</a> directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logging directory</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You can optionally create an <code>application.yml</code> configuration file in
<code>/usr/lib/ontrack</code>. For example, to customise the port Ontrack is running on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">server:
  port: 9080</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ontrack is installed as a service using <code>/etc/init.d/ontrack</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash"># Starting Ontrack
service ontrack start
# Status of Ontrack
service ontrack status
# Stopping Ontrack
service ontrack stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>To upgrade Ontrack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash"># Stopping Ontrack
sudo service ontrack stop
# Updating
sudo rpm --upgrade ontrack.rpm
# Starting Ontrack
sudo service ontrack start</code></pre>
</div>
</div>
<div class="paragraph">
<p>The optional <code>/etc/default/ontrack</code> file can be used to define the
<code>JAVA_OPTIONS</code>, for example:</p>
</div>
<div class="listingblock">
<div class="title">/etc/default/ontrack</div>
<div class="content">
<pre class="prettyprint highlight"><code>JAVA_OPTIONS=-Xmx2048m</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation-debian"><a class="anchor" href="#installation-debian"></a>1.6. Debian installation</h3>
<div class="paragraph">
<p>You can install Ontrack using a Debian file (<code>.deb</code>) you can download from the
<a href="https://github.com/nemerosa/ontrack/releases">releases</a> page.</p>
</div>
<div class="paragraph">
<p>To install Ontrack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">dpkg -i ontrack.deb</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following directories are created:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Directory</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/opt/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binaries and scripts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/lib/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Working and <a href="#configuration-properties">configuration</a> directory</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logging directory</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Ontrack is installed as a service using <code>/etc/init.d/ontrack</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash"># Starting Ontrack
service ontrack start
# Status of Ontrack
service ontrack status
# Stopping Ontrack
service ontrack stop</code></pre>
</div>
</div>
<div class="paragraph">
<p>The optional <code>/etc/default/ontrack</code> file can be used to define the
<code>JAVA_OPTIONS</code>, for example:</p>
</div>
<div class="listingblock">
<div class="title">/etc/default/ontrack</div>
<div class="content">
<pre class="prettyprint highlight"><code>JAVA_OPTIONS=-Xmx2048m</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation-sa"><a class="anchor" href="#installation-sa"></a>1.7. Standalone installation</h3>
<div class="paragraph">
<p>Ontrack can be downloaded as a JAR and started as a Spring Boot application.</p>
</div>
<div class="paragraph">
<p>Download the JAR from the
<a href="https://github.com/nemerosa/ontrack/releases">Ontrack release page</a></p>
</div>
<div class="paragraph">
<p>Start it using <code>java -jar ontrack.jar</code>.</p>
</div>
<div class="paragraph">
<p><a href="#configuration">Options</a> can be passed on the command line.</p>
</div>
</div>
<div class="sect2">
<h3 id="configuration"><a class="anchor" href="#configuration"></a>1.8. Configuration</h3>
<div class="paragraph">
<p>As a regular <a href="http://projects.spring.io/spring-boot/">Spring Boot application</a>,
Ontrack can be configured using system properties and/or property files and/or
YAML files. See the
<a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-properties-and-configuration">Spring Boot documentation</a>
for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The way to provide a YAML <code>application.yml</code> configuration file or
command line arguments will vary
according to the installation (Docker, RPM, etc.). See the corresponding
section above for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, to setup the port Ontrack is running on, you can use the
<code>server.port</code> property. Using a YAML file:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">server.port=9999</code></pre>
</div>
</div>
<div class="paragraph">
<p>or the command line option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">--server.port=9999</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#configuration-properties">Configuration properties</a> for the list of all available properties.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="basics"><a class="anchor" href="#basics"></a>2. Basics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="projects"><a class="anchor" href="#projects"></a>2.1. Managing projects</h3>

</div>
<div class="sect2">
<h3 id="branches"><a class="anchor" href="#branches"></a>2.2. Managing branches</h3>
<div class="paragraph">
<p>Several <a href="#model">branches</a> can be defined per <a href="#projects">project</a>.</p>
</div>
<div class="sect3">
<h4 id="_managing_the_branches_in_the_project_page"><a class="anchor" href="#_managing_the_branches_in_the_project_page"></a>2.2.1. Managing the branches in the project page</h4>
<div class="paragraph">
<p>If you click on the <em>Show all branches</em> button in the project page, you can
display all the branches, including the ones being disabled and the
<a href="#templates">templates</a>.</p>
</div>
<div class="paragraph">
<p>According to your authorizations, the following commands will be displayed as
icons just on the right of the branch name, following any other decoration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>disabling the branch</p>
</li>
<li>
<p>enabling the branch</p>
</li>
<li>
<p>deleting the branch</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/project-page-branch-management.png" alt="Branch commands" width="600">
</div>
</div>
<div class="paragraph">
<p>This allows you to have a quick access to the management of the branches in a
project. Only the deletion of a branch will prompt you about your decision.</p>
</div>
</div>
<div class="sect3">
<h4 id="_branch_templating"><a class="anchor" href="#_branch_templating"></a>2.2.2. Branch templating</h4>
<div class="paragraph">
<p>In a context where branches are numerous, because the workflow you&#8217;re working
with implies the creation of many branches (feature branches, release branches,
&#8230;&#8203;), each
of them associated with its own pipeline, creating the branches by hand, even
by cloning or copying them would be too much an effort.</p>
</div>
<div class="paragraph">
<p>Ontrack gives the possibility to create <em>branch templates</em> and to
automatically create branches using this template according to a list of
branches. This list of branches
can either be static or provided by the SCM.</p>
</div>
<div class="paragraph">
<p>See <a href="#templates">Branch templates</a> for details about using this feature.</p>
</div>
</div>
<div class="sect3">
<h4 id="branches-stale"><a class="anchor" href="#branches-stale"></a>2.2.3. Managing stale branches</h4>
<div class="paragraph">
<p>By default, Ontrack will keep all the branches of a project forever. This can
lead to a big number of branches to be displayed.</p>
</div>
<div class="paragraph">
<p>You can configure a project to <em>disable</em> branches after a given number of
days has elapsed since the last build, and then to <em>delete</em> them after an
additional number of days has elapsed again.</p>
</div>
<div class="paragraph">
<p>To configure this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>go to the project page</p>
</li>
<li>
<p>select the <em>Stale branches</em> property and add it:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-stale-selection.png" alt="Stale property" width="400">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>set the number of days before disabling and the number of days before deleting</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-stale-dialog.png" alt="Stale dialog" width="400">
</div>
</div>
<div class="paragraph">
<p>If the <em>disabling</em> days are set to 0, no branch will be ever disabled or
deleted.</p>
</div>
<div class="paragraph">
<p>If the <em>deleting</em> days are set to 0, no branch will ever be deleted.</p>
</div>
<div class="paragraph">
<p>You can also set a list of <a href="#model">promotion levels</a> - a branch which is or has been promoted to such
a promotion level will not be eligible for being disabled or deleted.</p>
</div>
<div class="paragraph">
<p>In the sample above, the stale branches will be disabled after 60 days (not
shown any longer by default), and after again 300 days, they will be deleted
(so after 360 days in total). Branches which have at least one build being promoted to <code>PRODUCTION</code> will not
be deleted or disabled.s</p>
</div>
<div class="paragraph">
<p>Note that the <em>Stale branches</em> property can also be set programmatically using
the <a href="#dsl-projectproperties-stale">DSL</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="branches-validation-stamp-filters"><a class="anchor" href="#branches-validation-stamp-filters"></a>2.2.4. Validation stamp filters</h4>
<div class="paragraph">
<p>When a branch defines many validation stamps, the view can become cluttered
and not really useful any longer, because displaying too much information.</p>
</div>
<div class="paragraph">
<p><em>Validation stamp filters</em> can be defined to restrict the view to a set
of known validation stamps.</p>
</div>
<div class="sect4">
<h5 id="branches-validation-stamp-filters-usage"><a class="anchor" href="#branches-validation-stamp-filters-usage"></a>Using filters</h5>
<div class="paragraph">
<p>Validation stamp filters can be selected in the branch view, just on the left
of the list of validation stamp headers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-selection.png" alt="Selection of validation stamp filter">
</div>
</div>
<div class="paragraph">
<p>When a filter is selected, it is marked as such and only associated
validation stamp columns are shown in the view:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-selected.png" alt="Validation stamp filter selected">
</div>
</div>
<div class="paragraph">
<p>The validation stamp filter menu is also marked in orange to indicate that
a filter has been applied.</p>
</div>
<div class="paragraph">
<p>When the filter is applied, its name appears also in the URL. This can be used
as a permalink:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-permalink.png" alt="Validation stamp filter permalink" width="300px">
</div>
</div>
<div class="paragraph">
<p>You can remove the filter by selecting <em>Clear validation stamp filter</em> in the
filter menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-clear.png" alt="Clear the validation stamp filter" width="250px">
</div>
</div>
</div>
<div class="sect4">
<h5 id="branches-validation-stamp-filters-editing"><a class="anchor" href="#branches-validation-stamp-filters-editing"></a>Editing filters</h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Only authorized users are allowed to edit the validation stamp filters
for a branch.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A validation stamp filter is defined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a name</p>
</li>
<li>
<p>a list of validation stamp names to include</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While it is possible to edit a filter using a dialog (see later), it is far
easier to use the in-place editor.</p>
</div>
<div class="paragraph">
<p>Start by creating a validation stamp filter by selecting the <em>New Filter&#8230;&#8203;</em>
entry in the filter menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-new.png" alt="New validation stamp filter" width="250px">
</div>
</div>
<div class="paragraph">
<p>This displays a dialog to create the new filter:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-dialog-new.png" alt="New validation stamp filter dialog" width="350px">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Only the name is required and all current validation stamps filters are
included by default.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When created, the filter can be directly edited in-place:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-inplace.png" alt="In-place edition">
</div>
</div>
<div class="paragraph">
<p>The following actions are possible:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by clicking on the <em>Select none</em> button, no validation stamps is associated
with the filter.</p>
</li>
<li>
<p>by clicking on the <em>Select all</em> button, all validation stamps are associated
with the filter.</p>
</li>
<li>
<p>by clicking on the <em>Done with edition</em> button, the in-place edition stops
and the normal display is resumed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also click on a validation stamp to remove it or to add it to the
filter.</p>
</div>
<div class="paragraph">
<p>In case the validation stamp is associated with the filter, a <em>minus</em> icon
appears close to its name. It it is not associated, the icon is dimmed and
a plus icon appears:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-inplace-icons.png" alt="In-place edition icons">
</div>
</div>
<div class="paragraph">
<p>Note that you can also stop the edition by selecting the eye icon in the
menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-inplace-stop.png" alt="Stopping in-place edition" width="250px">
</div>
</div>
<div class="paragraph">
<p>To start editing an existing filter, just click also on the eye icon close
to its name:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-inplace-start.png" alt="Starting in-place edition" width="250px">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Select any other filter, or removing the filter, will also
stop the in-place edition.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To edit a filter directly, you can also select the pencil icon and edit the
filter using a dialog:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-edit.png" alt="Editing" width="250px">
</div>
</div>
<div class="paragraph">
<p>This displays an edition dialog allowing to change the name and the list
of validation stamps.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-dialog-edit.png" alt="Editing" width="350px">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a filter associated with a branch (see below,
   <a href="#branches-validation-stamp-filters-sharing">sharing</a>), names can be
   selected among the validation stamps of the branch.</p>
</div>
<div class="paragraph">
<p>For a filter associated with a project, the list of validation stamps for <em>all</em>
the branches is available.</p>
</div>
<div class="paragraph">
<p>For a <em>global</em> filter, names are no longer selected but must be edited.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally, to delete a filter, click on the trash icon:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-delete.png" alt="Delete" width="250px">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A confirmation will be asked before the deletion actually occurs.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="branches-validation-stamp-filters-sharing"><a class="anchor" href="#branches-validation-stamp-filters-sharing"></a>Sharing</h5>
<div class="paragraph">
<p>A filter is created by default at branch level and is only visible when the
associated branch is displayed.</p>
</div>
<div class="paragraph">
<p>An authorized user can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>share the filter at project level - in this case, the filter is
available for all the branches of the project</p>
</li>
<li>
<p>share the filter at global level - in this case, the filter is
available for all projects and all branches</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A filter shared at project level is shown with a <code>[P]</code> close to its name
and a global filter with a <code>[G]</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-shared.png" alt="Shared" width="250px">
</div>
</div>
<div class="paragraph">
<p>In the screenshot above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DEPLOYMENT</code> is associated with the current branch</p>
</li>
<li>
<p><code>DOCUMENTATION</code> is associated with the project</p>
</li>
<li>
<p>the other filters are global</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To share a filter at project level, click on the share icon:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-share-project.png" alt="Share project" width="250px">
</div>
</div>
<div class="paragraph">
<p>To share a filter at global level, click on the share icon:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/vsf-share-global.png" alt="Share global" width="250px">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="validation-stamps"><a class="anchor" href="#validation-stamps"></a>2.3. Managing validation stamps</h3>
<div class="sect3">
<h4 id="validation-stamps-auto"><a class="anchor" href="#validation-stamps-auto"></a>2.3.1. Auto creation of validation stamps</h4>
<div class="paragraph">
<p>Creating the validation stamps for each branch, or making sure they are
always up to date, can be a non trivial task. Having mechanisms like cloning
or <a href="#templates">templates</a> can help, but then one must still make sure
the list of validation stamps in the template is up to date and than the
template is regularly synchronized.</p>
</div>
<div class="paragraph">
<p>Another approach is to allow projects to create automatically the validation
stamps on demand, whenever a build is validated. This must of course be
authorised at project level and a list of predefined validation stamps must be
maintained globally.</p>
</div>
<div class="sect4">
<h5 id="validation-stamps-auto-predefined"><a class="anchor" href="#validation-stamps-auto-predefined"></a>Predefined validation stamps</h5>
<div class="paragraph">
<p>The management of predefined validation stamps is accessible to any
<em>Administrator</em>, in his user menu.</p>
</div>
<div class="paragraph">
<p>He can create, edit and delete predefined validation stamps, and associate
images with them.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Deleting a predefined validation stamp has no impact on the ones which
were created from it in the branches. No link is kept between the validation
stamps in the branches and the predefined ones.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="validation-stamps-auto-projects"><a class="anchor" href="#validation-stamps-auto-projects"></a>Configuring projects</h5>
<div class="paragraph">
<p>By default, a project does not authorise the automatic creation of a validation
stamp. In case one attempts to validate a build using a non existing validation
stamp, an error would be thrown.</p>
</div>
<div class="paragraph">
<p>In order to enable this feature on a project, add the <em>Auto validation stamps</em>
property to the project and set <em>Auto creation</em> to <em>Yes</em>.</p>
</div>
<div class="paragraph">
<p>Disabling the auto creation can be done either by setting <em>Auto creation</em> to
<em>No</em> or by removing the property altogether.</p>
</div>
</div>
<div class="sect4">
<h5 id="validation-stamps-auto-creation"><a class="anchor" href="#validation-stamps-auto-creation"></a>Auto creation of validation stamps</h5>
<div class="paragraph">
<p>When the auto creation is enabled, build validations using a validation stamp
name will follow this procedure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the validation stamp is already defined in the branch, it is of
course used</p>
</li>
<li>
<p>if the validation stamp is predefined, it is used to create a new one on
the branch and is then used</p>
</li>
<li>
<p>in any other case, an error is displayed</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The auto creation of validation stamps is available only through the
<a href="#dsl">DSL</a> or through the API. It is not accessible through the GUI, where
only the validation stamps of the branch can be selected for a build validation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="validation-stamps-auto-creation-if-not-predefined"><a class="anchor" href="#validation-stamps-auto-creation-if-not-predefined"></a>Auto creation of validation stamps when not predefined</h5>
<div class="paragraph">
<p>You can also configure the project so that validation stamps are created on demand, <em>even when
no predefined validation stamp is created</em>.</p>
</div>
<div class="paragraph">
<p>In this case:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the validation stamp is already defined in the branch, it is of
course used</p>
</li>
<li>
<p>if the validation stamp is predefined, it is used to create a new one on
the branch and is then used</p>
</li>
<li>
<p>in any other case, a new validation stamp is created in the branch, with the requested name (and with
an empty image and a default description)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="validation-stamps-bulk-update"><a class="anchor" href="#validation-stamps-bulk-update"></a>2.3.2. Bulk update of validation stamps</h4>
<div class="paragraph">
<p>Validation stamps are attached to a <a href="#model">branch</a> but in reality, they are
often duplicated in a project branches and among all the projects. Updating
the description and the image of a validation stamp can fast become cumbersome.</p>
</div>
<div class="paragraph">
<p>The <a href="#validation-stamps-auto-predefined">predefined validation stamp</a> can
mitigate but this won&#8217;t solve the issue when validation stamps are created
<a href="#validation-stamps-auto-creation-if-not-predefined">automatically</a> even when
not predefined.</p>
</div>
<div class="paragraph">
<p>In order to update all the validation stamps having the same name, across all
branches and all projects, you can use the <em>Buld update</em> command in the
validation stamp page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/validation-stamp-bulk-update.png" alt="Bulk update">
</div>
</div>
<div class="paragraph">
<p>A confirmation will be asked and all the validation stamps having the same
name, across all branches and all projects, will be updated with the same
image and the same description.</p>
</div>
<div class="paragraph">
<p>A <a href="#validation-stamps-auto-predefined">predefined validation stamp</a> will
also be updated or created.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="promotion-levels"><a class="anchor" href="#promotion-levels"></a>2.4. Managing promotion levels</h3>
<div class="sect3">
<h4 id="promotion-levels-auto-promotion"><a class="anchor" href="#promotion-levels-auto-promotion"></a>2.4.1. Auto promotion</h4>
<div class="paragraph">
<p>By default, a build is <a href="#model">promoted</a> explicitly, by associated a promotion
with it.</p>
</div>
<div class="paragraph">
<p>By configuring an auto promotion, we allow a build to be automatically promoted
whenever a given list of validations have passed on this build.</p>
</div>
<div class="paragraph">
<p>For example, if a build had passed integration tests on platforms A, B and C,
we can imagine to promote automatically this build to a promotion level,
without having to do it explicitly.</p>
</div>
<div class="paragraph">
<p>In order to configure the auto promotion, go to the promotion level and set
the "Auto promotion" property. You then associate the list of validation stamps
that must be <code>PASSED</code> on a build in order to get this build automatically
promoted.</p>
</div>
<div class="paragraph">
<p>The list of validation stamps can be defined by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>selecting a fixed list of validation stamps</p>
</li>
<li>
<p>selecting the validation stamps based on their name, using <code>include</code> and
<code>exclude</code> regular expressions</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
A validation stamp defined in the list is <em>always</em> taken into account in the
auto promotion, whatever the values for the <code>include</code> and <code>exclude</code> regular
promotions.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="promotion-levels-auto-creation"><a class="anchor" href="#promotion-levels-auto-creation"></a>2.4.2. Auto creation</h4>
<div class="paragraph">
<p>Creating the promotion levels for each branch, or making sure they are always
up to date, can be a non trivial task. Having mechanisms like cloning or
<a href="#templates">templating</a> can help, but then one must still make sure the list
of promotion levels in the template is up to date and than the template is
regularly synchronized.</p>
</div>
<div class="paragraph">
<p>Another approach is to allow projects to create automatically the promotion
levels on demand, whenever a build is promoted. This must of course be
authorized at project level and a list of predefined promotion levels must be
maintained globally.</p>
</div>
<div class="sect4">
<h5 id="promotion-levels-auto-creation-predefined"><a class="anchor" href="#promotion-levels-auto-creation-predefined"></a>Predefined promotion levels</h5>
<div class="paragraph">
<p>The management of predefined promotion levels is accessible to any
<em>Administrator</em>, in his user menu.</p>
</div>
<div class="paragraph">
<p>He can create, edit and delete predefined promotion levels, and associate
images with them.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Deleting a predefined promotion level has no impact on the ones
which were created from it in the branches. No link is kept between the
promotion levels in the branches and the predefined ones.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="promotion-levels-auto-creation-projects"><a class="anchor" href="#promotion-levels-auto-creation-projects"></a>Configuring projects</h5>
<div class="paragraph">
<p>By default, a project does not authorize the automatic creation of a promotion
level. In case one attempts to validate a build using a non existing promotion
level, an error would be thrown.</p>
</div>
<div class="paragraph">
<p>In order to enable this feature on a project, add the <em>Auto promotion levels</em>
property to the project and set <em>Auto creation</em> to <em>Yes</em>.</p>
</div>
<div class="paragraph">
<p>Disabling the auto creation can be done either by setting <em>Auto creation</em> to
<em>No</em> or by removing the property altogether.</p>
</div>
</div>
<div class="sect4">
<h5 id="promotion-levels-auto-creation-creation"><a class="anchor" href="#promotion-levels-auto-creation-creation"></a>Auto creation of promotion levels</h5>
<div class="paragraph">
<p>When the auto creation is enabled, build promotions using a promotion level
name will follow this procedure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if the promotion level is already defined in the branch, it is of course used</p>
</li>
<li>
<p>if the promotion level is predefined, it is used to create a new one on the
branch and is then used</p>
</li>
<li>
<p>in any other case, an error is displayed</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The auto creation of promotion levels is available only through the
<a href="#dsl">DSL</a> or through the API. It is not accessible through the GUI, where
only the promotion levels of the branch can be selected for a build promotion.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="builds"><a class="anchor" href="#builds"></a>2.5. Managing the builds</h3>
<div class="paragraph">
<p>The builds are displayed for a <a href="#model">branch</a>.</p>
</div>
<div class="sect3">
<h4 id="builds-filtering"><a class="anchor" href="#builds-filtering"></a>2.5.1. Filtering the builds</h4>
<div class="paragraph">
<p>By default, only the 10 last builds of a branch are shown but you have the
possibility to create <em>build filters</em> in order to change the list of displayed
builds for a branch.</p>
</div>
<div class="paragraph">
<p>The management of filters is done using the <em>Filter</em> buttons at the top-left
and bottom-left corners of the build list. Those buttons behave exactly the
same way. They are not displayed if no build has ever been created for the
branch.</p>
</div>
<div class="paragraph">
<p>Some filters, like <em>Last build per promotion</em>, are predefined, and you just
have to select them to apply them.</p>
</div>
<div class="paragraph">
<p>You can create custom filters using the <em>build filter types</em> which are in the
<em>New filter</em> section at the end of the <em>Filter</em> menu. You fill in the filter
parameters and
apply the filter by clicking on <em>OK</em>.</p>
</div>
<div class="paragraph">
<p>If you give your filter a name, this filter will be saved locally for the
current branch and can be reused later on when using the same browser on the
same machine account. If you are logged, you can save this filter for your
account at <em>ontrack</em> level so you can reuse it from any workstation.</p>
</div>
<div class="paragraph">
<p>If the filter is not named, it will be applied all the same but won&#8217;t be
editable nor being able to be saved.</p>
</div>
<div class="paragraph">
<p>You can delete and edit any of your own filters.</p>
</div>
<div class="paragraph">
<p>You can disable any filtering by selection <em>Erase filter</em>. You would then
return to the default: last 10 builds. Note that the saved filters are not
impacted by this operation.</p>
</div>
<div class="sect4">
<h5 id="builds-filtering-sharing"><a class="anchor" href="#builds-filtering-sharing"></a>Sharing filters</h5>
<div class="paragraph">
<p>By selecting the <em>Permalink</em> option in the <em>Filter</em> menu, you update your
browser&#8217;s URL to include information about the current selected filter. By
copying this URL and send to another user, this other user will be able to
apply the same filter than you, even if he did not create it in the first place.</p>
</div>
<div class="paragraph">
<p>Even anonymous (unnamed) filters can be shared this way.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="builds-links"><a class="anchor" href="#builds-links"></a>2.5.2. Build links</h4>
<div class="paragraph">
<p>A <a href="#model">build</a> can be linked to other builds. This is particularly useful
to represent dependencies between builds and projects.</p>
</div>
<div class="sect4">
<h5 id="builds-links-definition"><a class="anchor" href="#builds-links-definition"></a>Definition of links</h5>
<div class="paragraph">
<p>If authorized, you&#8217;ll see a <em>Build links</em> command at the top of the build page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-build-links-command.png" alt="Build links command" width="400">
</div>
</div>
<div class="paragraph">
<p>Clicking on this link will open a dialog which allows you to define the list
of links:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-build-links-dialog.png" alt="Build links input" width="400">
</div>
</div>
<div class="paragraph">
<p>Note that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>usually, you&#8217;ll probably edit those links in an automated process using the
<a href="#dsl">DSL</a></p>
</li>
<li>
<p>you cannot define or see links to builds for which the project is not
accessible to you</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="builds-links-decorations"><a class="anchor" href="#builds-links-decorations"></a>Decorations</h5>
<div class="paragraph">
<p>The build links are displayed as decorations in the build page header:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-build-links-decoration-header.png" alt="Build links decorations in header" width="400">
</div>
</div>
<div class="paragraph">
<p>or in the list of builds:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-build-links-decoration-list.png" alt="Build links decorations in list" width="400">
</div>
</div>
<div class="paragraph">
<p>In both cases, the decoration is clickable. If the target build has been
promoted, the associated promotions will also be displayed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-build-links-decoration-promotions.png" alt="Build links promotions" width="400">
</div>
</div>
</div>
<div class="sect4">
<h5 id="builds-links-querying"><a class="anchor" href="#builds-links-querying"></a>Querying</h5>
<div class="paragraph">
<p>The build links properties can be used for queries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in <a href="#builds-filtering">build filters</a></p>
</li>
<li>
<p>in build searches</p>
</li>
<li>
<p>in global searches</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In all those cases, the syntax to find a match is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>project</code>, <code>project:</code> or <code>project:*</code> - all builds which contain a build link
to the <code>project</code> <a href="#projects">project</a></p>
</li>
<li>
<p><code>project:build</code> - all builds which contain a link to the build <code>build</code> in
the <code>project</code> project</p>
</li>
<li>
<p><code>project:build*</code> - all builds which contain a link to a build starting with
<code>build</code> in the <code>project</code> project. The <code>*</code> wildcard can be used in any place.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="properties"><a class="anchor" href="#properties"></a>2.6. Properties</h3>
<div class="paragraph">
<p>All <a href="#model">entities</a> can be associated with properties.</p>
</div>
<div class="sect3">
<h4 id="property-message"><a class="anchor" href="#property-message"></a>2.6.1. Message property</h4>
<div class="paragraph">
<p>The <em>Message</em> property can be associated with any <a href="#model">entity</a> in Ontrack.</p>
</div>
<div class="paragraph">
<p>A message is the association of some <em>text</em> with a <em>type</em>: information, warning
or error:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-message-dialog.png" alt="Message input" width="400">
</div>
</div>
<div class="paragraph">
<p>The message is of course displayed in the list of properties:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-message-display.png" alt="Message displayed" width="400">
</div>
</div>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>and as a decoration:</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-message-decoration.png" alt="Message decoration" width="400">
</div>
</div>
</div>
<div class="sect3">
<h4 id="property-meta"><a class="anchor" href="#property-meta"></a>2.6.2. Meta information property</h4>
<div class="paragraph">
<p>Some arbitrary meta information properties can be associated with any
<a href="#model">entity</a> in Ontrack, using a set of values for some names, and
optionally some links and categories.</p>
</div>
<div class="sect4">
<h5 id="property-meta-input"><a class="anchor" href="#property-meta-input"></a>Input</h5>
<div class="imageblock">
<div class="content">
<img src="images/property-meta-information-dialog.png" alt="Meta information input" width="400">
</div>
</div>
</div>
<div class="sect4">
<h5 id="property-meta-display"><a class="anchor" href="#property-meta-display"></a>Representation</h5>
<div class="paragraph">
<p>The list of meta information properties is displayed in the list of properties:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/property-meta-information-display.png" alt="Meta information displayed" width="400">
</div>
</div>
</div>
<div class="sect4">
<h5 id="property-meta-query"><a class="anchor" href="#property-meta-query"></a>Querying</h5>
<div class="paragraph">
<p>The meta information properties can be used for queries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in <a href="#builds-filtering">build filters</a></p>
</li>
<li>
<p>in build searches</p>
</li>
<li>
<p>in global searches</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In all those cases, the syntax to find a match is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name:</code> or <code>name:*</code> - all entities which contain a <code>name</code> meta information
property</p>
</li>
<li>
<p><code>name:value</code> - all entities which contain a <code>name</code> meta information property
with the exact <code>value</code></p>
</li>
<li>
<p><code>name:val*</code> - all entities which contain a <code>name</code> meta information property
whose value starts with <code>val</code></p>
</li>
<li>
<p>the <code>*</code> wildcard can be used in any place</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Neither the link nor the category can be used for the search, only the
      name and the value.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="topics"><a class="anchor" href="#topics"></a>3. Topics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="templates"><a class="anchor" href="#templates"></a>3.1. Branch templates</h3>
<div class="paragraph">
<p>In a context where branches are numerous, because the workflow you&#8217;re working
with implies the creation of many branches (feature branches, release branches,
&#8230;&#8203;), each of them associated with its own pipeline, creating the branches by
hand, even by cloning or copying them would be too much an effort.</p>
</div>
<div class="paragraph">
<p>Ontrack gives the possibility to create <em>branch templates</em> and to automatically
create branches using this template according to a list of branches. This list
of branches can either be static or provided by the SCM.</p>
</div>
<div class="sect3">
<h4 id="templates-definition"><a class="anchor" href="#templates-definition"></a>3.1.1. Template Definition</h4>
<div class="paragraph">
<p>We distinguish between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <strong>branch template definition</strong> - which defines a template for a group of
branches</p>
</li>
<li>
<p>the <strong>branch template instances</strong> - which are branches based on a template
definition</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There can be several template definitions per project, each with its own set
of template instances.</p>
</div>
<div class="paragraph">
<p>A <strong>template definition</strong> is a branch:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>which is disabled (not visible by default)</p>
</li>
<li>
<p>which has a special decoration for quick identification in the list of
branches for a project</p>
</li>
<li>
<p>which has a list of template parameters:</p>
</li>
<li>
<p>names</p>
</li>
<li>
<p>description</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>whose descriptions and property values use <code>${name}</code> expressions where name is
a template parameter.</p>
</div>
<div class="paragraph">
<p>One can create a template definition from any branch following those rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the user must be authorized to manage branch templates for a project</p>
</li>
<li>
<p>the branch must not be already a <em>template instance</em></p>
</li>
<li>
<p>the branch must not have any existing build</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="templates-instance"><a class="anchor" href="#templates-instance"></a>3.1.2. Template Instances</h4>
<div class="paragraph">
<p>A <strong>template instance</strong> is also a branch:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>which is linked to a <a href="#templates-definition">template definition</a></p>
</li>
<li>
<p>which has a set of name/values linked to the template parameters</p>
</li>
<li>
<p>which has a special decoration for quick identification in the list of
branches for a project</p>
</li>
<li>
<p>it is a "normal branch" as far as the rest of Ontrack is concerned, but:</p>
<div class="ulist">
<ul>
<li>
<p>it cannot be edited</p>
</li>
<li>
<p>no property can be edited not deleted (they are linked to the template definition)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are several ways to create template instances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>from a definition, we can create one instance by providing:</p>
<div class="ulist">
<ul>
<li>
<p>a name for the instance</p>
</li>
<li>
<p>values for each template parameters</p>
</li>
</ul>
</div>
</li>
<li>
<p>we can define template synchronization settings linked to a template
definition:</p>
<div class="ulist">
<ul>
<li>
<p>source of instance names - this is an extension point. This can be:</p>
<div class="ulist">
<ul>
<li>
<p>a list of names</p>
</li>
<li>
<p>a list of actual branches from a SCM, optionally filtered. The SCM
information is taken from the project definition.</p>
</li>
</ul>
</div>
</li>
<li>
<p>an interval of synchronization (manual or every x minutes)</p>
<div class="ulist">
<ul>
<li>
<p>a list of template expressions for each template parameter which define
how to map an instance name into an actual parameter value (see below)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The actual creation of the instance is done using cloning and copy technics
already in place in Ontrack. The replacement is done using the template
parameters and their values (computed or not).</p>
</div>
<div class="paragraph">
<p>The manual creation of an instance follows the same rules than the creation of
a branch. If the branch already exists, an error is thrown.</p>
</div>
<div class="paragraph">
<p>For automatic synchronization from a list of names (static or from a SCM):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if a previously linked branch does not exist any longer, it is disabled
(or deleted directly, according to some additional settings for the
synchronization)</p>
</li>
<li>
<p>if a branch already exists with the same name, but is not a template instance,
a warning is emitted</p>
</li>
<li>
<p>if a branch exists already, its descriptions and property values are synched
again</p>
</li>
<li>
<p>if a branch does not exist, it is created as usual</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Reporting about the synchronization (like syncs, errors and warnings) are
visible in the <em>Events</em> section, in the template definition or in the template
instances.</p>
</div>
<div class="paragraph">
<p>The same synchronization principle applies to branch components: promotion
levels, validation stamps and properties.</p>
</div>
<div class="paragraph">
<p>Finally, at a higher level, cloning a project would also clone the template
definitions (not the instances).</p>
</div>
</div>
<div class="sect3">
<h4 id="templates-expressions"><a class="anchor" href="#templates-expressions"></a>3.1.3. Template expressions</h4>
<div class="paragraph">
<p>Those expressions are defined for the synchronization between template
definitions and template instances. They bind a parameter name and a branch
name to an actual parameter value.</p>
</div>
<div class="paragraph">
<p>A template expression is a string that contains references to the branch name
using the <code>${&#8230;&#8203;}</code> construct where the content is a Groovy expression where
the <code>branchName</code> variable is bound to the branch name.</p>
</div>
<div class="paragraph">
<p>Note that those Groovy expression are executed in a <em>sand box</em> that prevent malicious code execution.</p>
</div>
<div class="sect4">
<h5 id="templates-expressions-examples"><a class="anchor" href="#templates-expressions-examples"></a>Examples</h5>
<div class="paragraph">
<p>In a SVN context, we can bind the branch SVN configuration (branch location<br>
tag pattern) this way, using simple replacements:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>branchLocation: branchName -&gt; /project/branches/${branchName}
tagPattern:     branchName -&gt; /project/tags/{build:${branchName}*}</pre>
</div>
</div>
<div class="paragraph">
<p>In a Jenkins context, we can bind the job name for a branch:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>jobName: branchName -&gt; PROJECT_${branchName.toUpperCase()}_BUILD</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="usage-git"><a class="anchor" href="#usage-git"></a>3.2. Working with Git</h3>
<div class="sect3">
<h4 id="usage-github"><a class="anchor" href="#usage-github"></a>3.2.1. Working with GitHub</h4>
<div class="paragraph">
<p><a href="https://github.com">GitHub</a> is an enterprise Git repository manager on the cloud
or hosted in the premises.</p>
</div>
<div class="paragraph">
<p>When <a href="#usage-git">working with Git</a> in Ontrack, one can configure a project to
connect to a GitHub repository.</p>
</div>
<div class="sect4">
<h5 id="usage-github-config"><a class="anchor" href="#usage-github-config"></a>General configuration</h5>
<div class="paragraph">
<p>The access to a GitHub instance must be configured.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>as <a href="#security">administrator</a>, go to the <em>GitHub configurations</em> menu</p>
</li>
<li>
<p>click on <em>Create a configuration</em></p>
</li>
<li>
<p>in the configuration dialog, enter the following parameters:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>  - unique name for the configuration</p>
</li>
<li>
<p>URL - URL to the GitHub instance. If left blank, it defaults to the <a href="https://github.com" class="bare">https://github.com</a> location</p>
</li>
<li>
<p>User &amp; Password - credentials used to access GitHub - Ontrack only needs a read access to the repositories</p>
</li>
<li>
<p>OAuth2 token - authentication can also be performed using an API token instead of using a user/password pair</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The existing configurations can be updated and deleted.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Although it is possible to work with an anonymous user when accessing
     GitHub, this is not recommended. The rate of the API call will be limited
     and can lead to some errors.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="usage-github-project"><a class="anchor" href="#usage-github-project"></a>Project configuration</h5>
<div class="paragraph">
<p>The link between a project and a GitHub repository is defined by the <em>GitHub
configuration</em> property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Configuration</strong> - selection of the GitHub configuration created before -
this is used for the accesses</p>
</li>
<li>
<p><strong>Repository</strong> - GitHub repository, like <code>nemerosa/ontrack</code></p>
</li>
<li>
<p>Indexation interval - interval (in minutes) between each synchronisation
(Ontrack maintains internally a clone of the GitHub repositories)</p>
</li>
<li>
<p>Issue configuration - issue service. If not set or set to "GitHub issues",
the issues of the repository will be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Branches can be <a href="#usage-git">configured for Git</a> independently.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="usage-gitlab"><a class="anchor" href="#usage-gitlab"></a>3.2.2. Working with GitLab</h4>
<div class="paragraph">
<p><a href="https://about.gitlab.com">GitLab</a> unifies issues, code review, CI and CD into
a single UI.</p>
</div>
<div class="paragraph">
<p>When <a href="#usage-git">working with Git</a> in Ontrack, one can configure a project
to connect to a GitLab repository.</p>
</div>
<div class="sect4">
<h5 id="usage-gitlab-config"><a class="anchor" href="#usage-gitlab-config"></a>General configuration</h5>
<div class="paragraph">
<p>The access to a GitLab instance must be configured.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>as <a href="#security">administrator</a>, go to the <em>GitLab configurations</em> menu</p>
</li>
<li>
<p>click on <em>Create a configuration</em></p>
</li>
<li>
<p>in the configuration dialog, enter the following parameters:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>  - unique name for the configuration</p>
</li>
<li>
<p><strong>URL</strong> - URL to the GitLab instance (not the repository, the GitLab server)</p>
</li>
<li>
<p><strong>User</strong> &amp; <strong>Personal Access Token</strong> - credentials used to access GitLab</p>
</li>
<li>
<p>Ignore SSL Certificate - select <em>Yes</em> if the <a href="#appendix-certificates">SSL certificate</a> for your GitLab
instance cannot be trusted by default.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You cannot use the account&#8217;s password - only Personal Access Tokens are
supported.s
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The existing configurations can be updated and deleted.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-gitlab-config"><a class="anchor" href="#usage-gitlab-config"></a>Project configuration</h5>
<div class="paragraph">
<p>The link between a project and a GitLab repository is defined by the <em>GitLab
configuration</em> property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Configuration</strong> - selection of the GitLab configuration created before -
this is used for the access</p>
</li>
<li>
<p>Issue configuration - select the source of issues for this project. This can
be any ticketing system (like JIRA) or the built-in issue management for
this GitLab project (displayed as "GitLab issues")</p>
</li>
<li>
<p><strong>Repository</strong> - repository name, like <code>nemerosa/ontrack</code></p>
</li>
<li>
<p>Indexation interval - how often, in minutes, must the content of this
repository be synchronised with Ontrack. Use <code>0</code> to not automatically
synchronize this repository (this can be done manually).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Branches can be <a href="#usage-git">configured for Git</a> independently.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="usage-bitbucket"><a class="anchor" href="#usage-bitbucket"></a>3.2.3. Working with BitBucket</h4>
<div class="paragraph">
<p><a href="https://www.atlassian.com/software/bitbucket">BitBucket</a> is an enterprise Git
repository manager by Atlassian.</p>
</div>
<div class="paragraph">
<p>When <a href="#usage-git">working with Git</a> in Ontrack, one can configure a project
to connect to a Git repository defined in BitBucket in order to access to the
change logs.</p>
</div>
<div class="sect4">
<h5 id="usage-bitbucket-config"><a class="anchor" href="#usage-bitbucket-config"></a>General configuration</h5>
<div class="paragraph">
<p>The access to a BitBucket instance must be configured.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>as <a href="#security">administrator</a>, go to the <em>BitBucket configurations</em> menu</p>
</li>
<li>
<p>click on <em>Create a configuration</em></p>
</li>
<li>
<p>in the configuration dialog, enter the following parameters:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong>  - unique name for the configuration</p>
</li>
<li>
<p><strong>URL</strong> - URL to the Stash instance</p>
</li>
<li>
<p>User &amp; Password - credentials used to access Stash - Ontrack only needs a
read access to the repositories</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The existing configurations can be updated and deleted.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-bitbucket-config"><a class="anchor" href="#usage-bitbucket-config"></a>Project configuration</h5>
<div class="paragraph">
<p>The link between a project and a Stash repository is defined by the <em>Stash
configuration</em> property:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Configuration</strong> - selection of the Stash configuration created before -
this is used for the access and the issues management</p>
</li>
<li>
<p><strong>Project</strong> - name of the <em>Stash project</em></p>
</li>
<li>
<p><strong>Repository</strong> - name of the <em>Stash repository</em></p>
<div class="ulist">
<ul>
<li>
<p>Indexation interval - interval (in minutes) between each synchronization
(Ontrack maintains internally a clone of the BitBucket repositories)</p>
</li>
<li>
<p>Issue configuration - <a href="#usage-issues">configured issue service</a> to use
when looking for issues in commits.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Branches can be <a href="#usage-git">configured for Git</a> independently.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="usage-subversion"><a class="anchor" href="#usage-subversion"></a>3.2.4. Working with Subversion</h4>
<div class="paragraph">
<p>Ontrack allows you to configure projects and branches to work with Subversion
in order to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>get <a href="#changelogs">change logs</a></p>
</li>
<li>
<p>search for issues linked to builds and promotions</p>
</li>
<li>
<p>search for revisions</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="usage-subversion-config"><a class="anchor" href="#usage-subversion-config"></a>Subversion configurations</h5>
<div class="paragraph">
<p>In order to be able to associate projects and branches with Subversion
information, an administrator must first define one or several Subversion
configurations.</p>
</div>
<div class="paragraph">
<p>As an administrator, go to the user menu and select <em>SVN configurations</em>.</p>
</div>
<div class="paragraph">
<p>In this page, you can create, update and delete Subversion configurations.
Parameters for a Subversion configuration are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a name - it will be used for the association with projects</p>
</li>
<li>
<p>a URL - Ontrack supports <code>svn</code>, <code>http</code> and <code>https</code> protocols - if the SSL
certificate is not recognized by default, some
<a href="#appendix-certificates">additional configuration</a> must be done at system
level.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The URL must be the URL of the <em>repository</em>.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>a user and a password if the access to the repository requires authentication</p>
</li>
<li>
<p>a tag filter pattern - optional, a regular expression which defines which
tags must be indexed</p>
</li>
<li>
<p>several URL used for browsing</p>
</li>
<li>
<p>indexation interval in minutes (see below)</p>
</li>
<li>
<p>indexation start - the revision where to start the indexation from</p>
</li>
<li>
<p>issue configuration - issue service associated with this repository</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="usage-subversion-indexation"><a class="anchor" href="#usage-subversion-indexation"></a>Indexation</h5>
<div class="paragraph">
<p>Ontrack works with Subversion by indexing some repository information locally,
in order to avoid going over the network for each Subversion query.</p>
</div>
<div class="paragraph">
<p>This indexation is controlled by the parameters of the Subversion
configuration: starting revision and interval. If this interval is set to 0,
the indexation will have to be triggered manually.</p>
</div>
<div class="paragraph">
<p>Among the information being indexed, the copy of tags is performed and can be
filtered if needed.</p>
</div>
<div class="paragraph">
<p>In order to access the indexation settings of a Subversion configuration,
click on the <em>Indexation</em> link.</p>
</div>
<div class="paragraph">
<p>From the indexation dialog, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>force the indexation from the latest indexed revision</p>
</li>
<li>
<p>reindex a range of revisions</p>
</li>
<li>
<p>erase all indexed information, and rerun it</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The indexations run in background.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-subversion-project"><a class="anchor" href="#usage-subversion-project"></a>Project configuration</h5>
<div class="paragraph">
<p>You can associate a project with a Subversion configuration by adding the
<em>SVN configuration</em> property and selecting:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a Subversion configuration using its name</p>
</li>
<li>
<p>a reference path (typically to the <code>trunk</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Like all paths in Subversion configurations of projects and
           branches, this is a <em>relative</em> path to the root of the repository.
           <em>Not</em> an absolute URL.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>From then on, you can start configuring the branches of the project.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-subversion-branch"><a class="anchor" href="#usage-subversion-branch"></a>Branch configuration</h5>
<div class="paragraph">
<p>You can associate a branch with Subversion by adding the <em>SVN configuration</em>
property and selecting:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a path to the branch</p>
</li>
<li>
<p>a build revision link and its configuration if any</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The path to the branch is <em>relative</em> to the URL of the SVN
           repository.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The build commit link defines how to associate a <a href="#model">build</a> and a
location in Subversion (tag, revision, &#8230;&#8203;). This link works in both directions
since we need also to find builds based on Subversion informations.</p>
</div>
<div class="paragraph">
<p>Build commit links are extension points - the following are available in
Ontrack.</p>
</div>
<div class="sect5">
<h6 id="usage-subversion-link-tag"><a class="anchor" href="#usage-subversion-link-tag"></a>Tag name</h6>
<div class="paragraph">
<p>The build name is considered a tag name in the <code>tags</code> folder for the branch.
For example, if the branch path is <code>/projects/myproject/branches/1.1</code> then the
tags folder is <code>/projects/myproject/tags</code> and build names will be looked for
in this folder.</p>
</div>
<div class="paragraph">
<p>No configuration is needed.</p>
</div>
</div>
<div class="sect5">
<h6 id="usage-subversion-link-tag-pattern"><a class="anchor" href="#usage-subversion-link-tag-pattern"></a>Tag pattern name</h6>
<div class="paragraph">
<p>The build name is considered a tag name in the <code>tags</code> folder but must follow
a given pattern.</p>
</div>
</div>
<div class="sect5">
<h6 id="usage-subversion-link-revision"><a class="anchor" href="#usage-subversion-link-revision"></a>Revision name</h6>
<div class="paragraph">
<p>The build name is always numeric and represent a revision on the branch path.</p>
</div>
<div class="paragraph">
<p>No configuration is needed.</p>
</div>
</div>
<div class="sect5">
<h6 id="usage-subversion-link-revision-pattern"><a class="anchor" href="#usage-subversion-link-revision-pattern"></a>Revision pattern</h6>
<div class="paragraph">
<p>The build name has the branch revision in its name, using the <code>{revision}</code>
token, following a given pattern. For example, if the pattern is
<code>2.0.*-{revision}</code>, then all build names must start with <code>2.0.</code>, following
by anything and suffixed by a revision number.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="usage-subversion-build-sync"><a class="anchor" href="#usage-subversion-build-sync"></a>Build / tag synchronization</h5>
<div class="paragraph">
<p>For branches whose builds are associated with tags, you have the option to
enable a synchronization between the builds in Ontrack and the tags in the
Subversion branch.</p>
</div>
<div class="paragraph">
<p>In the branch page, add the <em>SVN synchronisation</em> property and configure it:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>override</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>Yes</code>, the existing builds in Ontrack will be overridden by
  the tags in Subversion. If set to <code>No</code> (the default), the existing builds in
  Ontrack are never overridden and only new tags are taken into account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The frequency, in minutes, of the synchronization. If set to <code>0</code>,
  the synchronization is not automated and must be triggered manually.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In order to disable globally the tag/build synchronization, without
having to change manually all the configured branches, add the following
entry in the <a href="#configuration">Ontrack configuration file</a> and restart
Ontrack:</p>
</div>
<div class="listingblock">
<div class="title">application.yml</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">ontrack:
   extension:
      svn:
         build-sync-disabled: true</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="changelogs"><a class="anchor" href="#changelogs"></a>3.3. Change logs</h3>
<div class="paragraph">
<p>When working with <a href="#usage-git">Git</a> or <a href="#usage-subversion">Subversion</a>, you
have the opportunity to get a change log between two <a href="#usage-builds">builds</a> of
the same project.</p>
</div>
<div class="sect3">
<h4 id="changelogs-selection"><a class="anchor" href="#changelogs-selection"></a>3.3.1. Selection</h4>
<div class="paragraph">
<p>In the <a href="#usage-branches">branch view</a>, you can select the two boundaries
of the change log by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clicking on a build row</p>
</li>
<li>
<p>clicking while holding the <code>shift</code> key on another build row</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Two arrows indicate the current selection:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.selection.png" alt="Change log selection" width="300">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Note that by default the first and the last build of the current view
are selected as boundaries.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <em>Change log</em> button displays the change log page, which contains four
sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>general information about the two build boundaries</p>
</li>
<li>
<p>the commits (for Git) or revision (for Subversion) section</p>
</li>
<li>
<p>the issues section</p>
</li>
<li>
<p>the file changes selection</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only the first section (build information) is always displayed - the three
other ones are displayed only when you request them by clicking on one of the
corresponding buttons or links.</p>
</div>
<div class="paragraph">
<p>Note that the issue section is available only if the corresponding SCM
configuration (Git or Subversion) is associated with an issue server (like
<a href="#usage-jira">JIRA</a> or <a href="#usage-github">GitHub</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="changelogs-commits"><a class="anchor" href="#changelogs-commits"></a>3.3.2. Commits/revisions</h4>
<div class="paragraph">
<p>This section displays the changes between the two build boundaries. For Git,
the associated commit graph is also displayed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.commits.png" alt="Git commits" width="600">
</div>
</div>
</div>
<div class="sect3">
<h4 id="changelogs-issues"><a class="anchor" href="#changelogs-issues"></a>3.3.3. Issues</h4>
<div class="paragraph">
<p>The list of issues associated with the commits between the two build boundaries
is displayed here:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.issues.png" alt="Issues">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="changelogs-files"><a class="anchor" href="#changelogs-files"></a>4. File changes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The list of file changes between the two build boundaries is displayed here:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.png" alt="Change log files" width="600">
</div>
</div>
<div class="paragraph">
<p>Each file change is associated with the corresponding changes. This includes
the list of revisions for Subversion.</p>
</div>
<div class="paragraph">
<p>Additionally, you can define filters on the file changes, in order to have
access to a list of files impacted by the change log.</p>
</div>
<div class="paragraph">
<p>By entering a ANT-like pattern, you can display the file paths which match:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.quickfilter.png" alt="Change log files filter" width="600">
</div>
</div>
<div class="paragraph">
<p>For more complex selections, you can clock on the <em>Edit</em> button and you&#8217;ll
have a dialog box which allows you to define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a name for your filter</p>
</li>
<li>
<p>a list of ANT-like patterns to match</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.filterdialog.png" alt="Change log files filter dialog" width="400">
</div>
</div>
<div class="paragraph">
<p>If you are authorized, you can also save this filter for the project, allowing
its selection by all users.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.filtershare.png" alt="Change log files filter share" width="400">
</div>
</div>
<div class="paragraph">
<p>In the list of filters, you find the filters you have defined and the ones
which have been shared for the whole project. The latter ones are marked with
an asterisk (*):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.filtershared.png" alt="Change log files filter shared" width="400">
</div>
</div>
<div class="paragraph">
<p>You can update and delete filters. Note that the shared filters won&#8217;t be
actually updated or deleted, unless you are authorized.</p>
</div>
<div class="paragraph">
<p>Finally, you can get the unified diff for the selected filter by clicking on
the <em>Diff</em> button:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.filterdiff.png" alt="Change log files filter diff" width="400">
</div>
</div>
<div class="paragraph">
<p>This will display a dialog with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the unified diff you can copy</p>
</li>
<li>
<p>a permalink which allows you download the diff from another source</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can obtain a quick diff on one file by clicking on the icon at the right
of a file in the change log:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/changelog.files.quickdiff.png" alt="Quick diff on file" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="administration"><a class="anchor" href="#administration"></a>5. Administration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="security"><a class="anchor" href="#security"></a>5.1. Security</h3>
<div class="paragraph">
<p>The Ontrack security is based on accounts and account groups, and on
authorizations granted to them.</p>
</div>
<div class="sect3">
<h4 id="security-concepts"><a class="anchor" href="#security-concepts"></a>5.1.1. Concepts</h4>
<div class="paragraph">
<p>Each action in Ontrack is associated with an <em>authorisation function</em> and those
functions are grouped together in <em>roles</em> which are granted to <em>accounts</em> and
<em>account groups</em>.</p>
</div>
<div class="paragraph">
<p>An <em>account</em> can belong to several <em>account groups</em> and his set of final
<em>authorisation functions</em> will be the aggregation of the rights given to the
account and to the groups.</p>
</div>
</div>
<div class="sect3">
<h4 id="security-roles"><a class="anchor" href="#security-roles"></a>5.1.2. Roles</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As of now, only roles can be assigned to groups and accounts, and the
list of roles and their associated functions is defined by Ontrack itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ontrack distinguishes between <em>global roles</em> and <em>project</em> roles.</p>
</div>
<div class="paragraph">
<p><a href="#extending">Extensions</a> can contribute to built-in roles
and functions - see <a href="#extending-security">Extending the security</a> for details.</p>
</div>
<div class="sect4">
<h5 id="security-roles-global"><a class="anchor" href="#security-roles-global"></a>Global roles</h5>
<div class="paragraph">
<p>An <strong>ADMINISTRATOR</strong> has access to all the functions of Ontrack, in all
projects. At least such a role should be defined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, right after installation, a default <code>admin</code> account is
created with the <code>ADMINISTRATOR</code> role, having <em>admin</em> as password. This
password should be changed as soon as possible.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <strong>CREATOR</strong> can create any project and can, on all projects, configure them,
create branches, manage branch templates, create promotion levels and
validation stamps. This role should be attributed to service users in charge
of automating the definition of projects and branches.</p>
</div>
<div class="paragraph">
<p>An <strong>AUTOMATION</strong> user can do the same things than a <em>CREATOR</em> but can, on all
projects, additionally edit promotion levels and validation stamps, create
builds, promote and validate them, synchronize branches with their template,
manage account groups and project permissions.
This role is suited for build and integration automation (CI).</p>
</div>
<div class="paragraph">
<p>A <strong>CONTROLLER</strong> can, on all projects, create builds, promote and validate
them, synchronize branches with their template. It is suited for a basic CI
need when the Ontrack structure already exists and does not need to be created.</p>
</div>
<div class="paragraph">
<p>A <strong>READ_ONLY</strong> can view all projects, but cannot perform any action on them.</p>
</div>
<div class="paragraph">
<p>The global roles can only be assigned by an <em>administrator</em>, in the <em>Account
management</em> page, by going to the <em>Global permissions</em> command.</p>
</div>
<div class="paragraph">
<p>A <em>global permission</em> is created by associating:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <em>permission target</em> (an account or a group)</p>
</li>
<li>
<p>a <em>global role</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>type the first letter of the account or the group you want to add a permission for</p>
</li>
<li>
<p>select the account or the group</p>
</li>
<li>
<p>select the role you want to give</p>
</li>
<li>
<p>click on <em>Submit</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Global permissions are created or deleted, not updated.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-roles-project"><a class="anchor" href="#security-roles-project"></a>Project roles</h5>
<div class="paragraph">
<p>A project <strong>OWNER</strong> can perform all operations on a project but to delete it.</p>
</div>
<div class="paragraph">
<p>A project <strong>PARTICIPANT</strong> has the right to see a project and to add comments
in the validation runs (comment + status change).</p>
</div>
<div class="paragraph">
<p>A project <strong>VALIDATION_MANAGER</strong> can manage the validation stamps and
create/edit the validation runs.</p>
</div>
<div class="paragraph">
<p>A project <strong>PROMOTER</strong> can create and delete promotion runs, can change the
validation runs statuses.</p>
</div>
<div class="paragraph">
<p>A project <strong>PROJECT_MANAGER</strong> cumulates the functions of a PROMOTER and of a
VALIDATION_MANAGER. He can additional manage branches (creation / edition / deletion) and the common
build filters.</p>
</div>
<div class="paragraph">
<p>A project <strong>READ_ONLY</strong> user can view this project, but cannot perform any action on it.</p>
</div>
<div class="paragraph">
<p>Only project owners, automation users and administrators can grant rights
in a project.</p>
</div>
<div class="paragraph">
<p>In the project page, select the <em>Permissions</em> command.</p>
</div>
<div class="paragraph">
<p>A <em>project permission</em> is created by associating:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <em>permission target</em> (an account or a group)</p>
</li>
<li>
<p>a <em>project role</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Creation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>type the first letter of the account or the group you want to add a
permission for</p>
</li>
<li>
<p>select the account or the group</p>
</li>
<li>
<p>select the role you want to give</p>
</li>
<li>
<p>click on <em>Submit</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Project permissions are created or deleted, not updated.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security-accounts"><a class="anchor" href="#security-accounts"></a>5.1.3. Accounts</h4>
<div class="paragraph">
<p>Accounts are created with either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>built-in authentication, with a password stored and encrypted in Ontrack
itself</p>
</li>
<li>
<p><a href="#ldap">LDAP setup</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="security-accounts-builtin"><a class="anchor" href="#security-accounts-builtin"></a>Built-in accounts</h5>
<div class="paragraph">
<p>An <em>administrator</em> can create accounts. He must give them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a unique name</p>
</li>
<li>
<p>a unique email</p>
</li>
<li>
<p>a display name</p>
</li>
<li>
<p>an initial password</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any user can change his own password by going to the <em>Change password</em> menu.</p>
</div>
<div class="paragraph">
<p>The <em>administrator</em> can give an account a list of global or project roles.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-accounts-ldap"><a class="anchor" href="#security-accounts-ldap"></a>LDAP accounts</h5>
<div class="paragraph">
<p>Accounts whose authentication is managed by the LDAP are not created directly
but are instead created at first successful login.</p>
</div>
<div class="paragraph">
<p>As for the other types of accounts, the <em>administrator</em> can give them a list
of global or project roles.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security-groups"><a class="anchor" href="#security-groups"></a>5.1.4. Account groups</h4>
<div class="paragraph">
<p>An <em>administrator</em> can create groups using a name and a description, and assign
them a list of global or project roles.</p>
</div>
<div class="paragraph">
<p>An account can be assigned to several groups.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If LDAP is enabled, some LDAP groups can be <a href="#ldap-mapping">mapped</a> to
the account groups.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="security-general"><a class="anchor" href="#security-general"></a>5.1.5. General settings</h4>
<div class="paragraph">
<p>By default, all users (including anonymous ones) have access to all the
projects, at least in read only mode.</p>
</div>
<div class="paragraph">
<p>You can disable this anonymous access by goint go to the <em>Settings</em> and click
the <em>Edit</em> button in the <em>General</em> section. There you can set the
<em>Grants project view to all</em> option to <em>No</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="security-extending"><a class="anchor" href="#security-extending"></a>5.1.6. Extending the security</h4>
<div class="paragraph">
<p><a href="#extending">Extensions</a> can extend the security model beyond what
if defined in the Ontrack core. See
<a href="#extending-security">Extending the security</a> for more details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ldap"><a class="anchor" href="#ldap"></a>5.2. LDAP setup</h3>
<div class="paragraph">
<p>It is possible to enable authentication using a LDAP instance and to use the
LDAP-defined groups to map them against Ontrack groups.</p>
</div>
<div class="sect3">
<h4 id="ldap-setup"><a class="anchor" href="#ldap-setup"></a>5.2.1. LDAP general setup</h4>
<div class="paragraph">
<p>As an <em>administrator</em>, go to the <em>Settings</em> menu. In the <em>LDAP settings</em>
section, click on <em>Edit</em> and fill the following parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Enable LDAP authentication</em>: Yes</p>
</li>
<li>
<p><em>URL</em>: URL to your LDAP</p>
</li>
<li>
<p><em>User</em> and <em>Password</em>: credentials needed to access the LDAP</p>
</li>
<li>
<p><em>Search base</em>: query to get the user</p>
</li>
<li>
<p><em>Search filter</em>: filter on the user query</p>
</li>
<li>
<p><em>Full name attribute</em>: attribute which contains the full name, <code>cn</code> by
default</p>
</li>
<li>
<p><em>Email attribute</em>: attribute which contains the email, <code>email</code> by default</p>
</li>
<li>
<p><em>Group attribute</em>: attribute which contains the list of groups a user belongs
to, <code>memberOf</code> by default</p>
</li>
<li>
<p><em>Group filter</em>: optional, name of the OU field used to filter groups a user
belongs to</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
As of version 2.14, the list of groups (indicated by the <code>memberOf</code>
      attribute or any other attribute defined by the <em>Group attribute</em>
      property) is not searched recursively and that only the direct groups
      are taken into account.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/security.ldap.png" alt="LDAP settings" width="400">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The settings shown above are suitable to use with an Activate Directory
LDAP instance.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="ldap-mapping"><a class="anchor" href="#ldap-mapping"></a>5.2.2. LDAP group mapping</h4>
<div class="paragraph">
<p>A LDAP group a user belongs to can be used to map onto an Ontrack group.</p>
</div>
<div class="paragraph">
<p>As an <em>administrator</em>, go to the <em>Account management</em> menu and click on the
<em>LDAP mapping</em> command.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This command is only available if the LDAP authentication has been
enabled in the general settings.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To add a new mapping, click on <em>Create mapping</em> and enter:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <em>name</em> of the LDAP group you want to map</p>
</li>
<li>
<p>the Ontrack <em>group</em> which must be mapped</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, if you map the <code>ontrack_admin</code> LDAP group to an <em>Administrators</em>
group in Ontrack, any user who belongs to <em>ontrack_admin</em>  will automatically
be assigned to the <em>Administrators</em> group when connecting.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This assignment based on mapping is dynamic only, and no information is
stored about it in Ontrack.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that those LDAP mappings can be generated using the DSL.</p>
</div>
<div class="paragraph">
<p>Existing mappings can be updated and deleted.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="admin-console"><a class="anchor" href="#admin-console"></a>5.3. Administration console</h3>
<div class="paragraph">
<p>The <em>Administration console</em> is available to the <em>Administrators</em> only and is
accessed through the user menu.</p>
</div>
<div class="paragraph">
<p>It allows an administrator to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>manage the running <a href="#architecture-jobs">jobs</a></p>
</li>
<li>
<p>see the state of the external connections</p>
</li>
<li>
<p>see the list of <a href="#extending">extensions</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="admin-console-jobs"><a class="anchor" href="#admin-console-jobs"></a>5.3.1. Managing running jobs</h4>
<div class="paragraph">
<p>The list of all <a href="#architecture-jobs">registered jobs</a> is visible to the
administrator. From there, you can see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>general informations about the jobs: name, description</p>
</li>
<li>
<p>the run statistics</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="images/admin.jobs.overview.png" alt="Jobs" width="600">
</div>
</div>
<div class="sect4">
<h5 id="admin-console-jobs-filter"><a class="anchor" href="#admin-console-jobs-filter"></a>Filtering the jobs</h5>
<div class="paragraph">
<p>The following filters are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>status</p>
</li>
<li>
<p><em>idle jobs</em>: jobs which are scheduled, but not running right now</p>
</li>
<li>
<p><em>running jobs</em>: jobs which are currently running</p>
</li>
<li>
<p><em>paused jobs</em>: jobs which are normally scheduled but which have been paused</p>
</li>
<li>
<p><em>disabled jobs</em>: jobs which are currently disabled</p>
</li>
<li>
<p><em>invalid jobs</em>: jobs which have been marked as invalid by the system
(because their context is no longer applicable for example)</p>
</li>
<li>
<p>category and type of the job</p>
</li>
<li>
<p>error status - jobs whose last run raised an error</p>
</li>
<li>
<p>description - filtering using a search token on the job description</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="admin-console-jobs-control"><a class="anchor" href="#admin-console-jobs-control"></a>Controlling the jobs</h5>
<div class="paragraph">
<p>For one job, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>force it to run now, if not already running or disabled</p>
</li>
<li>
<p>pause it if it is a scheduled job</p>
</li>
<li>
<p>resume it if it was paused</p>
</li>
<li>
<p>remove it if it is an invalid job</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also pause or resume all the jobs using the <em>Actions</em> menu. All jobs
currently selected through the filter will be impacted.</p>
</div>
<div class="paragraph">
<p>The same <em>Actions</em> menu allows also to clear the current filter and to display
all the jobs.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="admin-console-health"><a class="anchor" href="#admin-console-health"></a>5.3.2. External connections</h4>

</div>
<div class="sect3">
<h4 id="admin-console-extensions"><a class="anchor" href="#admin-console-extensions"></a>5.3.3. List of extensions</h4>

</div>
</div>
<div class="sect2">
<h3 id="admin-log-entries"><a class="anchor" href="#admin-log-entries"></a>5.4. Application log messages</h3>
<div class="paragraph">
<p>The list of application log messages is available to the <em>Administrators</em> only
and is accessed through the user menu.</p>
</div>
<div class="paragraph">
<p>It allows an administrator to manage the error messages.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/admin.log.overview.png" alt="Overview" width="600">
</div>
</div>
<div class="paragraph">
<p>The log items are displayed from the most recent to the oldest. By default,
only 20 items are displayed on a page. You can navigate from page to page by
using the <em>Previous</em> and <em>Next</em> buttons.</p>
</div>
<div class="paragraph">
<p>You can filter the log entries you want to see by using the filter fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>after - only log entries created <em>after</em> this time will be displayed</p>
</li>
<li>
<p>before - only log entries created <em>before</em> this time will be displayed</p>
</li>
<li>
<p>authentication - you can enter the name of a user, and only errors having
occurred to this user will be displayed.</p>
</li>
<li>
<p>free text - this text will be searched in all other fields of the log message:
details, information, type.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click on the <em>Filter</em> button to activate the filter and on <em>Reset filter</em> to
delete all fields.</p>
</div>
<div class="paragraph">
<p>You can refresh the log entries by clicking the <em>Refresh log</em> button.</p>
</div>
<div class="paragraph">
<p>Finally, you can remove <em>all</em> log entries (all of them, independently from
the current filter) by clicking on the <em>Delete all entries</em> button. A
confirmation will be asked.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Log entries are kept only for 7 days. This delay can be configured. See
      the <a href="#configuration-properties">documentation</a> for more information.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can click on the <em>Details&#8230;&#8203;</em> button of a log entry to get more details
about the error:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/admin.log.details.png" alt="Details" width="400">
</div>
</div>
<div class="paragraph">
<p>If available, the stack trace can be selected and copied (actually, like any
other element of this dialog). Dismiss the dialog by clicking on the <em>OK</em>
button.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="integration"><a class="anchor" href="#integration"></a>6. Integration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="integration-jenkins"><a class="anchor" href="#integration-jenkins"></a>6.1. Integration with Jenkins</h3>
<div class="paragraph">
<p>The best way to integration Ontrack with your Jenkins instance is to use the
<a href="https://wiki.jenkins-ci.org/display/JENKINS/Ontrack+plugin">Ontrack plug-in</a>.</p>
</div>
<div class="paragraph">
<p>Look at its
<a href="https://wiki.jenkins-ci.org/display/JENKINS/Ontrack+plugin">documentation</a>
for details about its configuration and how to use it.</p>
</div>
</div>
<div class="sect2">
<h3 id="monitoring"><a class="anchor" href="#monitoring"></a>6.2. Monitoring</h3>
<div class="paragraph">
<p>Ontrack is based on <a href="http://projects.spring.io/spring-boot">Spring Boot</a> and
exports metrics and health indicators that can be used to monitor the status
of the applications.</p>
</div>
<div class="sect3">
<h4 id="monitoring-health"><a class="anchor" href="#monitoring-health"></a>6.2.1. Health</h4>
<div class="paragraph">
<p>The <code>/manage/health</code> end point provides a JSON tree which indicates the status
of all connected systems: JIRA, Jenkins, Subversion repositories, Git
repositories, etc.</p>
</div>
<div class="paragraph">
<p>Note than an administrator can have access to this information as a dashboard
in the <em>Admin console</em> (accessible through the user menu).</p>
</div>
</div>
<div class="sect3">
<h4 id="monitoring-metrics"><a class="anchor" href="#monitoring-metrics"></a>6.2.2. Metrics</h4>
<div class="paragraph">
<p>The default Spring Boot metrics, plus specific ones for Ontrack, are accessible
at the <code>/manage/metrics</code> end point.</p>
</div>
<div class="paragraph">
<p>Additionally, Ontrack can also export those metrics to a
<a href="http://graphite.wikidot.com">Graphite</a> or <a href="https://influxdb.com">InfluxDB</a>
back-end, to be displayed, for example, by <a href="http://grafana.org">Grafana</a>.</p>
</div>
<div class="sect4">
<h5 id="monitoring-metrics-graphite"><a class="anchor" href="#monitoring-metrics-graphite"></a>Export to Graphite</h5>
<div class="paragraph">
<p>The following options must be passed to Ontrack, either on the command line or
in a local <code>application.yml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ontrack.metrics.graphite.host</code> (required to enable Graphite export) host
name or IP of the Graphite backend</p>
</li>
<li>
<p><code>ontrack.metrics.graphite.port</code> (defaults to <code>2003</code>) port of the Graphite
backend</p>
</li>
<li>
<p><code>ontrack.metrics.graphite.period</code> (defaults to <code>60</code>) interval (in seconds)
at which the data is sent to Graphite</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following <code>application.yml</code> enables export to the <code>graphite</code>
host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">ontrack:
   metrics:
      graphite:
         host: graphite</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-metrics-influxdb"><a class="anchor" href="#monitoring-metrics-influxdb"></a>Export to InfluxDB</h5>
<div class="paragraph">
<p>The following options must be passed to Ontrack, either on the command line or
in a local <code>application.yml</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ontrack.metrics.influxdb.host</code> (required to enable InfluxDB export) host
name or IP of the InfluxDB backend</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.port</code> (defaults to <code>8086</code>) port of the InfluxDB
backend</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.user</code> (defaults to <code>root</code>) user used to connect to
InfluxDB</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.password</code> (defaults to <code>root</code>) password used to
connect to InfluxDB</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.database</code> (defaults to <code>ontrack</code>) name of the
database in InfluxDB to send metrics to</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.period</code> (defaults to <code>60</code>) interval (in seconds)
at which the data is sent to InfluxDB</p>
</li>
<li>
<p><code>ontrack.metrics.influxdb.retention-policy</code> (defaults to <code>autogen</code>) retention policy. Use <code>default</code> for InfluxDB
version &lt; 1.0.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following <code>application.yml</code> enables export to the
<code>influxdb</code> host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yaml" data-lang="yaml">ontrack:
   metrics:
      influxdb:
         host: influxdb</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-metrics-grafana"><a class="anchor" href="#monitoring-metrics-grafana"></a>Grafana dashboard</h5>
<div class="paragraph">
<p>You can
<a href="https://raw.githubusercontent.com/nemerosa/ontrack/master/doc/grafana.json">download this sample dashboard</a>
as a starting point for defining an Ontrack monitoring system in Grafana:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>download the <a href="https://raw.githubusercontent.com/nemerosa/ontrack/master/doc/grafana.json"><code>grafana.json</code></a> JSON file</p>
</li>
<li>
<p>import it in Grafana</p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="monitoring-metrics-list"><a class="anchor" href="#monitoring-metrics-list"></a>List of metrics</h5>
<div class="paragraph">
<p>Provided by Spring Boot:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#production-ready-system-metrics">system metrics</a></p>
</li>
<li>
<p><a href="http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#production-ready-datasource-metrics">datasource metrics</a></p>
</li>
<li>
<p><a href="http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#production-ready-session-metrics">session metrics</a></p>
</li>
<li>
<p><a href="http://docs.spring.io/spring-boot/docs/1.5.6.RELEASE/reference/htmlsingle/#production-ready-metrics">HTTP responses</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Job metrics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>job-category.Category.*</code> - <a href="https://dropwizard.github.io/metrics/3.1.0/manual/core/#timers">timer metrics</a> for the jobs in a given category (for example: <code>ontrack.counter.job-category.SVNIndexLatest</code>)</p>
</li>
<li>
<p><code>job.*</code> - <a href="https://dropwizard.github.io/metrics/3.1.0/manual/core/#timers">timer metrics</a> for all the jobs</p>
</li>
<li>
<p><code>gauge.jobs</code> - total number of jobs</p>
</li>
<li>
<p><code>gauge.jobs.running</code> - number of running jobs</p>
</li>
<li>
<p><code>gauge.jobs.disabled</code> - number of disabled jobs</p>
</li>
<li>
<p><code>gauge.jobs.error</code> - number of jobs in error</p>
</li>
<li>
<p><code>gauge.jobs.invalid</code> - number of invalid</p>
</li>
<li>
<p><code>gauge.jobs.paused</code> - number of invalid</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;</code> - total number of jobs for a given category</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;.running</code> - number of running jobs for a given category</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;.disabled</code> - number of disabled jobs for a given category</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;.error</code> - number of jobs in error for a given category</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;.invalid</code> - number of invalid jobs for a given category</p>
</li>
<li>
<p><code>gauge.jobs.&lt;category&gt;.paused</code> - number of paused jobs for a given category</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tagged job metrics:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Only since Ontrack 2.27 and only in InfluxDB. Those metrics are
associated with tags.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ontrack.job.count</code> - total number of jobs for a given job</p>
</li>
<li>
<p><code>ontrack.job.running</code> - number of running jobs for a given job</p>
</li>
<li>
<p><code>ontrack.job.disabled</code> - number of disabled jobs for a given job</p>
</li>
<li>
<p><code>ontrack.job.error</code> - number of jobs in error for a given job</p>
</li>
<li>
<p><code>ontrack.job.invalid</code> - number of invalid jobs for a given job</p>
</li>
<li>
<p><code>ontrack.job.paused</code> - number of paused jobs for a given job</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Following tags are associated with each of those measurements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>category</code> of the job</p>
</li>
<li>
<p><code>type</code> of the job</p>
</li>
<li>
<p><code>jobId</code> of the job</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Entity metrics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>gauge.entity.project</code> - number of projects</p>
</li>
<li>
<p><code>gauge.entity.branch</code> - number of branches</p>
</li>
<li>
<p><code>gauge.entity.build</code> - number of builds</p>
</li>
<li>
<p><code>gauge.entity.promotionLevel</code> - number of promotion levels</p>
</li>
<li>
<p><code>gauge.entity.promotionRun</code> - number of promotion runs</p>
</li>
<li>
<p><code>gauge.entity.validationStamp</code> - number of validation stamps</p>
</li>
<li>
<p><code>gauge.entity.validationRun</code> - number of validation runs</p>
</li>
<li>
<p><code>gauge.entity.validationRunStatus</code> - number of validation run statuses</p>
</li>
<li>
<p><code>gauge.entity.property</code> - number of properties attached to the entities</p>
</li>
<li>
<p><code>gauge.entity.event</code> - number of generated events</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Application errors metrics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>counter.errors</code> - number of errors which have occurred in Ontrack - using a derivative of this value can help having an idea of the frequency of errors</p>
</li>
<li>
<p><code>counter.errors.*</code> - number of errors for a given category, like <code>GitService</code> or <code>UIErrorHandler</code>)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="integration-graphql"><a class="anchor" href="#integration-graphql"></a>6.3. GraphQL support</h3>
<div class="paragraph">
<p>Since version 2.29, Ontrack provides some support for
<a href="http://graphql.org/">GraphQL</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While most of the Ontrack model is covered, only the query mode
is supported right now. Support for mutations might be integrated in
later releases.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The GraphQL end point is available at the <code>/graphql</code> context path. For example,
if Ontrack is available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a>, then the GraphQL end point
is available at <a href="http://localhost:8080/graphql" class="bare">http://localhost:8080/graphql</a>.</p>
</div>
<div class="paragraph">
<p>Ontrack supports all capabilities of GraphQL schema introspection.</p>
</div>
<div class="paragraph">
<p>Example of a GraphQL query, to get the list of branches for a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>{
   projects (id: 10) {
      branches {
         id
         name
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="integration-graphql-curl"><a class="anchor" href="#integration-graphql-curl"></a>6.4. Calling with Curl</h3>
<div class="paragraph">
<p>One basic way to integration with the GraphQL interface of Ontrack is to use
<a href="https://curl.haxx.se/">Curl</a>.</p>
</div>
<div class="paragraph">
<p>Given the following file:</p>
</div>
<div class="listingblock">
<div class="title">query.json</div>
<div class="content">
<pre class="prettyprint highlight"><code>{
   query: "{ projects (id: $projectId) { branches { id name }}}",
   variables: {
      projectId: 10
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can <code>POST</code> this file to the Ontrack GraphQL end point, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl -X POST --user user http://localhost:8080/graphql --data @query.json</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="integration-graphql-dsl"><a class="anchor" href="#integration-graphql-dsl"></a>6.5. Using the DSL</h3>
<div class="paragraph">
<p>The simplest way is to use the <a href="#dsl">Ontrack DSL</a> to run a query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def result = ontrack.graphQLQuery(
   '''{
      projects (id: $projectId) {
         id
         branches {
            id
            name
         }
      }
   }''',
   [
      projectId: 10,
   ]
)

assert result.errors != null &amp;&amp; result.errors.empty
assert result.data.projects.size() == 1
assert result.data.projects.get(0).id == 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="#dsl-ontrack-graphQLQuery"><code>graphQLQuery</code></a> documentation for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="integration-graphql-graphiql"><a class="anchor" href="#integration-graphql-graphiql"></a>6.6. GraphiQL support</h3>
<div class="paragraph">
<p>Ontrack supports <a href="https://github.com/graphql/graphiql">GraphiQL</a> and allows
to experiment with Ontrack GraphQL queries directly in your browser.</p>
</div>
<div class="paragraph">
<p>You can access the GraphiQL IDE page by clicking on the <em>GraphiQL</em> command
in the top right corner of the home page of Ontrack:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/graphiql-command.png" alt="GraphiQL Command" width="300">
</div>
</div>
<div class="paragraph">
<p>You can then type and experiment with your GraphQL queries:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/graphiql-ide.png" alt="GraphiQL IDE" width="600">
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The access rights used for your GraphQL queries are inherited
from your Ontrack connection. Connect with your user in Ontrack before
switching to the GraphiQL IDE. Login in from within GraphiQL is not
supported yet.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="integration-graphql-extending"><a class="anchor" href="#integration-graphql-extending"></a>6.7. Extending the GraphQL schema</h3>
<div class="paragraph">
<p>The core Ontrack GraphQL query schema can be extended by custom
<a href="#extending">extensions</a>.</p>
</div>
<div class="paragraph">
<p>See <a href="#extending-graphql">Extending GraphQL</a> for more information.</p>
</div>
</div>
<div class="sect2">
<h3 id="integration-encryption"><a class="anchor" href="#integration-encryption"></a>6.8. Encryption service</h3>
<div class="paragraph">
<p>Secrets used by Ontrack are <a href="#architecture-encryption">encrypted</a> using keys
managed by a <code>ConfidentialStore</code>.</p>
</div>
<div class="paragraph">
<p>Ontrack provides three types of storage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>file based storage (default)</p>
</li>
<li>
<p><a href="https://www.vaultproject.io/">Vault</a> storage</p>
</li>
<li>
<p>database storage</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If needed, you can also create your own form of storage using
<a href="#extension-encryption">extensions</a>.</p>
</div>
<div class="sect3">
<h4 id="integration-encryption-selection"><a class="anchor" href="#integration-encryption-selection"></a>6.8.1. Selection of the confidential store</h4>
<div class="paragraph">
<p>The selection of the confidential store is done at startup time using the
<code>ontrack.config.key-store</code>
<a href="#configuration-properties">configuration property</a>.</p>
</div>
<div class="paragraph">
<p>It defaults to <code>file</code> (see below).</p>
</div>
<div class="paragraph">
<p>Additional configuration properties might be needed according to the type of
store.</p>
</div>
</div>
<div class="sect3">
<h4 id="integration-encryption-file"><a class="anchor" href="#integration-encryption-file"></a>6.8.2. File confidential store</h4>
<div class="paragraph">
<p>This is the default store but its selection can be made explicit by setting
the <code>ontrack.config.key-store</code>
<a href="#configuration-properties">configuration property</a> to <code>file</code>.</p>
</div>
<div class="paragraph">
<p>This store will store the keys in the
<a href="#configuration-properties">working directory</a> under the
<code>security/secrets</code> subfolder.</p>
</div>
<div class="paragraph">
<p>A <code>master.key</code> file is used to encrypt the individual keys themselves, so
two files will be typically present:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>master.key</code></p>
</li>
<li>
<p><code>net.nemerosa.ontrack.security.EncryptionServiceImpl.encryption</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="integration-encryption-jdbc"><a class="anchor" href="#integration-encryption-jdbc"></a>6.8.3. JDBC confidential store</h4>
<div class="paragraph">
<p>This store manages the keys directly in the Ontrack database. It can be
selected by setting the <code>ontrack.config.key-store</code>
<a href="#configuration-properties">configuration property</a> to <code>jdbc</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This store is intrinsically insecure since it stores the keys
in the same location where the secrets are themselves stored.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>No further configuration is needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="integration-encryption-vault"><a class="anchor" href="#integration-encryption-vault"></a>6.8.4. Vault confidential store</h4>
<div class="paragraph">
<p>By setting the <code>ontrack.config.key-store</code>
<a href="#configuration-properties">configuration property</a> to <code>vault</code>, Ontrack
will use <a href="https://www.vaultproject.io/">Vault</a> to store its encryption keys.</p>
</div>
<div class="paragraph">
<p>Following configuration properties are available to configure the connection
to Vault:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.config.vault.uri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://localhost:8200" class="bare">http://localhost:8200</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI to the Vault end point</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.config.vault.token</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Token authentication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.config.vault.prefix</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>secret/ontrack/key</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path prefix for the storage of the keys
</p><p class="tableblock">WARNING: As of now, the support for Vault storage is <strong>experimental</strong> and is
subject to change in later releases. In particular, the authentication
mechanism might change.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="integration-encryption-migration"><a class="anchor" href="#integration-encryption-migration"></a>6.8.5. Migrating encryption keys</h4>
<div class="paragraph">
<p>In the event you want to migrate the encryption keys from one type of
storage to another, follow this procedure.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the procedure below, <code>${ONTRACK_URL}</code> designates the Ontrack URL
and <code>${ONTRACK_ADMIN_USER}</code> the name of an Ontrack user which has the
<code>ADMINISTRATOR</code> <a href="#security">role</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the initial configuration for the store, start by exporting the key:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl ${ONTRACK_URL}/admin/encryption \
   --user ${ONTRACK_ADMIN_USER} \
   --output ontrack.key</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will export the encryption key into the local <code>ontrack/key</code> file.</p>
</div>
<div class="paragraph">
<p>Start Ontrack using the new configuration.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
There might be errors are startup, when some <a href="#architecture-jobs">jobs</a>
start to collect some data from the external applications. Those errors can
be safely ignored for now.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Import the key file into Ontrack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">curl ${ONTRACK_URL}/admin/encryption \
   --user ${ONTRACK_ADMIN_USER} \
   -X PUT \
   -H "Content-Type: text/plain" \
   --data @ontrack.key</code></pre>
</div>
</div>
<div class="paragraph">
<p>Restart Ontrack.</p>
</div>
</div>
<div class="sect3">
<h4 id="integration-encryption-lost"><a class="anchor" href="#integration-encryption-lost"></a>6.8.6. Losing the encryption keys</h4>
<div class="paragraph">
<p>In case you lose the encryption keys, the consequence will be that the secrets
stored by Ontrack won&#8217;t be able to be decrypted. This will typically make the
external applications your Ontrack instance connects to unreachable.</p>
</div>
<div class="paragraph">
<p>The only to fix this is to reenter the secrets.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Some pages might not display correctly if some applications are not
reachable.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="integration-encryption-extending"><a class="anchor" href="#integration-encryption-extending"></a>6.8.7. Adding custom confidential store</h4>
<div class="paragraph">
<p>See <a href="#extending-encryption">Extending confidential stores</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dsl"><a class="anchor" href="#dsl"></a>7. DSL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ontrack provides several ways of interaction:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the graphical user interface (GUI)</p>
</li>
<li>
<p>the REST API (UI - also used internally by the GUI)</p>
</li>
<li>
<p>the Domain Specific Language (DSL)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the DSL, you can write script files which interact remotely with your
Ontrack instance.</p>
</div>
<div class="sect2">
<h3 id="dsl-usage"><a class="anchor" href="#dsl-usage"></a>7.1. DSL Usage</h3>
<div class="paragraph">
<p>In some cases, like when using the
<a href="https://github.com/nemerosa/ontrack-jenkins">Ontrack Jenkins plug-in</a>, you can
just write some Ontrack DSL to use it, because the configuration would have
been done for you.</p>
</div>
<div class="paragraph">
<p>In some other cases, you have to set-up the Ontrack DSL environment yourself.</p>
</div>
<div class="sect3">
<h4 id="dsl-usage-embedded"><a class="anchor" href="#dsl-usage-embedded"></a>7.1.1. Embedded</h4>
<div class="paragraph">
<p>You can embed the Ontrack DSL in your own code by importing it.</p>
</div>
<div class="paragraph">
<p>Using Maven:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;dependencies&gt;
   &lt;groupId&gt;net.nemerosa.ontrack&lt;/groupId&gt;
   &lt;artifactId&gt;ontrack-dsl&lt;/artifactId&gt;
   &lt;version&gt;{{ontrack-version}}&lt;/version&gt;
&lt;/dependencies&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Using Gradle:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>compile 'net.nemerosa.ontrack:ontrack-dsl:{{ontrack-version}}'</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usage-shell"><a class="anchor" href="#dsl-usage-shell"></a>7.1.2. Standalone shell</h4>
<div class="paragraph">
<p>See <a href="#dsl-tool">DSL Tool</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usage-connection"><a class="anchor" href="#dsl-usage-connection"></a>7.1.3. Connection</h4>
<div class="paragraph">
<p>Before calling any DSL script, you have to configure an <code>Ontrack</code> instance
which will connect to your remote Ontrack location:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import net.nemerosa.ontrack.dsl.*;

String url = "http://localhost:8080";
String user = "admin";
String password = "admin";

Ontrack ontrack = OntrackConnection.create(url)
   // Logging
   .logger(new OTHttpClientLogger() {
      public void trace(String message) {
         System.out.println(message);
      }
   })
   // Authentication
   .authenticate(user, password)
   // OK
   .build();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usage-retry"><a class="anchor" href="#dsl-usage-retry"></a>7.1.4. Retry mechanism</h4>
<div class="paragraph">
<p>By default, if the remote Ontrack API cannot be reached, the calls will fail. You can enable a retry mechanism
by defining a maximum number of retries and a delay between the retries (defaults to 10 seconds):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Ontrack ontrack = OntrackConnection.create(url)
    // ...
    // Max retries
    .maxTries(10)
    // Delay between retries (1 minute here)
    .retryDelaySeconds(60)
    // OK
    .build();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usage-calling"><a class="anchor" href="#dsl-usage-calling"></a>7.1.5. Calling the DSL</h4>
<div class="paragraph">
<p>The Ontrack DSL is expressed through Groovy and can be called using the
<code>GroovyShell</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import groovy.lang.Binding;
import groovy.lang.GroovyShell;

Ontrack ontrack = ...

Map&lt;String, Object&gt; values = new HashMap&lt;&gt;();
values.put("ontrack", ontrack);
Binding binding = new Binding(values);

GroovyShell shell = new GroovyShell(binding);

Object shellResult = shell.evaluate(script);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dsl-usecases"><a class="anchor" href="#dsl-usecases"></a>7.2. DSL Samples</h3>
<div class="sect3">
<h4 id="dsl-usecases-security"><a class="anchor" href="#dsl-usecases-security"></a>7.2.1. DSL Security</h4>
<div class="paragraph">
<p>The DSL allows to manage the <a href="#security">accounts</a> and the <a href="#security">account groups</a>.</p>
</div>
<div class="sect4">
<h5 id="dsl-usecases-security-accounts"><a class="anchor" href="#dsl-usecases-security-accounts"></a>Management of accounts</h5>
<div class="paragraph">
<p>To add or update a <em>built-in</em> account:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin.account(
   "dcoraboeuf",              // Name
   "Damien Coraboeuf",        // Display name
   "dcoraboeuf@nemerosa.net", // Email
   "my-secret-password",      // Password
   [                          // List of groups (optional)
      "Group1",
      "Group2"
   ]
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the list of accounts:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def accounts = ontrack.admin.accounts
def account = accounts.find { it.name == 'dcoraboeuf' }
assert account != null
assert account.fullName == "Damien Coraboeuf"
assert account.email == "dcoraboeuf@nemerosa.net"
assert account.authenticationSource.allowingPasswordChange
assert account.authenticationSource.id == "password"
assert account.authenticationSource.name == "Built-in"
assert account.role == "USER"
assert account.accountGroups.length == 2</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
LDAP accounts cannot be created directly. See the <a href="#security">documentation</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-security-account-permissions"><a class="anchor" href="#dsl-usecases-security-account-permissions"></a>Account permissions</h5>
<div class="paragraph">
<p>To give a role to an account:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin.setAccountGlobalPermission(
   'dcoraboeuf', "ADMINISTRATOR
)
ontrack.project('PROJECT')
ontrack.admin.setAccountProjectPermission(
   'PROJECT', 'dcoraboeuf', "OWNER
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the list of permissions for an account:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def permissions = ontrack.admin.getAccountProjectPermissions('PROJECT', 'dcoraboeuf')
assert permissions != null
assert permissions.size() == 1
assert permissions[0].id == 'OWNER'
assert permissions[0].name == 'Project owner'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-security-account-groups"><a class="anchor" href="#dsl-usecases-security-account-groups"></a>Management of account groups</h5>
<div class="paragraph">
<p>To add or update an account group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin.accountGroup('Administrators', "Group of administrators")</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the list of groups:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def groups = ontrack.admin.groups
def group = groups.find { it.name == 'Administrators' }
assert group.name == 'Administrators'
assert group.description == "Group of administrators"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-security-account-group-permissions"><a class="anchor" href="#dsl-usecases-security-account-group-permissions"></a>Account group permissions</h5>
<div class="paragraph">
<p>To give a role to an account group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin.setAccountGroupGlobalPermission(
   'Administrators', "ADMINISTRATOR"
)
ontrack.project('PROJECT')
ontrack.admin.setAccountGroupProjectPermission(
   'PROJECT', 'Administrators', "OWNER"
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the list of permissions for an account group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def permissions = ontrack.admin.getAccountGroupProjectPermissions('PROJECT', 'Administrators')
assert permissions != null
assert permissions.size() == 1
assert permissions[0].id == 'OWNER'
assert permissions[0].name == 'Project owner'</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-ldap-mapping"><a class="anchor" href="#dsl-usecases-ldap-mapping"></a>DSL LDAP mapping</h5>
<div class="paragraph">
<p>The <a href="#ldap">LDAP mappings</a> can be generated using the DSL.</p>
</div>
<div class="paragraph">
<p>To add or update a LDAP mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin.ldapMapping 'ldapGroupName', 'groupName'</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the list of LDAP mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">LDAPMapping mapping = ontrack.admin.ldapMappings[0]
assert mapping.name == 'ldapGroupName'
assert mapping.groupName == 'groupName'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usecases-images"><a class="anchor" href="#dsl-usecases-images"></a>7.2.2. DSL Images and documents</h4>
<div class="paragraph">
<p>Some resources can be associated with images (like promotion levels and validation stamps) and some documents can be
downloaded.</p>
</div>
<div class="paragraph">
<p>When uploading a document or an image, the DSL will accept any object (see below), optionally associated with a MIME
content type (the content type is either read from the source object or defaults to <code>image/png</code>).</p>
</div>
<div class="paragraph">
<p>The object can be any of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>URL</code> object - the MIME type and the binary content will be downloaded using the URL - the URL must be accessible
anonymously</p>
</li>
<li>
<p>a <code>File</code> object - the binary content is read from the file and the MIME type must be provided</p>
</li>
<li>
<p>a valid URL string - same as an <code>URL</code> - see above</p>
</li>
<li>
<p>a file path - same as a <code>File</code> - see above</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   branch('branch') {
      promotionLevel('COPPER', 'Copper promotion') {
         image '/path/to/local/file.png', 'image/png'
      }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Document and image downloads return a <code>Document</code> object with has two properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>content</code> - byte array</p>
</li>
<li>
<p><code>type</code> - MIME content type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, to store a promotion level&#8217;s image into a file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">File file = ...
def promotionLevel = ontrack.promotionLevel('project', 'branch', 'COPPER')
file.bytes = promotionLevel.image.content</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-usecases-changelogs"><a class="anchor" href="#dsl-usecases-changelogs"></a>7.2.3. DSL Change logs</h4>
<div class="paragraph">
<p>When a branch is configured for a SCM (Git, Subversion), a
<a href="#changelogs">change log</a> can be computed between two builds and following
collections can be displayed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>revisions or commits</p>
</li>
<li>
<p>issues</p>
</li>
<li>
<p>file changes</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Change logs can also be computed between builds which belong to different
     branches, as long as they are in the same project. <em>This is only
     supported for Git, not for Subversion.</em>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="dsl-usecases-changelogs-get"><a class="anchor" href="#dsl-usecases-changelogs-get"></a>Getting the change log</h5>
<div class="paragraph">
<p>Given two builds, one gets access to the change log using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def build1 = ontrack.build('proj', 'master', '1')
def build2 = ontrack.build('proj', 'master', '2')

def changelog = build1.getChangeLog(build2)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The returned change log might be <code>null</code> if the project and branches are
      not correctly configured.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On the returned <code>ChangeLog</code> object, one can access commits, issues and file
changes.</p>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-changelogs-commits"><a class="anchor" href="#dsl-usecases-changelogs-commits"></a>Commits</h5>
<div class="paragraph">
<p>The list of commits can be accessed using the <code>commits</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">changeLog.commits.each {
    println "* ${it.shortId} ${it.message} (${it.author} at ${it.timestamp})"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item in the <code>commits</code> collection has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code> - identifier, revision or commit hash</p>
</li>
<li>
<p><code>shortId</code> - short identifier, revision or abbreviated commit hash</p>
</li>
<li>
<p><code>author</code> - name of the committer</p>
</li>
<li>
<p><code>timestamp</code> - ISO date for the commit time</p>
</li>
<li>
<p><code>message</code> - raw message for the commit</p>
</li>
<li>
<p><code>formattedMessage</code> - HTML message with links to the issues</p>
</li>
<li>
<p><code>link</code> - link to the commit</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This covers only the common attributes provided by Ontrack - additional
      properties are also available for a specific SCM.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-changelogs-issues"><a class="anchor" href="#dsl-usecases-changelogs-issues"></a>Issues</h5>
<div class="paragraph">
<p>The list of issues can be accessed using the <code>issues</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">changeLog.issues.each {
    println "* ${it.displayKey} ${it.status} ${it.summary}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item in the <code>issues</code> collection has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>key</code> - identifier, like <code>1</code></p>
</li>
<li>
<p><code>displayKey</code> - display key (like <code>#1</code>)</p>
</li>
<li>
<p><code>summary</code> - short title for the issue</p>
</li>
<li>
<p><code>status</code> - status of the issue</p>
</li>
<li>
<p><code>url</code> - link to the issue</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This covers only the common attributes provided by Ontrack - additional
      properties are also available for a specific issue service.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-changelogs-export"><a class="anchor" href="#dsl-usecases-changelogs-export"></a>Exporting the change log</h5>
<div class="paragraph">
<p>The change log can also be exported as text (HTML and Markdown are also
available):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">String text = changeLog.exportIssues(
        format: 'text',
        groups: [
                'Bugs'        : ['defect'],
                'Features'    : ['feature'],
                'Enhancements': ['enhancement'],
        ],
        exclude: ['design', 'delivery']
)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>format</code> can be one of <code>text</code> (default), <code>html</code> or <code>markdown</code></p>
</li>
<li>
<p><code>groups</code> allows to group issues per type. If not defined, no grouping is done</p>
</li>
<li>
<p><code>exclude</code> defines the types of issues to not include in the change log</p>
</li>
<li>
<p><code>altGroup</code> defaults to <em>Other</em> and is the name of the group where remaining
issues do not fit.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="dsl-usecases-changelogs-files"><a class="anchor" href="#dsl-usecases-changelogs-files"></a>File changes</h5>
<div class="paragraph">
<p>The list of file changes can be accessed using the <code>files</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">changeLog.files.each {
    println "* ${it.path} (${it.changeType})"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item in the <code>files</code> collection has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>path</code> - path changed</p>
</li>
<li>
<p><code>changeType</code> - nature of the change</p>
</li>
<li>
<p><code>changeTypes</code> - list of changes on this path</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This covers only the common attributes provided by Ontrack - additional
      properties are also available for a specific SCM.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-templates"><a class="anchor" href="#dsl-templates"></a>7.2.4. DSL Branch template definitions</h4>
<div class="paragraph">
<p>Using the <code>template(Closure)</code> method on a branch, one can define the template
definition for a branch.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">template {
   parameter 'gitBranch', 'Name of the Git branch', 'release/${sourceName}'
   fixedSource '1.0', '1.1'
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>def parameter(String name, String description = '', String expression = '')</code>
 defines a parameter for the template, with an optional expression based on
a source name</p>
</li>
<li>
<p><code>def fixedSource(String&#8230;&#8203; names)</code>  sets a synchronization source on the
template, based on a fixed list of names</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can then use this branch definition in order to generate or update branches
from it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// Create a template
ontrack.branch('project', 'template') {
   template {
      parameter 'gitBranch', 'Name of the Git branch', 'release/${sourceName}'
   }
}
// Creates or updates the TEST instance
ontrack.branch('project', 'template').instance 'TEST', [
   gitBranch: 'my-branch'
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-scm"><a class="anchor" href="#dsl-scm"></a>7.2.5. DSL SCM extensions</h4>
<div class="paragraph">
<p>If a SCM (<a href="#usage-subversion">Subversion</a> or <a href="#usage-git">Git</a>) is correctly configured on a branch, it is possible
to download some files.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This is allowed only for the project owner.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the following <a href="#dsl-branch-download">call</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def text = ontrack.branch('project', 'branch').download('folder/subfolder/path.txt')</code></pre>
</div>
</div>
<div class="paragraph">
<p>will download the <code>folder/subfolder/path.txt</code> file from the corresponding SCM
branch. A <code>OTNotFoundException</code> exception is thrown if the file cannot be found.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dsl-tool"><a class="anchor" href="#dsl-tool"></a>7.3. DSL Tool</h3>
<div class="paragraph">
<p>Ontrack comes with an <em>Ontrack DSL Shell</em> tool that you can download from the
<a href="https://github.com/nemerosa/ontrack/releases">releases page</a>.</p>
</div>
<div class="paragraph">
<p>The <code>ontrack-dsl-shell.jar</code> is a fully executable JAR, published in GitHub
release and in the Maven Central, and can be used to setup a running instance
of Ontrack:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">ontrack-dsl-shell.jar --url ... --user ... --password ... --file ...</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can display the full list options using <code>ontrack-dsl-shell.jar --help</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>--file</code> argument is the path to a file containing the <a href="#dsl">Ontrack DSL</a>
to execute. If not set, or set to <code>-</code>, the DSL is taken from the standard
input. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">cat project-list.groovy | ontrack-dsl-shell.jar --url https://ontrack.nemerosa.net</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>project-list.groovy</code> contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.projects*.name</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would return a JSON like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">[
    "iteach",
    "ontrack",
    "ontrack-jenkins",
    "versioning"
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The tool always returns its response as JSON and its output can be pipelined with tools like
<a href="https://stedolan.github.io/jq/"><code>jq</code></a>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">cat project-list.groovy | ontrack-dsl-shell.jar --url https://ontrack.nemerosa.net | jq .</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The JAR is a
<a href="http://docs.spring.io/spring-boot/docs/1.4.0.RELEASE/reference/htmlsingle/#build-tool-plugins-gradle-repackage-configuration">real executable</a>,
so there is no need to use <code>java -jar</code> on Unix like systems or MacOS.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="dsl-reference"><a class="anchor" href="#dsl-reference"></a>7.4. DSL Reference</h3>
<div class="paragraph">
<p>See the <a href="#dsl-doc">appendixes</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="dsl-samples"><a class="anchor" href="#dsl-samples"></a>7.5. DSL Samples</h3>
<div class="paragraph">
<p>Creating a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.branch('project', 'branch').build('1', 'Build 1')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Promoting a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.build('project', '1', '134').promote('COPPER')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Validating a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.build('project', '1', '134').validate('SMOKETEST', 'PASSED')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Getting the last promoted build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def buildName = ontrack.branch('project', 'branch').lastPromotedBuilds[0].name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Getting the last build of a given promotion:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def branch = ontrack.branch('project', 'branch')
def builds = branch.standardFilter withPromotionLevel: 'BRONZE'
def buildName = builds[0].name</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configuring a whole branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   branch('1.0') {
      promotionLevel 'COPPER', 'Copper promotion'
      promotionLevel 'BRONZE', 'Bronze promotion'
      validationStamp 'SMOKE', 'Smoke tests'
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creating a branch template and an instance out of it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// Branch template definition
ontrack.project(project) {
   config {
      gitHub 'ontrack'
   }
   branch('template') {
      promotionLevel 'COPPER', 'Copper promotion'
      promotionLevel 'BRONZE', 'Bronze promotion'
      validationStamp 'SMOKE', 'Smoke tests'
      // Git branch
      config {
         gitBranch '${gitBranch}'
      }
      // Template definition
      template {
         parameter 'gitBranch', 'Name of the Git branch'
      }
   }
}
// Creates a template instance
ontrack.branch(project, 'template').instance 'TEST', [
   gitBranch: 'feature/test'
]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a>8. Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Contributions to <em>Ontrack</em> are welcome!</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fork the <a href="https://github.com/nemerosa/ontrack">GitHub project</a></p>
</li>
<li>
<p>Code your fixes and features</p>
</li>
<li>
<p>Create a pull request</p>
</li>
<li>
<p>Your pull requests, once tested successfully, will be integrated into the
<code>master</code> branch, waiting for the next release</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="contributing-branches"><a class="anchor" href="#contributing-branches"></a>8.1. Branching strategy</h3>
<div class="ulist">
<ul>
<li>
<p>development of features always goes to <code>feature/</code> branches</p>
</li>
<li>
<p>the branches are created from:</p>
<div class="ulist">
<ul>
<li>
<p>the <code>master</code> branch for version 2</p>
</li>
<li>
<p>the <code>v3</code> branch for version 3</p>
</li>
</ul>
</div>
</li>
<li>
<p>new releases are created by branching from <code>develop</code> (V2)
or <code>master</code> (V3), using <code>release/2.' or `release/3.</code> as a prefix</p>
</li>
<li>
<p>pull requests must be made from the <code>master</code> branch</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The versioning is automated using the
<a href="https://github.com/nemerosa/versioning">Gradle Versioning plug-in</a>. No file
needs to be updated to set the version.</p>
</div>
</div>
<div class="sect2">
<h3 id="development"><a class="anchor" href="#development"></a>8.2. Development</h3>
<div class="sect3">
<h4 id="development-setup"><a class="anchor" href="#development-setup"></a>8.2.1. Environment set-up</h4>
<div class="paragraph">
<p>Following tools must be installed before you can start coding with Ontrack:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.oracle.com">JDK8u25</a> or better</p>
</li>
<li>
<p><a href="https://www.docker.com/">Docker 1.11</a> or more recent</p>
</li>
<li>
<p><a href="https://docs.docker.com/compose/">Docker Compose 1.6.2</a> or more recent</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="development-postgres"><a class="anchor" href="#development-postgres"></a>Postgres set-up</h5>
<div class="paragraph">
<p>Starting from release 3, Ontrack uses a Postgresql database for its backend.</p>
</div>
<div class="paragraph">
<p>By default, the application will try to access it at
<code>jdbc:postgresql://localhost:5432/ontrack</code> using <code>ontrack</code> / <code>ontrack</code> as
credentials.</p>
</div>
<div class="paragraph">
<p>You can of course set the database yourself, but the best way is to run the
following Gradle command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew devInit</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will use Docker in order to set up a Postgres database container, exposing
the port <code>5432</code> on the host and named <code>postgresql</code>.</p>
</div>
<div class="paragraph">
<p>Following properties are available to personalize this setup:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>devPostgresPort</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>5432</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port the container must expose on the host</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>devPostgresName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>postgresql</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the container to create</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, to use the <code>5555</code> port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew devInit -PdevPostgresPort=5555</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This container is used only for your local development, and is not used
for running the <a href="#testing">integration tests</a>, where another container is
automatically created and destroyed.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="development-build"><a class="anchor" href="#development-build"></a>8.2.2. Building locally</h4>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew clean build</code></pre>
</div>
</div>
<div class="paragraph">
<p>To launch the integration tests or acceptance tests, see <a href="#testing">Testing</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="development-launch-gradle"><a class="anchor" href="#development-launch-gradle"></a>8.2.3. Launching the application from the command line</h4>
<div class="paragraph">
<p>Just run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew :ontrack-ui:bootRun</code></pre>
</div>
</div>
<div class="paragraph">
<p>The application is then available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</div>
</div>
<div class="sect3">
<h4 id="development-launch"><a class="anchor" href="#development-launch"></a>8.2.4. Launching the application in the IDE</h4>
<div class="paragraph">
<p>Prepare the Web resources by launching:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to launch the application, run the
<code>net.nemerosa.ontrack.boot.Application</code> class with
<code>--spring.profiles.active=dev</code> as argument.</p>
</div>
<div class="paragraph">
<p>The application is then available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</div>
</div>
<div class="sect3">
<h4 id="development-web"><a class="anchor" href="#development-web"></a>8.2.5. Developing for the web</h4>
<div class="paragraph">
<p>If you develop on the web side, you can enable a
<a href="http://livereload.com/">LiveReload</a> watch on the web resources:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew watch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Upon a change in the web resources, the browser page will be reloaded automatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="development-test"><a class="anchor" href="#development-test"></a>8.2.6. Running the tests</h4>
<div class="paragraph">
<p>See <a href="#testing">Testing</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="development-ide"><a class="anchor" href="#development-ide"></a>8.2.7. Integration with IDE</h4>
<div class="sect4">
<h5 id="development-ide-intellij"><a class="anchor" href="#development-ide-intellij"></a>With Intellij</h5>
<div class="ulist">
<ul>
<li>
<p>install the Lombok plugin</p>
</li>
<li>
<p>in <code>Build, Execution, Deployment &gt; Compiler &gt; Annotation Processors</code>, check <code>Enable annotation processing</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="delivery"><a class="anchor" href="#delivery"></a>8.2.8. Delivery</h4>
<div class="paragraph">
<p>Official releases for Ontrack are available at:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/nemerosa/ontrack/releases">GitHub</a> for the JAR, RPM
and Debian packages</p>
</li>
<li>
<p><a href="https://registry.hub.docker.com/nemerosa/ontrack">Docker Hub</a> for the Docker images</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="#installation">Installation</a> documentation to know how to install them.</p>
</div>
<div class="paragraph">
<p>To create a package for delivery, just run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew \
   clean \
   test \
   integrationTest \
   dockerLatest \
   build</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will create:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>ontrack-ui.jar</code></p>
</li>
<li>
<p>a <code>nemerosa/ontrack:latest</code> Docker image in your local registry</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you&#8217;re not interested in having a Docker image, just omit the
     <code>dockerLatest</code> task.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="delivery-versioning"><a class="anchor" href="#delivery-versioning"></a>Versioning</h5>
<div class="paragraph">
<p>The version of the Ontrack project is computed automatically from the current
SCM state, using the
<a href="https://github.com/nemerosa/versioning">Gradle Versioning plug-in</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="delivery-deploying"><a class="anchor" href="#delivery-deploying"></a>Deploying in production</h5>
<div class="paragraph">
<p>See the <a href="#installation">Installation</a> documentation.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="development-glossary"><a class="anchor" href="#development-glossary"></a>8.2.9. Glossary</h4>
<div class="paragraph">
<p><strong>Form</strong></p>
</div>
<div class="paragraph">
<p>Creation or update <em>links</em> can be accessed using the <code>GET</code> verb in order to get
a form that allows the client to carry out the creation or update.</p>
</div>
<div class="paragraph">
<p>Such a form will give information about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the fields to be created/updated</p>
</li>
<li>
<p>their format</p>
</li>
<li>
<p>their validation rules</p>
</li>
<li>
<p>their description</p>
</li>
<li>
<p>their default or current values</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The GUI can use those forms in order to automatically (and optionally) display
dialogs to the user. Since the model is responsible for the creation of those
forms, this makes the GUI layer more resilient to the changes.</p>
</div>
<div class="paragraph">
<p><strong>Link</strong></p>
</div>
<div class="paragraph">
<p>In <em>resources</em>, links are attached to <em>model</em> objects, in order to implement a
HATEOAS principle in the application interface.</p>
</div>
<div class="paragraph">
<p>HATEOAS does not rely exclusively on HTTP verbs since this would not allow a
strong implementation of the actual use cases and possible navigations (which
HATEOAS is all about).</p>
</div>
<div class="paragraph">
<p>For example, the "Project creation" link on the list of projects is <em>not</em>
carried by the sole <code>POST</code> verb, but by a <code>_create</code> link. This link can be
accessed through verbs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OPTIONS</code> - list of allowed verbs</p>
</li>
<li>
<p><code>GET</code> - access to a form that allows to create the object</p>
</li>
<li>
<p><code>POST</code> or <code>PUT</code> for an update - actual creation (or update) of the object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong><a href="#model">Model</a></strong></p>
</div>
<div class="paragraph">
<p>Representation of a concept in the application. This reflects the <em>ubiquitous
language</em> used throughout the application, and is used in all layers. As POJO
on server side, and JSON objects at client side.</p>
</div>
<div class="paragraph">
<p><strong>Repository</strong></p>
</div>
<div class="paragraph">
<p>Model objects are persisted, retrieved and deleted through repository objects.
Repositories act as a transparent persistence layer and hides the actual
technology being used.</p>
</div>
<div class="paragraph">
<p><strong>Resource</strong></p>
</div>
<div class="paragraph">
<p>A resource is a model object decorated with links that allow the client side to
interact with the API following the HATEOAS principle. More than just providing
access to the model structure, those links reflect the actual use cases and the
corresponding navigation. In particular, the links are driven by the
authorizations (a "create" link not being there if the user is not authorized).
See <em>Link</em> for more information.</p>
</div>
<div class="paragraph">
<p><strong>Service</strong></p>
</div>
<div class="paragraph">
<p>Services are used to provide interactions with the model.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="architecture"><a class="anchor" href="#architecture"></a>8.3. Architecture</h3>
<div class="sect3">
<h4 id="architecture-modules"><a class="anchor" href="#architecture-modules"></a>8.3.1. Modules</h4>
<div class="imageblock">
<div class="content">
<img src="modules.png" alt="modules" width="572" height="631">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Not all modules nor links are shown here in order to keep some clarity.
The Gradle build files in the source remain the main source of authority.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Modules are used in <em>ontrack</em> for two purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>isolation</p>
</li>
<li>
<p>distribution</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We distinguish also between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>core modules</p>
</li>
<li>
<p>extension modules</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Extension modules rely on the <code>extension-support</code> module to be compiled and
tested. The link between the core modules and the extensions is done through
the <code>extension-api</code> module, visible by the two worlds.</p>
</div>
<div class="paragraph">
<p>Modules like <code>common</code>, <code>json</code>, <code>tx</code> or <code>client</code> are purely utilitarian
(actually, they could be extracted from <code>ontrack</code> itself).</p>
</div>
<div class="paragraph">
<p>The main core module is the <code>model</code> one, which defines both the API of the
Ontrack services and the domain model.</p>
</div>
</div>
<div class="sect3">
<h4 id="architecture-ui"><a class="anchor" href="#architecture-ui"></a>8.3.2. UI</h4>
<div class="sect4">
<h5 id="architecture-ui-resources"><a class="anchor" href="#architecture-ui-resources"></a>Resources</h5>
<div class="paragraph">
<p>The UI is realized by REST controllers. They manipulate the <em>model</em> and get
access to it through <em>services</em>.</p>
</div>
<div class="paragraph">
<p>In the end, the controllers return <em>model</em> objects that must be decorated by
links in order to achieve Hateoas.</p>
</div>
<div class="paragraph">
<p>The controllers are not directly responsible for the decoration of the model
objects as <em>resources</em> (model + links). This is instead the responsibility of
the <em>resource decorators</em>.</p>
</div>
<div class="paragraph">
<p>The <em>model</em> objects are not returned as such, often their content needs to be
filtered out. For example, when getting a list of branches for a project, we
do not want each project to bring along its own copy of the project object.
This is achieved using the <em>model filtering</em> technics.</p>
</div>
</div>
<div class="sect4">
<h5 id="architecture-ui-decorators"><a class="anchor" href="#architecture-ui-decorators"></a>Resource decorators</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="architecture-ui-forms"><a class="anchor" href="#architecture-ui-forms"></a>8.3.3. Forms</h4>
<div class="paragraph">
<p>Simple input forms do not need a lot of effort to design in Ontrack. They
can be used directly in pages or in modal dialogs.</p>
</div>
<div class="paragraph">
<p>Server components (controllers, services, &#8230;&#8203;) are creating instances of the
<code>Form</code> object and the client libraries (<code>service.form.js</code>) is responsible
for their rendering:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="forms.png" alt="forms" width="309" height="270">
</div>
</div>
<div class="sect4">
<h5 id="architecture-ui-forms-object"><a class="anchor" href="#architecture-ui-forms-object"></a>Form object</h5>
<div class="paragraph">
<p>The <code>Form</code> object is created by adding <code>Field`s into it using its `with</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import net.nemerosa.ontrack.model.form.Form;
public Form getMyForm() {
   return Form.create()
      .with(field1)
      .with(field2)
      ;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the next section on how to create the field objects. The <code>Form</code> object
contains utility methods for common fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Form.create()
   // `name` text field (40 chars max), with "Name" as a label
   // constrained by the `[A-Za-z0-9_\.\-]+` regular expression
   // Suitable for most name fields on the Ontrack model objects
   // (projects, branches, etc.)
   .name()
   // `password` password field (40 chars max) with "Password" as a label
   .password()
   // `description` memo field (500 chars max), optional, with "Description"
   // as a label
   .description()
   // `dateTime` date/time field (see below) with "Date/time" as a label
   .dateTime()
   // ...
   ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to fill the fields with actual values, you can either use the
<code>value(&#8230;&#8203;)</code> method on the field object (see next section) or use
the <code>fill(&#8230;&#8203;)</code> method on the <code>Form</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Map&lt;String, ?&gt; data = ...
Form.create()
   // ...
   // Sets `value` as the value of the field with name "fieldName"
   .fill("fieldName", value)
   // Sets all values in the map using the key as the field name
   .fill(data)</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="architecture-ui-forms-fields"><a class="anchor" href="#architecture-ui-forms-fields"></a>Fields</h5>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-common"><a class="anchor" href="#architecture-ui-forms-fields-common"></a>Common field properties</h6>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>of(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>required</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mapping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>label</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>label(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Display name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>required</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>optional()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the input required?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>readOnly</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>readOnly()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the input read-only?</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validation(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Message to display is the field content is deemed invalid</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>help</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>help(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Help message to display for the field (see below for
  special syntax)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>visibleIf</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>visibleIf(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression which defines if the field is displayed or
  not - see below for a detailed explanation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>value(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value to associated with the field</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-help"><a class="anchor" href="#architecture-ui-forms-fields-help"></a><code>help</code> property</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-visibleIf"><a class="anchor" href="#architecture-ui-forms-fields-visibleIf"></a><code>visibleIf</code> property</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-text"><a class="anchor" href="#architecture-ui-forms-fields-text"></a><code>text</code> field</h6>
<div class="paragraph">
<p>The <code>text</code> field is a single line text entry field, mapped to the HTML
<code>&lt;input type="test"/&gt;</code> form field.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/architecture-ui-forms-fields-text.png" alt="Text" width="400">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>length(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>300</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum length for the text</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>regex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>regex(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The text must comply with this regex in order to be valid</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Form.create()
   .with(
      Text.of("name")
         .label("Name")
         .length(40)
         .regex("[A-Za-z0-9_\\.\\-]+")
         .validation("Name is required and must contain only alpha-numeric characters, underscores, points or dashes.")
   )</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-password"><a class="anchor" href="#architecture-ui-forms-fields-password"></a><code>password</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-memo"><a class="anchor" href="#architecture-ui-forms-fields-memo"></a><code>memo</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-email"><a class="anchor" href="#architecture-ui-forms-fields-email"></a><code>email</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-url"><a class="anchor" href="#architecture-ui-forms-fields-url"></a><code>url</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-named-entries"><a class="anchor" href="#architecture-ui-forms-fields-named-entries"></a><code>namedEntries</code> field</h6>
<div class="paragraph">
<p>Multiple list of name/value fields:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/architecture-ui-forms-fields-named-entries.png" alt="Named entries" width="500">
</div>
</div>
<div class="paragraph">
<p>The user can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>add / remove entries in the list</p>
</li>
<li>
<p>set a name and a value for each item</p>
</li>
<li>
<p>the name might be optional - the value is not</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nameLabel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nameLabel(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Name"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for the "name" input part of an entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>valueLabel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>valueLabel(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Value"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for the "value" input part of an entry.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nameRequired</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>nameOptional()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the name part is required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addText</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>addText(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"Add an entry"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Label for the "add" button.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">Form.create()
   .with(
      NamedEntries.of("links")
         .label("List of links")
         .nameLabel("Name")
         .valueLabel("Link")
         .nameOptional()
         .addText("Add a link")
         .help("List of links associated with a name.")
         .value(value != null ? value.getLinks() : Collections.emptyList())
   )</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-date"><a class="anchor" href="#architecture-ui-forms-fields-date"></a><code>date</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-yes-no"><a class="anchor" href="#architecture-ui-forms-fields-yes-no"></a><code>yesno</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-date-time"><a class="anchor" href="#architecture-ui-forms-fields-date-time"></a><code>dateTime</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-int"><a class="anchor" href="#architecture-ui-forms-fields-int"></a><code>int</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-selection"><a class="anchor" href="#architecture-ui-forms-fields-selection"></a><code>selection</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-multi-strings"><a class="anchor" href="#architecture-ui-forms-fields-multi-strings"></a><code>multi-strings</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-multi-selection"><a class="anchor" href="#architecture-ui-forms-fields-multi-selection"></a><code>multi-selection</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-multi-form"><a class="anchor" href="#architecture-ui-forms-fields-multi-form"></a><code>multi-form</code> field</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect5">
<h6 id="architecture-ui-forms-fields-custom"><a class="anchor" href="#architecture-ui-forms-fields-custom"></a>Creating your custom fields</h6>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="architecture-ui-forms-client"><a class="anchor" href="#architecture-ui-forms-client"></a>Form usage on the client</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="architecture-ui-forms-fields-rendering"><a class="anchor" href="#architecture-ui-forms-fields-rendering"></a>Fields rendering</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="architecture-model"><a class="anchor" href="#architecture-model"></a>8.3.4. Model</h4>
<div id="model" class="paragraph">
<p>The root entity in Ontrack is the <em>project</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="model.png" alt="model" width="469" height="428">
</div>
</div>
<div class="paragraph">
<p>Several <em>branches</em> can be attached to a <em>project</em>. <em>Builds</em> can be created
within a branch and linked to other builds (same or other branches).</p>
</div>
<div class="paragraph">
<p><em>Promotion levels</em> and <em>validation stamps</em> are attached to a <em>branch</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <em>promotion level</em> is used to define the <em>promotion</em> a given <em>build</em> has
reached. A <em>promotion run</em> defines this association.</p>
</li>
<li>
<p>a <em>validation stamp</em> is used to qualify some tests or other validations
on a <em>build</em>. A <em>validation run</em> defines this association. There can be
several runs per build and per validation stamp. A run itself has a sequence
of statuses attached to it: passed, failed, investigated, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Branches</em>, <em>promotion levels</em> and <em>validation stamps</em> define the <em>static
structure</em> of a <em>project</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="architecture-model-filtering"><a class="anchor" href="#architecture-model-filtering"></a>8.3.5. Model filtering</h4>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect3">
<h4 id="architecture-jobs"><a class="anchor" href="#architecture-jobs"></a>8.3.6. Jobs</h4>
<div class="paragraph">
<p>Ontrack makes a heavy use of <em>jobs</em> in order to schedule regular activities,
like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SCM indexation (for SVN for example)</p>
</li>
<li>
<p>SCM/build synchronisations</p>
</li>
<li>
<p>Branch templating synchronisation</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Services and extensions are responsible for providing Ontrack with the list of
<em>jobs</em> they want to be executed. They do this by implementing the
<code>JobProvider</code> interface that simply returns a collection of `JobRegistration`s
to register at startup.</p>
</div>
<div class="paragraph">
<p>One component can also register a <code>JobOrchestratorSupplier</code>, which provides
also a stream of `JobRegistration`s, but is more dynamic since the list
of jobs to register will be determined regularly.</p>
</div>
<div class="paragraph">
<p>The <em>job scheduler</em> is in charge to collect all <em>registered jobs</em> and to run
them all.</p>
</div>
<div class="sect4">
<h5 id="architecture-jobs-overview"><a class="anchor" href="#architecture-jobs-overview"></a>Job architecture overview</h5>
<div class="paragraph">
<p>This section explains the underlying concepts behind running the jobs in Ontrack.</p>
</div>
<div class="paragraph">
<p>When a job is registered, it is associated with a schedule. This schedule is dynamic and can be changed
with the time. For example, the indexation of a Git repository for a project is scheduled every 30 minutes,
but then, is changed to 60 minutes. The job registration schedule is then changed to every 60 minutes.</p>
</div>
<div class="paragraph">
<p>A job provides the following key elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a unique identifier: the <em>job key</em></p>
</li>
<li>
<p>a task to run, provided as a <code>JobRun</code> interface:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@FunctionalInterface
public interface JobRun {
    void run(JobRunListener runListener);
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The task defined by the job can use the provided <code>JobRunListener</code>  to provide feedback on the execution or to
execution messages.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The job task is wrapped into a <code>Runnable</code> which is responsible to collect statistics about the job execution, like
number of runs, durations, etc.</p>
</div>
<div class="paragraph">
<p>In the end, the <code>JobScheduler</code> can be associated with a <code>JobDecorator</code> to return another <code>Runnable</code> layer if needed.</p>
</div>
<div class="paragraph">
<p>The job scheduler is responsible to orchestrate the jobs. The list of jobs is maintained in memory using an index
associating the job itself, its schedule and its current scheduled task (as a <code>ScheduledFuture</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="architecture-jobs-registration"><a class="anchor" href="#architecture-jobs-registration"></a>Job registration</h5>
<div class="paragraph">
<p>A <code>JobRegistration</code> is the associated of a <code>Job</code> and of <code>Schedule</code> (run
frequency for the job).</p>
</div>
<div class="paragraph">
<p>A <code>Schedule</code> can be built in several ways:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">// Registration only, no schedule
Schedule.NONE
// Every 15 minutes, starting now
Schedule.everyMinutes(15)
// Every minute, starting now
Schedule.EVERY_MINUTE
// Every day, starting now
Schedule.EVERY_DAY
// Every 15 minutes, starting after 5 minutes
Schedule.everyMinutes(15).after(5)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
see the <code>Schedule</code> class for more options.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By enabling the <a href="#configuration-properties">scattering options</a>, one can
control the schedule by adding a startup delay at the beginning of the job.</p>
</div>
<div class="paragraph">
<p>The <code>Job</code> interface must define the unique for the job. A key in unique
within a type within a category.</p>
</div>
<div class="paragraph">
<p>Typically, the category and the type will be fixed (constants) while the
key will depend on the job parameters and context. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">JobCategory CATEGORY = JobCategory.of("category").withName("My category");
JobType TYPE = CATEGORY.getType("type").withName("My type");
public JobKey getKey() {
   return TYPE.getKey("my-id")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Job</code> provides also a description, and the desired state of the job:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>disabled or not - might depend on the job parameters and context. For example,
the job which synchronizes a branch instance with its template will be disable
if the branch is disabled</p>
</li>
<li>
<p>valid or not - when a job becomes invalid, it is not executed, and will be
unregistered automatically. For example, a Subversion indexation job might
become invalid if the associated repository configuration has been deleted.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, of course, the job must provide the task to actually execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public JobRun getTask() {
   return (JobRunListener listener) -&gt; ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The task takes as parameter a <code>JobRunListener</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
All job tasks run with <em>administrator</em> privileges. <em>Job tasks</em> can
throw runtime exceptions - they will be caught by the <em>job scheduler</em> and
displayed in the <a href="#admin-console-jobs">administration console</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="architecture-encryption"><a class="anchor" href="#architecture-encryption"></a>8.3.7. Encryption</h4>
<div class="paragraph">
<p>Ontrack will store secrets, typically passwords and tokens, together with
the configurations needed to connect to external applications: Git,
Subversion, JIRA, etc.</p>
</div>
<div class="paragraph">
<p>In order to protect the integrity of those external applications, those secrets
must be protected.</p>
</div>
<div class="paragraph">
<p>Ontrack does so by encrypting those secrets in the database, using the
<code>AES128</code> algorithm. The <code>EncryptionService</code> is used for encryption.</p>
</div>
<div class="paragraph">
<p>The key needed for the encryption is stored and retrieved using a
<code>ConfidentialStore</code> service.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="architecture-encryption.png" alt="architecture encryption" width="960" height="922">
</div>
</div>
<div class="paragraph">
<p>See <a href="#integration-encryption">Encryption service</a> for more details about using a confidential
store.</p>
</div>
</div>
<div class="sect3">
<h4 id="architecture-build-filters"><a class="anchor" href="#architecture-build-filters"></a>8.3.8. Build filters</h4>
<div class="paragraph">
<p>The <em>build filters</em> are responsible for the filtering of <em>builds</em> when listing
them for a <em>branch</em>.</p>
</div>
<div class="sect4">
<h5 id="architecture-build-filters-usage"><a class="anchor" href="#architecture-build-filters-usage"></a>Usage</h5>
<div class="paragraph">
<p>By default, only the last 10 builds are shown for a branch, but a user can
choose to create filters for a branch, and to select them.</p>
</div>
<div class="paragraph">
<p>The filters he creates are saved for later use:
* locally, in its local browser storage
* remotely, on the server, if he is connected</p>
</div>
<div class="paragraph">
<p>For a given branch, a filter is identified by a name. The list of available
filters for a branch is composed of those stored locally and of those returned
by the server. The later ones have priority when there is a name conflict.</p>
</div>
</div>
<div class="sect4">
<h5 id="architecture-build-filters-implementation"><a class="anchor" href="#architecture-build-filters-implementation"></a>Implementation</h5>
<div class="paragraph">
<p>The <code>BuildFilter</code> interface defines how to use a filter. This filter takes as
parameters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the current list of filtered builds</p>
</li>
<li>
<p>the branch</p>
</li>
<li>
<p>the build to filter</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It returns two boolean results:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is the build to be kept in the list?</p>
</li>
<li>
<p>do we need to go on with looking for other builds?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>BuildFilterService</code> is used to manage the build filters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by creating <code>BuildFilter</code> instances</p>
</li>
<li>
<p>by managing <code>BuildFilterResource</code> instances</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The service determines the type of <code>BuildFilter</code> by using its type, and uses
injected `BuildFilterProvider`s to get an actual instance.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="reference-services"><a class="anchor" href="#reference-services"></a>8.3.9. Reference services</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This is a work in progress and this list is not exhaustive yet. In the
meantime, the best source of information remains the
<a href="https://github.com/nemerosa/ontrack">source code</a>&#8230;&#8203;
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>StructureService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to projects, branches and all <a href="#model">entities</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SecurityService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checks the current context for authorizations</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PropertyService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to the <a href="#properties">properties</a> of the <a href="#model">entities</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EntityDataService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This service allows to store and retrieve arbitrary data with
  <a href="#model">entities</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>EntityDataStore</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This service allows to store audited and indexed data with
  <a href="#model">entities</a>. See <a href="#reference-service-entity-data-store"><code>EntityDataStore</code></a> for
  more information.</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="reference-service-entity-data-store"><a class="anchor" href="#reference-service-entity-data-store"></a><code>EntityDataStore</code></h5>
<div class="paragraph">
<p>The <code>EntityDataStore</code> is a service which allows <a href="#extending">extensions</a> to store
some data associated with <a href="#model">entities</a> with the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>data stored as JSON</p>
</li>
<li>
<p>data always associated with an <a href="#model">entity</a></p>
</li>
<li>
<p>indexation by category and name, not necessarily unique</p>
</li>
<li>
<p>grouping of data using a group ID</p>
</li>
<li>
<p>unique generated numeric ID</p>
</li>
<li>
<p>audit data - creation + updates</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the Javadoc for <code>net.nemerosa.ontrack.repository.support.store.EntityDataStore</code>
for more details.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Autowired
EntityDataStore store;
@Autowired
SecurityService securityService;

Branch branch = ...

store.add(branch, "Category", "Name", securityService.getCurrentSignature(), null, json);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="architecture-metrics"><a class="anchor" href="#architecture-metrics"></a>8.3.10. Metrics</h4>
<div class="paragraph">
<p>Ontrack <a href="#monitoring">metrics</a> are collected and exposed using the
<a href="http://projects.spring.io/spring-boot">Spring Boot</a> framework.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="architecture-metrics-sequence.png" alt="architecture metrics sequence" width="1181" height="754">
</div>
</div>
</div>
<div class="sect3">
<h4 id="artifacture-technology"><a class="anchor" href="#artifacture-technology"></a>8.3.11. Technology</h4>
<div class="sect4">
<h5 id="artifacture-technology-client"><a class="anchor" href="#artifacture-technology-client"></a>Client side</h5>
<div class="paragraph">
<p>One page only, pure AJAX communication between the client and the server.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>AngularJS</p>
</li>
<li>
<p>Angular UI Router</p>
</li>
<li>
<p>Angular UI Bootstrap</p>
</li>
<li>
<p>Bootstrap</p>
</li>
<li>
<p>Less</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="artifacture-technology-server"><a class="anchor" href="#artifacture-technology-server"></a>Server side</h5>
<div class="ulist">
<ul>
<li>
<p>Spring Boot for the packaging &amp; deployment</p>
</li>
<li>
<p>Spring MVC for the REST API</p>
</li>
<li>
<p>Spring for the IoC</p>
</li>
<li>
<p>Spring Security &amp; AOP for the security layer</p>
</li>
<li>
<p>Plain JDBC for the data storage</p>
</li>
<li>
<p>H2 in MySQL mode for the database engine</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="artifacture-technology-layers"><a class="anchor" href="#artifacture-technology-layers"></a>Layers</h5>
<div class="imageblock">
<div class="content">
<img src="layers.png" alt="layers" width="466" height="242">
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="testing"><a class="anchor" href="#testing"></a>8.4. Testing</h3>
<div class="ulist">
<ul>
<li>
<p><em>unit tests</em> are always run and should not access resources not load the
application context (think: fast!)</p>
</li>
<li>
<p><em>integration tests</em> can access resources or load the application context,
and run against a database</p>
</li>
<li>
<p><em>acceptance tests</em> are run against the deployed and running application.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="testing-unit"><a class="anchor" href="#testing-unit"></a>8.4.1. Running the unit and integration tests</h4>
<div class="paragraph">
<p>In order to run the <em>unit tests</em> only:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew test</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to add the <em>integration tests</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew integrationTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>From your IDE, you can launch both unit and integration tests using the default
JUnit integration.</p>
</div>
</div>
<div class="sect3">
<h4 id="testing-acceptance"><a class="anchor" href="#testing-acceptance"></a>8.4.2. Acceptance tests</h4>
<div class="sect4">
<h5 id="testing-acceptance-cmd"><a class="anchor" href="#testing-acceptance-cmd"></a>On the command line</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This requires Docker &amp; Docker Compose to be installed and correctly
configured.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The application can be deployed on a local Docker container, running on SSL with a self signed certificate, and
tested by running all the acceptance tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew ciAcceptanceTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using a Docker Machine, you will have to specify the Docker host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew ciAcceptanceTest -PciMachine=`docker-machine ip build`</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>build</code> is the name of the Docker machine.</p>
</div>
<div class="paragraph">
<p>If the Docker container used for the tests must be kept, add the <code>-x ciStop</code>
to the arguments.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To only deploy the application in a container without launching any test,
you can also run <code>./gradlew ciStart</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="testing-acceptance-ide"><a class="anchor" href="#testing-acceptance-ide"></a>From the IDE</h5>
<div class="paragraph">
<p>In order to develop or test acceptance tests, you might want to run them from
your IDE.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure you have a running application somewhere, either by launching it
from your IDE (see <a href="#development-ide">Integration with IDE</a>) or by running <code>ciStart</code> (see previous
section).</p>
</li>
<li>
<p>Launch all, some or one test in the <code>ontrack-acceptance</code> module after having
set the following system properties:</p>
<div class="ulist">
<ul>
<li>
<p><code>ontrack.url</code> - the URL of the running application to test - defaults to
<a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</li>
<li>
<p><code>ontrack.disableSSL</code> - <code>true</code> if the server is running with a self signed
certificate, and if you&#8217;re using <code>https</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="testing-acceptance-sa"><a class="anchor" href="#testing-acceptance-sa"></a>Standalone mode</h5>
<div class="paragraph">
<p>For testing <code>ontrack</code> in real mode, with the application to test deployed on a
remote machine, it is needed to be able to run acceptance tests in standalone
mode, without having to check the code out and to build it.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Running the acceptance tests using the <code>ciAcceptanceTest</code> Gradle task
remains the easiest way.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The acceptance tests are packaged as a standalone JAR, that contains all
the dependencies.</p>
</div>
<div class="paragraph">
<p>To run the acceptance tests, you need a JDK8 and you have to run the JAR using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">java -jar ontrack-acceptance.jar &lt;options&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--option.acceptance.url=&lt;url&gt;</code> to specify the <code>&lt;url&gt;</code> where <code>ontrack</code> is deployed. It
defaults to <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</li>
<li>
<p><code>--option.acceptance.admin=&lt;password&gt;</code> to specify the administrator password. It
defaults to <code>admin</code>.</p>
</li>
<li>
<p><code>--option.acceptance.context=&lt;context&gt;</code> can be specified several time to define the
context(s) the acceptance tests are running in (like
<code>--option.acceptance.context=production</code> for example). According to the context, some
tests can be excluded from the run.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The results of the tests is written as a JUnit XML file, in
<code>build/acceptance/ontrack-acceptance.xml</code>.</p>
</div>
<div class="paragraph">
<p>The directory can be changed using the <code>ontrack.acceptance.output-dir</code> argument
or system property and defaults to <code>build/acceptance</code>.</p>
</div>
<div class="paragraph">
<p>The JUnit result file name can be changed using the <code>ontrack.acceptance.result-file-name</code> argument
or system property and defaults to <code>ontrack-acceptance.xml</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="testing-dev"><a class="anchor" href="#testing-dev"></a>8.4.3. Developing tests</h4>
<div class="paragraph">
<p>Unit tests are JUnit tests whose class name ends with <code>Test</code>.
Integration tests are JUnit tests whose class name ends with <code>IT</code>.
Acceptance tests are JUnit tests whose class name starts with <code>ACC</code> and are
located in the <code>ontrack-acceptance</code> module.</p>
</div>
<div class="sect4">
<h5 id="testing-dev-unit"><a class="anchor" href="#testing-dev-unit"></a>Unit test context</h5>
<div class="paragraph">
<p>Unit tests do not need any application context or any database.</p>
</div>
</div>
<div class="sect4">
<h5 id="testing-dev-it"><a class="anchor" href="#testing-dev-it"></a>Integration test context</h5>
<div class="paragraph">
<p>Integration tests will usually load an application context and connect to a
Postgresql database.</p>
</div>
<div class="paragraph">
<p>For commodity, those tests will inherit from the <code>AbstractITTestSupport</code> class,
and more specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>from <code>AbstractRepositoryTestSupport</code> for JDBC repository integration tests</p>
</li>
<li>
<p>from <code>AbstractServiceTestSupport</code> for service integration tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Configuration for the integration tests is done in the <code>ITConfig</code> class.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extending"><a class="anchor" href="#extending"></a>8.5. Extending Ontrack</h3>
<div class="paragraph">
<p>Ontrack allows extensions to contribute to the application, and actually, most
of the core features, like <a href="#changelogs">Git change logs</a>,
are indeed extensions.</p>
</div>
<div class="paragraph">
<p>This page explains how to create your own extensions and to deploy them along
Ontrack. The same coding principles apply also for coding core extensions and
to package them in the main application.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Having the possibility to have external extensions in Ontrack is very
new and the way to provide them is likely to change (a bit) in the next
versions. In particular, the extension mechanism does not provide classpath
isolation between the "plugins".
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="extending-preparing"><a class="anchor" href="#extending-preparing"></a>8.5.1. Preparing an extension</h4>
<div class="paragraph">
<p>In order to create an extension, you have to create a Java project.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The use of <a href="#extending-kotlin">Kotlin</a> is also possible.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that Ontrack needs at least a JDK8u65 to run.</p>
</div>
<div class="paragraph">
<p>Your extension needs to a Gradle project and have at least this minimal
<code>build.gradle</code> file:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Maven might be supported in the future.
</td>
</tr>
</table>
</div>
<div class="literalblock">
<div class="content">
<pre>buildscript {
   repositories {
      mavenCentral()
      jcenter()
   }
   dependencies {
      classpath 'net.nemerosa.ontrack:ontrack-extension-plugin:{{ontrack-version}}'
   }
}
repositories {
   mavenCentral()
}
apply plugin: 'ontrack'</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>buildscript</code> section declares the version of Ontrack you&#8217;re building your
extension for. Both the <code>mavenCentral</code> and the <code>jcenter</code> repositories are needed
to resolve the path for the <code>ontrack-extension-plugin</code> since the plugin is
itself published in the Maven Central and some of its dependencies are in
JCenter.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The repository declaration might be simplified in later versions.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The plug-in must declare the Maven Central as repository for the dependencies
(Ontrack libraries are published in the Maven Central).</p>
</div>
<div class="paragraph">
<p>Finally, you can apply the <code>ontrack</code> plug-in. This one will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>apply the <code>java</code> plug-in. If you want to use Groovy, you&#8217;ll have to apply
this plug-in yourself. <a href="#extending-kotlin">Kotlin</a> is very well supported.</p>
</li>
<li>
<p>add the <code>ontrack-extension-support</code> module to the <code>compile</code> configuration
of your extension</p>
</li>
<li>
<p>define some tasks used for running, testing and packaging your extension
(see later)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="extending-id"><a class="anchor" href="#extending-id"></a>8.5.2. Extension ID</h4>
<div class="paragraph">
<p>Your extension must be associated with an identifier, which will be used
throughout all the extension mechanism of Ontrack.</p>
</div>
<div class="paragraph">
<p>If the <code>name</code> of your extension project looks like <code>ontrack-extension-&lt;xxx&gt;</code>,
the <code>xxx</code> will be ID of your extension. For example, in the
<code>settings.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">rootProject.name = 'ontrack-extension-myextension'</code></pre>
</div>
</div>
<div class="paragraph">
<p>then <code>myextension</code> is your extension ID.</p>
</div>
<div class="paragraph">
<p>If for any reason, you do not want to use <code>ontrack-extension-</code> as a prefix for
your extension name, you must specify it using the <code>ontrack</code> Gradle extension
in the <code>build.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack {
   id 'myextension'
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-coding"><a class="anchor" href="#extending-coding"></a>8.5.3. Coding an extension</h4>
<div class="paragraph">
<p>All your code must belong to a package starting with <code>net.nemerosa.ontrack</code> in
order to be visible by the Ontrack application.</p>
</div>
<div class="paragraph">
<p>Typically, this should be like: <code>net.nemerosa.ontrack.extension.&lt;id&gt;</code> where
<code>id</code> is the ID of your extension.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This limitation about the package name is likely to removed in future
versions of Ontrack.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You now must declare your extension to Ontrack by creating an
<em>extension feature</em> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package net.nemerosa.ontrack.extension.myextension;

import net.nemerosa.ontrack.extension.support.AbstractExtensionFeature;
import net.nemerosa.ontrack.model.extension.ExtensionFeatureOptions;
import org.springframework.stereotype.Component;

@Component
public class MyExtensionFeature extends AbstractExtensionFeature {
    public MyExtensionFeature() {
        super(
            "myextension",
            "My extension",
            "Sample extension for Ontrack",
            ExtensionFeatureOptions.DEFAULT
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Component</code> annotation makes this extension feature visible by Ontrack.</p>
</div>
<div class="paragraph">
<p>The arguments for the extension feature constructor are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the extension ID</p>
</li>
<li>
<p>the display name</p>
</li>
<li>
<p>a short description</p>
</li>
<li>
<p>the extension options (see below)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="extending-options"><a class="anchor" href="#extending-options"></a>8.5.4. Extension options</h4>
<div class="paragraph">
<p>If your extension has some web components (templates, pages, etc.), it must
declare this fact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">ExtensionFeatureOptions.DEFAULT.withGui(true)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your extension depends on other extensions, it must declare them. For
example, to depend on GitHub and Subversion extensions, first declare them as
dependencies in the <code>build.gradle</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack {
   uses 'github'
   uses 'svn'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then, in your code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class MyExtensionFeature extends AbstractExtensionFeature {
    @Autowired
    public MyExtensionFeature(
      GitHubExtensionFeature gitHubExtensionFeature,
      SVNExtensionFeature svnExtensionFeature
    ) {
        super(
            "myextension",
            "My extension",
            "Sample extension for Ontrack",
            ExtensionFeatureOptions.DEFAULT
               .withDependency(gitHubExtensionFeature)
               .withDependency(svnExtensionFeature)
        );
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-testing"><a class="anchor" href="#extending-testing"></a>8.5.5. Writing tests for your extension</h4>
<div class="paragraph">
<p>Additionally to creating unit tests for your extension, you can also write
integration tests, which will run with the Ontrack runtime enabled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This feature is only available starting from version 2.23.1.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the <code>ontrack-extension-plugin</code> is applied to your code, it makes the
<code>ontrack-it-utils</code> module available for the compilation of your tests.</p>
</div>
<div class="paragraph">
<p>In particular, this allows you to create integration tests which inherit from
<code>AbstractServiceTestSupport</code>, to inject directly the Ontrack services you need
and to use utility methods to create a test environment.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public MyTest extends AbstractServiceTestSupport {
   @Autowired
   private StructureService structureService
   @Test
   public void sample_test() {
      // Creates a project
      Project p = doCreateProject();
      // Can retrieve it by name...
      asUser().withView(p).execute(() -&gt;
         assertTrue(structureService.findProjectByName(p.getName()).isPresent())
      );
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-extensions"><a class="anchor" href="#extending-extensions"></a>8.5.6. List of extension points</h4>
<div class="paragraph">
<p>Ontrack provides the following extension points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#extending-properties">Properties</a> - allows to attach a property to an <a href="#model">entity</a></p>
</li>
<li>
<p><a href="#extending-decorators">Decorators</a> - allows to display a decoration for an <a href="#model">entity</a></p>
</li>
<li>
<p><a href="#extending-usermenu">User menu action</a> - allows to add an entry in the connected user menu</p>
</li>
<li>
<p><a href="#extending-settings">Settings</a> - allows to add an entry in the global settings</p>
</li>
<li>
<p><a href="#extending-metrics">Metrics</a> - allows to contribute to the
<a href="#monitoring">metrics</a> exported by Ontrack</p>
</li>
<li>
<p><a href="#extending-event-types">Event types</a> - allows to define additional event types.</p>
</li>
<li>
<p><a href="#extending-graphql">GraphQL</a> - allows contributions to the <a href="#integration-graphql">GraphQL</a> Ontrack schema.</p>
</li>
<li>
<p><a href="#extending-encryption">Encryption key store</a> - allows to define a custom store for the <a href="#integration-encryption">encryption keys</a>.</p>
</li>
<li>
<p><strong>TODO</strong> Entity action - allows to add an action for the page of an entity</p>
</li>
<li>
<p><strong>TODO</strong> Entity information - allows to add some information into the page of an entity</p>
</li>
<li>
<p><strong>TODO</strong> Search extension - provides a search end point for global text based searches</p>
</li>
<li>
<p><strong>TODO</strong> Issue service - provides support for a ticketing system</p>
</li>
<li>
<p><strong>TODO</strong> SCM service - provides support for a SCM system</p>
</li>
<li>
<p><strong>TODO</strong> Account management action - allows to add an action into the account management</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#extending-pages">Creating pages</a></p>
</li>
<li>
<p><strong>TODO</strong> Creating services</p>
</li>
<li>
<p><strong>TODO</strong> Creating jobs</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="#reference-services">Reference services</a> for a list of the core Ontrack services.</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-running"><a class="anchor" href="#extending-running"></a>8.5.7. Running an extension</h4>
<div class="sect4">
<h5 id="extending-running-gradle"><a class="anchor" href="#extending-running-gradle"></a>Using Gradle</h5>
<div class="paragraph">
<p>To run your extension using Gradle:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew ontrackRun</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This does not work yet for Ontrack 3.0 (with Postgresql)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This will make the application available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a></p>
</div>
<div class="paragraph">
<p>The <code>ontrackRun</code> Gradle task can be run directly from Intellij IDEA and if
necessary in debug mode.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When running with Gradle in your IDE, if you edit some web resources and
want your changes available in the browser, just rebuild your project
(<code>Ctrl F9</code> in Intellij) and refresh your browser.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-packaging"><a class="anchor" href="#extending-packaging"></a>8.5.8. Packaging an extension</h4>
<div class="paragraph">
<p>Just run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">./gradlew clean build</code></pre>
</div>
</div>
<div class="paragraph">
<p>The extension is available as a JAR (together with its transitive dependencies,
see below) in <code>build/dist</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-dependencies"><a class="anchor" href="#extending-dependencies"></a>8.5.9. Extension dependencies</h4>
<div class="paragraph">
<p>If your extension depends on dependencies which are not brought by Ontrack,
you have to collect them explicitly and put them in the same directory
which contain your main JAR file.</p>
</div>
<div class="paragraph">
<p>The Ontrack plug-in provides an <code>ontrackPrepare</code> task which copies
all dependencies (transitively) and the main JAR in the <code>build/dist</code> directory.</p>
</div>
<div class="paragraph">
<p>This task is called by the main <code>build</code> task.</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-deploying"><a class="anchor" href="#extending-deploying"></a>8.5.10. Deploying an extension</h4>
<div class="sect4">
<h5 id="extending-deploying-docker"><a class="anchor" href="#extending-deploying-docker"></a>Using the Docker image</h5>
<div class="paragraph">
<p>The <a href="#installation-docker">Ontrack Docker image</a> uses the
<code>/var/ontrack/extensions</code> volume to load extensions from. Bind this volume to
your host or to a data container to start putting extensions in it.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run --volume /extension/on/host:/var/ontrack/extensions ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create your own image. Create the following <code>Dockerfile</code>:</p>
</div>
<div class="listingblock">
<div class="title">Dockerfile</div>
<div class="content">
<pre class="prettyprint highlight"><code># Base Ontrack image
FROM nemerosa/ontrack:&lt;yourversion&gt;
# Overrides the extension directory, as to NOT use a volume
ENV EXTENSIONS_DIR /var/ontrack/your-extension
# Copies the extensions in the target volume
COPY extensions/*.jar /var/ontrack/your-extension/</code></pre>
</div>
</div>
<div class="paragraph">
<p>We assume here that your extensions are packaged in an <code>extensions</code> folder
at the same level than your <code>Dockerfile</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>/-- Dockerfile
|-- extensions/
     |-- extension1.jar
     |-- extension2.jar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using a <em>child</em> <code>Dockerfile</code>, the extension directory has to be
customized because we cannot use the <code>VOLUME</code> in this case.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="extending-deploying-os"><a class="anchor" href="#extending-deploying-os"></a>Using the CentOS or Debian/Ubuntu package</h5>
<div class="paragraph">
<p>The <a href="#installation-rpm">RPM</a> and <a href="#installation-debian">Debian</a> packages both
use the <code>/usr/lib/ontrack/extensions</code> directory for the location of the
extensions JAR files.</p>
</div>
<div class="paragraph">
<p>You can also create a RPM or Debian package which embeds both Ontrack and your
extensions.</p>
</div>
<div class="paragraph">
<p>The means to achieve this depend on your build technology but the idea is the
same in all cases:</p>
</div>
<div class="paragraph">
<p>Your package must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>put the extension JAR files in <code>/usr/lib/ontrack/extensions</code></p>
</li>
<li>
<p>have a dependency on the <code>ontrack</code> package</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="extending-deploying-sa"><a class="anchor" href="#extending-deploying-sa"></a>In standalone mode</h5>
<div class="paragraph">
<p>When running <a href="#installation-sa">Ontrack directly</a>, you have to set the
<code>loader.path</code> to a directory containing the extensions JAR files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">java -Dloader.path=/path/to/extensions -jar ... &lt;options&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-properties"><a class="anchor" href="#extending-properties"></a>8.5.11. Extending properties</h4>
<div class="paragraph">
<p>Any <a href="#model">entity</a> in Ontrack can be associated with a set of
properties. Extensions can contribute to create new ones.</p>
</div>
<div class="paragraph">
<p>A <em>property</em> is the association some Java components and a HTML template to
render it on the screen.</p>
</div>
<div class="sect4">
<h5 id="extending-properties-java"><a class="anchor" href="#extending-properties-java"></a>Java components</h5>
<div class="paragraph">
<p>First, a property must be associated with some data. Just create an invariant
POJO like, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package net.nemerosa.ontrack.extension.myextension;

import lombok.Data;

@Data
public class MyProperty {
    private final String value;
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Note that Ontrack extensions can take benefit of using
<a href="https://projectlombok.org/">Lombok</a> in order to reduce the typing. But this is
not mandatory as all.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then, you create the <em>property type</em> itself, by implementing the <code>PropertyType</code>
interface or more easily by extending the <code>AbstractPropertyType</code> class. The
parameter for this class is the data created above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class MyPropertyType extends AbstractPropertyType&lt;MyProperty&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Component</code> notation registers the property type in Ontrack.</p>
</div>
<div class="paragraph">
<p>A property, or any <a href="#extending">extension</a> is always associated with an
extension feature and this one is typically injected:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Autowired
public MyPropertyType(MyExtensionFeature extensionFeature) {
  super(extensionFeature);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, several methods need to be implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getName</code> and <code>getDescription</code> return respectively a display name and a short
description for the property</p>
</li>
<li>
<p><code>getSupportedEntityTypes</code> returns the set of <a href="#model">entities</a> the
property can be applied to. For example, if your property can be applied only
on projects, you can return:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public Set&lt;ProjectEntityType&gt; getSupportedEntityTypes() {
  return EnumSet.of(ProjectEntityType.PROJECT);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>canEdit</code> allows you to control who can create or edit the property for an
entity. The <code>SecurityService</code> allows you to test the authorizations for the
current user. For example, in this sample, we authorize the edition of our
property only for users being granted to the project configuration:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public boolean canEdit(ProjectEntity entity, SecurityService securityService) {
  return securityService.isProjectFunctionGranted(entity, ProjectConfig.class);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>canView</code> allows you to control who can view the property for an entity. Like
for <code>canEdit</code>, the <code>SecurityService</code> is passed along, but you will typically
return <code>true</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public boolean canView(ProjectEntity entity, SecurityService securityService) {
  return true;
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getEditionForm</code> returns the form being used to create or edit the property.
Ontrack uses <code>Form</code> objects to generate automatically user forms on the client.
See its Javadoc for more details. In our example, we only need a text box:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public Form getEditionForm(ProjectEntity entity, MyProperty value) {
  return Form.create()
          .with(
                  Text.of("value")
                          .label("My value")
                          .length(20)
                          .value(value != null ? value.getValue() : null)
          );
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>fromClient</code> and <code>fromStorage</code> methods are used to parse back and forth
the JSON into a property value. Typically:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public MyProperty fromClient(JsonNode node) {
  return fromStorage(node);
}

@Override
public MyProperty fromStorage(JsonNode node) {
  return parse(node, ProjectCategoryProperty.class);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>getSearchKey</code> is used to provide an indexed search value for the
property:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public String getSearchKey(My value) {
  return value.getValue();
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>finally, the <code>replaceValue</code> method is called when the property has to be
cloned for another entity, using a replacement function for the text values:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public MyProperty replaceValue(MyProperty value, Function&lt;String, String&gt; replacementFunction) {
  return new MyProperty(
      replacementFunction.apply(value.getValue())
  );
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-properties-web"><a class="anchor" href="#extending-properties-web"></a>Web components</h5>
<div class="paragraph">
<p>A HTML fragment (or template) must be created at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src/main/resources
  \-- static
     \-- extension
         \-- myextension
            \-- property
               \-- net.nemerosa.ontrack.extension.myextension.MyPropertyType.tpl.html</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Replace <code>myextension</code>, the package name and the property type accordingly
of course.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>tpl.html</code> will be used as a template on the client side and will have
access to the <code>Property</code> object. Typically, only its <code>value</code> field, of the
property data type, will be used.</p>
</div>
<div class="paragraph">
<p>The template is used the
<a href="https://docs.angularjs.org/guide/templates">AngularJS template</a> mechanism.</p>
</div>
<div class="paragraph">
<p>For example, to display the property as bold text in our sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;b&gt;{{property.value.value}}&lt;/b&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The property must be associated with an icon, typically PNG, 24 x 24, located at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src/main/resources
  \-- static
     \-- extension
         \-- myextension
            \-- property
               \-- net.nemerosa.ontrack.extension.myextension.MyPropertyType.png</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-decorators"><a class="anchor" href="#extending-decorators"></a>8.5.12. Extending decorators</h4>
<div class="paragraph">
<p>A decorator is responsible to display a decoration (icon, text, label, etc.)
close to an <a href="#model">entity</a> name, in the entity page itself or in a list
of those entities. Extensions can contribute to create new ones.</p>
</div>
<div class="paragraph">
<p>A <em>decorator</em> is the association some Java components and a HTML template to
render it on the screen.</p>
</div>
<div class="sect4">
<h5 id="extending-decorators-java"><a class="anchor" href="#extending-decorators-java"></a>Java components</h5>
<div class="paragraph">
<p>First, a decorator must be associated with some data. You can use any type,
like a <code>String</code>, an <code>enum</code> or any other  invariant POJO. In our sample,
 we&#8217;ll take a <code>String</code>, which is the value of the <code>MyProperty</code> property
 described as example in <a href="#extending-properties">Extending properties</a>.</p>
</div>
<div class="paragraph">
<p>Then, you create the <em>decorator</em> itself, by implementing the
<code>DecorationExtension</code> interface and extending the <code>AbstractExtension</code>. The
parameter type is the decorator data defined above.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class MyDecorator extends AbstractExtension implements DecorationExtension&lt;String&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Component</code> notation registers the decorator in Ontrack.</p>
</div>
<div class="paragraph">
<p>A decorator, or any <a href="#extending">extension</a> is always associated with an
extension feature and this one is typically injected. Other services can be
injected at the same time. For example, our sample decorator needs to get a
property on an entity so we inject the <code>PropertyService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private final PropertyService propertyService;
@Autowired
public MyDecorator(MyExtensionFeature extensionFeature, PropertyService propertyService) {
   super(extensionFeature);
   this.propertyService = propertyService;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, several methods need to be implemented:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getScope</code> returns the set of <a href="#model">entities</a> the decorator can be
applied to. For example, if your property can be applied only on projects, you
can return:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public EnumSet&lt;ProjectEntityType&gt; getScope() {
   return EnumSet.of(ProjectEntityType.PROJECT);
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getDecorations</code> returns the list of decorations for an entity. In our case,
we want to return a decoration only if the project is associated with the
<code>MyProperty</code> property and return its value as decoration data.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public List&lt;Decoration&lt;String&gt;&gt; getDecorations(ProjectEntity entity) {
  return propertyService.getProperty(entity, MyPropertyType.class).option()
          .map(p -&gt; Collections.singletonList(
                  Decoration.of(
                          MyDecorator.this,
                          p.getValue()
                  )
          ))
          .orElse(Collections.emptyList());
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-decorators-web"><a class="anchor" href="#extending-decorators-web"></a>Web components</h5>
<div class="paragraph">
<p>A HTML fragment (or template) must be created at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src/main/resources
  \-- static
     \-- extension
         \-- myextension
            \-- decoration
               \-- net.nemerosa.ontrack.extension.myextension.MyDecorator.tpl.html</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Replace <code>myextension</code>, the package name and the decorator type
accordingly of course.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>tpl.html</code> will be used as a template on the client side and will have
access to the <code>Decoration</code> object. Typically, only its <code>data</code> field, of the
decoration data type, will be used.</p>
</div>
<div class="paragraph">
<p>The template is used the
<a href="https://docs.angularjs.org/guide/templates">AngularJS template</a> mechanism.</p>
</div>
<div class="paragraph">
<p>For example, to display the decoration data as bold text in our sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;!-- In this sample, `data` is a string --&gt;
&lt;b&gt;{{decoration.data}}&lt;/b&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-usermenu"><a class="anchor" href="#extending-usermenu"></a>8.5.13. Extending the user menu</h4>
<div class="paragraph">
<p>An <a href="#extending">extension</a> can add a entry in the connected user menu,
in order to point to an extension page.</p>
</div>
<div class="sect4">
<h5 id="extending-usermenu-component"><a class="anchor" href="#extending-usermenu-component"></a>Extension component</h5>
<div class="paragraph">
<p>Define a component which extends <code>AbstractExtension</code> and implements
<code>UserMenuExtension</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package net.nemerosa.ontrack.extension.myextension;

@Component
public class MyUserMenuExtension extends AbstractExtension implements UserMenuExtension {

    @Autowired
    public MyUserMenuExtension(MyExtensionFeature extensionFeature) {
        super(extensionFeature);
    }

    @Override
    public Action getAction() {
        return Action.of("my-user-menu", "My User Menu", "my-user-menu-page");
    }

    @Override
    public Class&lt;? extends GlobalFunction&gt; getGlobalFunction() {
        return ProjectList.class;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this sample, <code>my-user-menu-page</code> is the relative routing path to the
<a href="#extending-pages">page</a> the user action must point to.</p>
</div>
<div class="paragraph">
<p>The <code>getGlobalFunction</code> method returns the function needed for authorizing
the user menu to appear.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-pages"><a class="anchor" href="#extending-pages"></a>8.5.14. Extending pages</h4>
<div class="paragraph">
<p>Extensions can also contribute to pages.</p>
</div>
<div class="sect4">
<h5 id="extending-pages-menus"><a class="anchor" href="#extending-pages-menus"></a>Extension menus</h5>
<div class="paragraph">
<p>Extension pages must be accessible from a location:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <a href="#extending-usermenu">global user menu</a></p>
</li>
<li>
<p>an <a href="#model">entity</a> page</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="extending-pages-menus-global"><a class="anchor" href="#extending-pages-menus-global"></a>From the global user menu</h6>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect5">
<h6 id="extending-pages-menus-entity"><a class="anchor" href="#extending-pages-menus-entity"></a>From an entity page</h6>
<div class="paragraph">
<p>In order for an extension to contribute to the menu of an entity page, you have
to implement the <code>ProjectEntityActionExtension</code> interface and extend the
<code>AbstractExtension</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class MyProjectActionExtension extends AbstractExtension implements ProjectEntityActionExtension {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Component</code> notation registers the extension in Ontrack.</p>
</div>
<div class="paragraph">
<p>An action extension, or any <a href="#extending">extension</a> is always associated with
an extension feature and this one is typically injected. Other services can be
injected at the same time. For example, our sample extension needs to get a
property on an entity so we inject the <code>PropertyService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private final PropertyService propertyService;
@Autowired
public MyProjectActionExtension(MyExtensionFeature extensionFeature, PropertyService propertyService) {
   super(extensionFeature);
   this.propertyService ==== propertyService;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>getAction</code> method returns an optional <code>Action</code> for the entity. In our
sample, we want to associate an action with entity if it is a project and if it
has the <code>MyProperty</code> property being set:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public Optional&lt;Action&gt; getAction(ProjectEntity entity) {
   if (entity instanceof Project) {
       return propertyService.getProperty(entity, MyPropertyType.class).option()
               .map(p -&gt;
                       Action.of(
                               "my-action",
                               "My action",
                               String.format("my-action/%d", entity.id())
                       )
               );
   } else {
       return Optional.empty();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned <code>Action</code> object has the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an <code>id</code>, uniquely identifying the target page in the extension</p>
</li>
<li>
<p>a <code>name</code>, which will be used as display name for the menu entry</p>
</li>
<li>
<p>a URI fragment, which will be used for getting to the extension end point
(see later). Note that this URI fragment will be prepended by the extension
path. So in our example, the final path for the <code>SAMPLE</code> project with id <code>12</code>
would be: <code>extension/myextension/my-action/12</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-pages-global"><a class="anchor" href="#extending-pages-global"></a>Extension global settings</h5>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="extending-pages-specific"><a class="anchor" href="#extending-pages-specific"></a>Extension page</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Before an extension can serve some web components, it must be declared as
being GUI related. See the <a href="#extensions">documentation</a> to enable this
(<code>ExtensionFeatureOptions.DEFAULT.withGui(true)</code>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The extension must define an AngularJS module file at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src/main/resources
  \-- static
     \-- extension
         \-- myextension
            \-- module.js</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>module.js</code> file name is fixed and is used by Ontrack to load the web
components of your extension at startup.</p>
</div>
<div class="paragraph">
<p>This is an AngularJS (1.2.x) module file and can declare its configuration, its
services, its controllers, etc. Ontrack uses
<a href="http://angular-ui.github.io/ui-router/site"><code>UI Router</code></a>(), version <code>0.2.11</code> for
the routing of the pages, allowing a routing declaration as module level.</p>
</div>
<div class="paragraph">
<p>For our example, we want to declare a page for displaying information for
<code>extension/myextension/my-action/{project}</code> where <code>{project}</code> is the ID of
one project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-javascript" data-lang="javascript">angular.module('ontrack.extension.myextension', [
        'ot.service.core',
        'ot.service.structure'
    ])
    // Routing
    .config(function ($stateProvider) {
        $stateProvider.state('my-action', {
            url: '/extension/myextension/my-action/{project}',
            templateUrl: 'extension/myextension/my-action.tpl.html',
            controller: 'MyExtensionMyActionCtrl'
        });
    })
    // Controller
    .controller('MyExtensionMyActionCtrl', function ($scope, $stateParams, ot, otStructureService) {
        var projectId ==== $stateParams.project;

        // View definition
        var view ==== ot.view();
        view.commands ==== [
            // Closing to the project
            ot.viewCloseCommand('/project/' + projectId)
        ];

        // Loads the project
        otStructureService.getProject(projectId).then(function (project) {
            // Breadcrumbs
            view.breadcrumbs ==== ot.projectBreadcrumbs(project);
            // Title
            view.title ==== "Project action for " + project.name;
            // Scope
            $scope.project ==== project;
        });
    })
;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The routing configuration declares that the end point at
<code>/extension/myextension/my-action/{project}</code> will use the
<code>extension/myextension/my-action.tpl.html</code> view and the
<code>MyExtensionMyActionCtrl</code> controller defined below.</p>
</div>
<div class="paragraph">
<p>The <code>ot</code> and <code>otStructureService</code> are Ontrack Angular services, defined
respectively by the <code>ot.service.core</code> and <code>ot.service.structure</code> modules.</p>
</div>
<div class="paragraph">
<p>The <code>MyExtensionMyActionCtrl</code> controller:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>gets the project ID from the state (URI) definition</p>
</li>
<li>
<p>it defines an Ontrack view, and defines a close command to go back to the
project page</p>
</li>
<li>
<p>it then loads the project using the <code>otStructureService</code> service  and upon
loading completes some information into the view</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally, we define a template at:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>src/main/resources
  \-- static
     \-- extension
         \-- myextension
            \-- extension/myextension/my-action.tpl.html</pre>
</div>
</div>
<div class="paragraph">
<p>which contains:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;ot-view&gt;
    Action page for {{project.name}}.
&lt;/ot-view&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ot-view</code> is an Ontrack directive which does all the layout magic for you.
You just have to provide the content.</p>
</div>
<div class="paragraph">
<p>Ontrack is using <a href="http://getbootstrap.com/">Bootstrap 3.x</a> for the layout and
basic styling, so you can start structuring your HTML with columns, rows,
tables, etc. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-html" data-lang="html">&lt;ot-view&gt;
   &lt;div class="row"&gt;
      &lt;div class="col-md-12"&gt;
         Action page for {{project.name}}.
      &lt;/div&gt;
   &lt;/div&gt;
&lt;/ot-view&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-pages-api"><a class="anchor" href="#extending-pages-api"></a>Extension API</h5>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
<div class="sect4">
<h5 id="extending-pages-resources"><a class="anchor" href="#extending-pages-resources"></a>Extension API resource decorators</h5>
<div class="paragraph">
<p><strong>TODO</strong></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-event-types"><a class="anchor" href="#extending-event-types"></a>8.5.15. Extending event types</h4>
<div class="paragraph">
<p>Extensions can define additional event types which can then be used to add custom events to entities.</p>
</div>
<div class="paragraph">
<p>To register a custom event type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Autowired
public static final EventType CUSTOM_TYPE = SimpleEventType.of("custom-type", "My custom event");
public MyExtension(..., EventFactory eventFactory) {
   super(extensionFeature);
   eventFactory.register(CUSTOM_TYPE);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, you can use it this way when you want to attach an event to, let&#8217;s say, a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">EventPostService eventPostService;
Build build;
...
eventPostService.post(
    Event.of(MyExtension.CUSTOM_TYPE).withBuild(build).get()
);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-graphql"><a class="anchor" href="#extending-graphql"></a>8.5.16. Extending GraphQL</h4>
<div class="paragraph">
<p>Extensions can contribute to the Ontrack <a href="#integration-graphql">GraphQL</a> core
schema:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>custom types</p>
</li>
<li>
<p>root queries</p>
</li>
<li>
<p>additional fields in <a href="#model">project entities</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="extending-graphql-module"><a class="anchor" href="#extending-graphql-module"></a>Preparing the extension</h5>
<div class="paragraph">
<p>In your extension module, import the <code>ontrack-ui-graphql</code> module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
   compile "net.nemerosa.ontrack:ontrack-ui-graphql:${ontrackVersion}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to write <a href="#extending-graphql-testing">integration tests</a> for your
GraphQL extension, you have to include the GraphQL testing utilities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">dependencies {
   testCompile "net.nemerosa.ontrack:ontrack-ui-graphql:${ontrackVersion}:tests"
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-graphql-types"><a class="anchor" href="#extending-graphql-types"></a>Custom types</h5>
<div class="paragraph">
<p>To define an extra type, you create a component which implements the
<code>GQLType</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class PersonType implements GQLType {
    @Override
    public GraphQLObjectType getType() {
        return GraphQLObjectType.newObject()
                .name("Person")
                .field(f -&gt; f.name("name")
                        .description("Name of the person")
                        .type(GraphQLString)
                )
                .build();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="https://github.com/graphql-java/graphql-java">graphql-java</a>
documentation for the description of the type construction.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use this component in other ones, like in queries, field definitions
or other types, like shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class AccountType implements GQLType {

    private final PersonType personType;

    @Autowired
    public AccountType (PersonType personType) {
        this.personType = personType;
    }

    @Override
    public GraphQLObjectType getType() {
        return GraphQLObjectType.newObject()
                .name("Account")
                .field(f -&gt; f.name("username")
                        .description("Account name")
                        .type(GraphQLString)
                )
                .field(f -&gt; f.name("identity")
                        .description("Identity")
                        .type(personType.getType())
                )
                .build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also create GraphQL types dynamically by using introspection of your
model classes.</p>
</div>
<div class="paragraph">
<p>Given the following model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Data
public class Person {
   private final String name;
}
@Data
public class Account {
   private final String username;
   private final Person identity;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can generate the <code>Account</code> type by using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Override
public GraphQLObjectType getType() {
   return GraphQLBeanConverter.asObjectType(Account.class);
}</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The <code>GraphQLBeanConverter.asObjectType</code> is still very
<strong>experimental</strong> and its implementation is likely to change in the next versions
of Ontrack. For example, <code>Map</code> and <code>Collection</code> types are not supported.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="extending-graphql-queries"><a class="anchor" href="#extending-graphql-queries"></a>Root queries</h5>
<div class="paragraph">
<p>Your extension can contribute to the root query by creating a component
implementing the <code>GQLRootQuery</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class AccountGraphQLRootQuery implements GQLRootQuery {

    private final AccountType accountType;

    @Autowired
    public AccountGraphQLRootQuery(AccountType accountType) {
        this.accountType = accountType;
    }

    @Override
    public GraphQLFieldDefinition getFieldDefinition() {
        return GraphQLFieldDefinition.newFieldDefinition()
                .name("accounts")
                .argument(a -&gt; a.name("username")
                        .description("User name pattern")
                        .type(GraphQLString)
                )
                .type(accountType.getType())
                .dataFetcher(...)
                .build();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This root query can then be used into your GraphQL queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>{
   accounts(username: "admin*") {
      username
      identity {
         name
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-graphql-fields"><a class="anchor" href="#extending-graphql-fields"></a>Extra fields</h5>
<div class="paragraph">
<p>The Ontrack GraphQL extension mechanism allows contributions to the
<a href="#model">project entities</a> like the projects, builds, etc.</p>
</div>
<div class="paragraph">
<p>For example, to contribute a <code>owner</code> field of type <code>Account</code> on the <code>Branch</code>
project entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class BranchOwnerGraphQLFieldContributor
   implements GQLProjectEntityFieldContributor {

   private final AccountType accountType;

   @Autowired
   public BranchOwnerGraphQLFieldContributor(AccountType accountType) {
      this.accountType = accountType;
   }

   @Override
   public List&lt;GraphQLFieldDefinition&gt; getFields(
         Class&lt;? extends ProjectEntity&gt; projectEntityClass,
         ProjectEntityType projectEntityType) {
     return Collections.singletonList(
             GraphQLFieldDefinition.newFieldDefinition()
                     .name("owner")
                     .type(accountType.getType())
                     .dataFetcher(GraphqlUtils.fetcher(
                        Branch.class,
                        (environment, branch) -&gt; return ...
                     ))
                     .build()
     );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now use the <code>owner</code> field in your queries:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>{
   branches(id: 1) {
      name
      project {
         name
      }
      owner {
         username
         identity {
            name
         }
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-graphql-scalars"><a class="anchor" href="#extending-graphql-scalars"></a>Built-in scalar fields</h5>
<div class="paragraph">
<p>The Ontrack GraphQL module adds the following scalar types, which you can
use in your field or type definitions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GQLScalarJSON.INSTANCE</code> - maps to a <code>JsonNode</code></p>
</li>
<li>
<p><code>GQLScalarLocalDateTime.INSTANCE</code> - maps to a <code>LocalDateTime</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can use them directly in your definitions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">...
.field(f -&gt; f.name("content").type(GQLScalarJSON.INSTANCE))
.field(f -&gt; f.name("timestamp").type(GQLScalarLocalDateTime.INSTANCE))
...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="extending-graphql-testing"><a class="anchor" href="#extending-graphql-testing"></a>Testing GraphQL</h5>
<div class="paragraph">
<p>In your tests, create a test class which extends <code>AbstractQLITSupport</code> and
use the <code>run</code> method to execute a GraphQL query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">MyTestIT extends AbstractQLITSupport {
   @Test
   void my_test() {
     def p = doCreateProject()
     def data = run("""{
      projects(id: ${p.id}) {
         name
      }
     }""")
     assert data.projects.first().name == p.name
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
While it is possible to run GraphQL tests in Java, it&#8217;s easier to do
using Groovy.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-metrics"><a class="anchor" href="#extending-metrics"></a>8.5.17. Extending metrics</h4>
<div class="paragraph">
<p>Ontrack exports <a href="#monitoring">metrics</a> in order to allow third party
applications to monitor its state: <a href="#monitoring-metrics-influxdb">InfluxDB</a>,
<a href="#monitoring-metrics-graphite">Graphite</a>,
<a href="#monitoring-metrics-grafana">Grafana</a>, etc.</p>
</div>
<div class="paragraph">
<p>You can contribute to the core metrics in your own <a href="#extending">extensions</a>.</p>
</div>
<div class="paragraph">
<p>Just create a class which implements the <code>OntrackMetrics</code> interface and export
it as a <code>@Component</code>.</p>
</div>
<div class="paragraph">
<p>Implement the <code>Collection&lt;Metric&lt;?&gt;&gt; metrics()</code> method. This method will be
regularly called by Ontrack in order to collect the metrics.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class SampleMetrics implements OntrackMetrics {
    @Override
    public Collection&lt;Metric&lt;?&gt;&gt; metrics() {
      List&lt;Metric&lt;?&gt;&gt; metrics = new ArrayList&lt;&gt;();
      metrics.add(new Metric&lt;&gt;("gauge.mycount", myCount()));
      return metrics;
    }
    protected int myCount() {
      ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code would export a <code>gauge.mycount</code> metric. Any number of metrics can
be thus exposed.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the metrics are collected without any authentication being enabled.
If the collection needs to be authenticated, inject the
<a href="#reference-services"><code>SecurityService</code></a>
service in your class and use the <code>asAdmin</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Component
public class SampleMetrics implements OntrackMetrics {
    private final SecurityService securityService;
    @Autowired
    public SampleMetrics(SecurityService securityService) {
      this.securityService = securityService;
    }
    @Override
    public Collection&lt;Metric&lt;?&gt;&gt; metrics() {
      List&lt;Metric&lt;?&gt;&gt; metrics = new ArrayList&lt;&gt;();
      securityService.asAdmin(() -&gt; {
         metrics.add(new Metric&lt;&gt;("gauge.mycount", myCount()));
      });
      return metrics;
    }
    protected int myCount() {
      ...
    }
}</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="extending-kotlin"><a class="anchor" href="#extending-kotlin"></a>8.5.18. Using Kotlin in extensions</h4>
<div class="paragraph">
<p>An <a href="#extending">extension</a> can use <a href="http://kotlinlang.org/">Kotlin</a>
additionally to Java.</p>
</div>
<div class="paragraph">
<p>Just mention <code>kotlin()</code> in the Ontrack configuration in your
<code>build.gradle</code> file:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack {
    kotlin()
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Kotlin Gradle plug-in will be automatically applied and the Kotlin
JVM for JRE8, with the same version than for Ontrack, will be added
in <code>compileOnly</code> mode to your dependencies. Enjoy!</p>
</div>
</div>
<div class="sect3">
<h4 id="extending-settings"><a class="anchor" href="#extending-settings"></a>8.5.19. Extending the settings</h4>
<div class="paragraph">
<p>An <a href="#extending">extension</a> can add a entry in the list of global settings.</p>
</div>
<div class="paragraph">
<p>Start by creating an invariant class which contains the data to manage in
the new settings.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
in the sample below, we use some PuppetDB connection settings, which
     need a URL, a user name and a password.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Data
public class PuppetDBSettings {
    private final String url;
    private final String username;
    private final String password;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The settings are managed in Ontrack by two distinct services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a manager - responsible for the edition of the settings</p>
</li>
<li>
<p>a provider - responsible for retrieving the settings</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
as-of today, the service cannot be the same class.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To define the manager, extend the <code>AbstractSettingsManager</code> class and use your settings class as a parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class PuppetDBSettingsManager extends AbstractSettingsManager&lt;PuppetDBSettings&gt; {

    private final SettingsRepository settingsRepository;
    private final EncryptionService encryptionService;

    @Autowired
    public PuppetDBSettingsManager(CachedSettingsService cachedSettingsService, SecurityService securityService, SettingsRepository settingsRepository, EncryptionService encryptionService) {
        super(PuppetDBSettings.class, cachedSettingsService, securityService);
        this.settingsRepository = settingsRepository;
        this.encryptionService = encryptionService;
    }

    @Override
    protected void doSaveSettings(PuppetDBSettings settings) {
        settingsRepository.setString(PuppetDBSettings.class, "url", settings.getUrl());
        settingsRepository.setString(PuppetDBSettings.class, "username", settings.getUsername());
        settingsRepository.setPassword(PuppetDBSettings.class, "password", settings.getPassword(), false, encryptionService::encrypt);
    }

    @Override
    protected Form getSettingsForm(PuppetDBSettings settings) {
        return Form.create()
                .with(
                        Text.of("url")
                                .label("URL")
                                .help("URL to the PuppetDB server. For example: http://puppetdb")
                                .value(settings.getUrl())
                )
                .with(
                        Text.of("username")
                                .label("User")
                                .help("Name of the user used to connect to the PuppetDB server.")
                                .optional()
                                .value(settings.getUsername())
                )
                .with(
                        Password.of("password")
                                .label("Password")
                                .help("Password of the user used to connect to the PuppetDB server.")
                                .optional()
                                .value("") // Password never sent to the client
                );
    }

    @Override
    public String getId() {
        return "puppetdb";
    }

    @Override
    public String getTitle() {
        return "PuppetDB settings";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To define the provided, implement the <code>AbstractSettingsManager</code> and use your settings class as a parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public class PuppetDBSettingsProvider implements SettingsProvider&lt;PuppetDBSettings&gt; {

    private final SettingsRepository settingsRepository;
    private final EncryptionService encryptionService;

    @Autowired
    public PuppetDBSettingsProvider(SettingsRepository settingsRepository, EncryptionService encryptionService) {
        this.settingsRepository = settingsRepository;
        this.encryptionService = encryptionService;
    }

    @Override
    public PuppetDBSettings getSettings() {
        return new PuppetDBSettings(
                settingsRepository.getString(PuppetDBSettings.class, "url", ""),
                settingsRepository.getString(PuppetDBSettings.class, "username", ""),
                settingsRepository.getPassword(PuppetDBSettings.class, "password", "", encryptionService::decrypt)
        );
    }

    @Override
    public Class&lt;PuppetDBSettings&gt; getSettingsClass() {
        return PuppetDBSettings.class;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s all there is to do. Now, the new settings will automatically appear in the <em>Settings</em> page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/extending-settings-section.png" alt="Settings section" width="400">
</div>
</div>
<div class="paragraph">
<p>and can be edited using the form defined above:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/extending-settings-dialog.png" alt="Settings dialog" width="400">
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-security"><a class="anchor" href="#extending-security"></a>8.5.20. Extending the security</h4>
<div class="paragraph">
<p>The <a href="#security">security model</a> of Ontrack can be extended to fit
for specific needs in extensions.</p>
</div>
<div class="sect4">
<h5 id="extending-security-functions"><a class="anchor" href="#extending-security-functions"></a>Adding functions</h5>
<div class="paragraph">
<p>All authorizations in the code are granted through <em>functions</em>. We
distinguish between:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>global</em> functions about Ontrack in general</p>
</li>
<li>
<p><em>project</em> functions linked to a given project</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#security">Global roles</a> are then
linked to a number of global functions and project functions.</p>
</div>
<div class="paragraph">
<p>On the other hand, <a href="#security">project roles</a> can only be linked to
project functions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="security-model.png" alt="security model" width="306" height="192">
</div>
</div>
<div class="paragraph">
<p>The association of <em>core</em> functions and <em>core</em> roles is fixed in the
Ontrack core, but extensions can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define new global and project functions</p>
</li>
<li>
<p>assign them to existing roles</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
For security reasons, extensions cannot associate <em>existing
core</em> functions to roles.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to define a <em>global function</em>, just define an interface
which extends <code>GlobalFunction</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public interface MyGlobalFunction extends GlobalFunction {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Almost the same thing for a <em>project function</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public interface MyProjectFunction extends ProjectFunction {}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
No method is to be implemented.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Now, you can link those functions to existing roles by providing
a <code>RoleContributor</code> component. In our example, we want to grant
the global function and the project function to the <code>AUTOMATION</code>
global role and the project
function to the <code>PROJECT_OWNER</code> project role.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public MyRoleContributor implements RoleContributor {
    @Override
    public Map&lt;String, List&lt;Class&lt;? extends GlobalFunction&gt;&gt;&gt; getGlobalFunctionContributionsForGlobalRoles() {
        return Collections.singletonMap(
            Roles.GLOBAL_AUTOMATION,
            Collections.singletonList(
                MyGlobalFunction.class
            )
        );
    }
    @Override
    public Map&lt;String, List&lt;Class&lt;? extends ProjectFunction&gt;&gt;&gt; getProjectFunctionContributionsForGlobalRoles() {
        return Collections.singletonMap(
            Roles.GLOBAL_AUTOMATION,
            Collections.singletonList(
                MyProjectFunction.class
            )
        );
    }
    @Override
    public Map&lt;String, List&lt;Class&lt;? extends ProjectFunction&gt;&gt;&gt; getProjectFunctionContributionsForProjectRoles() {
        return Collections.singletonMap(
            Roles.PROJECT_OWNER,
            Collections.singletonList(
                MyProjectFunction.class
            )
        );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
All available roles are listed in the <code>Roles</code> interface.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can now check for those functions in your code by injecting
the <code>SecurityService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private final SecurityService securityService;
...
if (securityService.isGlobalFunctionGranted(MyGlobalFunction.class)) {
   ...
}
if (securityService.isProjectFunctionGranted(project, MyProjectFunction.class)) {
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">private final SecurityService securityService;
...
securityService.checkGlobalFunction(MyGlobalFunction.class)) {
securityService.checkProjectFunction(project, MyProjectFunction.class))</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The project functions can be tested on a <code>Project</code> or any other
<a href="#model">entity</a> which belongs to a project (branches, builds, etc.).
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="extending-security-roles"><a class="anchor" href="#extending-security-roles"></a>Adding roles</h5>
<div class="paragraph">
<p>Both <em>global</em> and <em>project</em> <a href="#security">roles</a> can be added
using the same <code>RoleContributor</code> extension class, by
overriding the following methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
public MyRoleContributor implements RoleContributor {
    @Override
    public List&lt;RoleDefinition&gt; getGlobalRoles() {
        return Collections.singletonList(
            new RoleDefinition(
                "MY_GLOBAL_ROLE",
                "My Global Role",
                "This is a new global role"
            )
        );
    }
    @Override
    public List&lt;RoleDefinition&gt; getProjectRoles() {
        return Collections.singletonList(
            new RoleDefinition(
                "MY_PROJECT_ROLE",
                "My Project Role",
                "This is a new project role"
            )
        );
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A new role can inherit from a built-in role:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">    @Override
    public List&lt;RoleDefinition&gt; getProjectRoles() {
        return Collections.singletonList(
            new RoleDefinition(
                "MY_PROJECT_ROLE",
                "My Project Role",
                "This is a new project role",
                Roles.PROJECT_PARTICIPANT
            )
        );
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the previous example, the <code>MY_PROJECT_ROLE</code> will inherit from
all functions of the built-in <code>PARTICIPANT</code> role.</p>
</div>
<div class="paragraph">
<p>Same principle applies for global roles.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Those roles becomes eligible for selection when managing
accounts and groups.</p>
</div>
<div class="paragraph">
<p>Note that functions (built-in or contributed) can be
associated to those new roles - see <a href="#extending-security-functions">Adding functions</a>.
By default, no function is associated to a contributed role.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="extending-encryption"><a class="anchor" href="#extending-encryption"></a>8.5.21. Extending confidential stores</h4>
<div class="paragraph">
<p>Extensions can define a custom <a href="#integration-encryption">confidential store</a>
used to store encryption keys.</p>
</div>
<div class="paragraph">
<p>Create a component which extends the <code>AbstractConfidentialStore</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@Component
@ConditionalOnProperty(name = OntrackConfigProperties.KEY_STORE, havingValue = "custom")
public class CustomConfidentialStore extends AbstractConfidentialStore {

    public CustomConfidentialStore() {
        LoggerFactory.getLogger(CustomConfidentialStore.class).info(
                "[key-store] Using custom store"
        );
    }

    @Override
    public void store(String key, byte[] payload) throws IOException {
      // ...
      // Stores the key
    }

    @Override
    public byte[] load(String key) throws IOException {
      // ...
      // Retrives the key or ...
      return null;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note the use of the <code>ConditionalOnProperty</code>, which allows to select
this store when the <code>ontrack.config.key-store</code>
<a href="#configuration-properties">property</a> is set to <code>custom</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appendixes"><a class="anchor" href="#appendixes"></a>9. Appendixes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="configuration-properties"><a class="anchor" href="#configuration-properties"></a>9.1. Configuration properties</h3>
<div class="paragraph">
<p>Ontrack uses the Spring Boot mechanism for its configuration. See
the <a href="#configuration">documentation</a> on how to set those properties
in your Ontrack installation.</p>
</div>
<div class="paragraph">
<p>All <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#common-application-properties">Spring Boot properties</a>
are available for configuration.</p>
</div>
<div class="paragraph">
<p>Additionally, Ontrack defines the following ones.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The names of the configuration properties are given for a <code>.properties</code>
     file format but you can configure them in YAML of course. They can also
     be provided as system properties or environment variables. See the
     <a href="http://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-properties-and-configuration">Spring Boot documentation</a>
     for more details.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This sample file is meant as a guide only. Do <strong>not</strong> copy/paste the
         entire content into your application; rather pick only the properties
         that you need.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When applicable, the default value is mentioned.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-properties" data-lang="properties"># ======================================================
# Ontrack properties
# ======================================================

# Maximum number of days to keep the log entries
ontrack.config.application-log-retention-days = 7

# Maximum number of errors to display as notification in the GUI
ontrack.config.application-log-info-max = 10

# Directory which contains all the working files of Ontrack
# It is usually set by the installation
ontrack.config.application-working-dir = work/files

# Metrics export period (in seconds)
ontrack.config.metrics-period

# Testing the configurations of external configurations
# Used only for internal testing, to disable the checks
# when creating external configurations
ontrack.config.configuration-test = true

# Number of threads to use to run the background jobs
ontrack.config.jobs.pool-size = 10

# Interval (in minutes) between each refresh of the job list
ontrack.config.jobs.orchestration = 2

# Set to true to not start any job at application startup
# The administrator can restore the scheduling jobs manually
ontrack.config.jobs.paused-at-startup = false

# Enabling the scattering of jobs
# When several jobs have the same schedule, this can create a peak of activity,
# potentially harmful for the performances of the application
# Enabling scattering allows jobs to be scheduled with an additional delay, computed
# as a fraction of the period.
ontrack.config.jobs.scattering = false

# Scattering ratio. Maximum fraction of the period to take into account for the
# scattering. For example, setting 0.5 would not add a dealy greater than half
# the period of the job. Setting 0 would actually disable the scattering altogether.
ontrack.config.jobs.scattering-ratio = 1.0

# Confidential store for the encryption keys
ontrack.config.key-store = file</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="appendix-deprecations"><a class="anchor" href="#appendix-deprecations"></a>9.2. Deprecations and migration notes</h3>
<div class="sect3">
<h4 id="appendix-deprecations-2.28"><a class="anchor" href="#appendix-deprecations-2.28"></a>9.2.1. Since 2.28</h4>
<div class="paragraph">
<p>BitBucket global configurations are no longer associated with issue services,
only project BitBucket configurations are. This is an alignment with the way
the other SCM connections are working in Ontrack.</p>
</div>
<div class="paragraph">
<p>Upgrading to 2.28 performs an automated migration of the global configuration
settings to the project ones.</p>
</div>
</div>
<div class="sect3">
<h4 id="appendix-deprecations-2.16"><a class="anchor" href="#appendix-deprecations-2.16"></a>9.2.2. Since 2.16</h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Support for custom branch and tags patterns in
         <a href="#usage-subversion">Subversion configurations</a> has been <strong>removed</strong>.
         Ontrack now supports only standard Subversion structure:
         <code>project/trunk</code>, <code>project/branches</code> and <code>project/tags</code>. This has
         allowed a better flexibility in the association between builds and
         Subversion locations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Association between builds and Subversion locations is now configured through
a <em>build revision link</em> at branch level. The previous <code>buildPath</code> parameter is
converted automatically to the appropriate <a href="#usage-subversion">type of link</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="roadmap"><a class="anchor" href="#roadmap"></a>9.3. Roadmap</h3>
<div class="paragraph">
<p>Here are big ideas for the future of Ontrack. No plan yet, just rough ideas
or wish lists.</p>
</div>
<div class="sect3">
<h4 id="roadmap-jpa"><a class="anchor" href="#roadmap-jpa"></a>9.3.1. Use JPA / Hibernate for SQL queries</h4>
<div class="ulist">
<ul>
<li>
<p>caching (no existent today)</p>
</li>
<li>
<p>see impact on multi Ontrack cluster</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="roadmap-neo4j"><a class="anchor" href="#roadmap-neo4j"></a>9.3.2. Using Neo4J as backend</h4>
<div class="paragraph">
<p>Ontrack basically stores its data as a graph, and Neo4J would be a perfect
match for the storage.</p>
</div>
<div class="paragraph">
<p>Consider:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>migration</p>
</li>
<li>
<p>search engine</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="roadmap-dsl"><a class="anchor" href="#roadmap-dsl"></a>9.3.3. Global DSL</h4>
<div class="paragraph">
<p>The current Ontrack DSL can be used only remotely and cannot be run on the
server.</p>
</div>
<div class="paragraph">
<p>We could design a DSL which can be run, either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>remotely - interacting with the HTTP API</p>
</li>
<li>
<p>in the server - interacting directly with the services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additionally, the DSL should be extensible so that extensions can contribute
to it, on the same model than the
<a href="https://github.com/jenkinsci/job-dsl-plugin/wiki/Extending-the-DSL">Jenkins Job DSL</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="roadmap-webhooks"><a class="anchor" href="#roadmap-webhooks"></a>9.3.4. Web hooks</h4>
<div class="paragraph">
<p>Have the possibility to register Webhooks in Ontrack in order to notify other
applications about changes and events.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="appendix-certificates"><a class="anchor" href="#appendix-certificates"></a>9.4. Certificates</h3>
<div class="paragraph">
<p>Some resources (Jenkins servers, ticketing systems, SCM&#8230;&#8203;) will be configured and accessed in Ontrack using the
<code>https</code> protocol, possibly with certificates that are not accepted by default.</p>
</div>
<div class="paragraph">
<p>Ontrack does not offer any mechanism to accept such invalid certificates.</p>
</div>
<div class="paragraph">
<p>The running JDK has to be configured in order to accept those certificates.</p>
</div>
<div class="sect3">
<h4 id="appendix-certificates-registration"><a class="anchor" href="#appendix-certificates-registration"></a>9.4.1. Registering a certificate in the JDK</h4>
<div class="paragraph">
<p>To register the certificate in your JDK:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">sudo keytool -importcert \
    -keystore ${JAVA_HOME}/jre/lib/security/cacerts -storepass changeit \
    -alias ${CER_ALIAS} \
    -file ${CER_FILE}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To display its content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">sudo keytool -list \
    -keystore ${JAVA_HOME}/jre/lib/security/cacerts \
    -storepass changeit \
    -alias ${CER_ALIAS} \
    -v</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the complete documentation at <a href="http://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html" class="bare">http://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="appendix-certificates-saving"><a class="anchor" href="#appendix-certificates-saving"></a>9.4.2. Saving the certificate on MacOS</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the Keychain Access utility (Applications &#8594; Utilities)</p>
</li>
<li>
<p>Select your certificate or key from the Certificates or Keys category</p>
</li>
<li>
<p>Choose File &#8594; Export items &#8230;&#8203;</p>
</li>
<li>
<p>In the Save As field, enter a ".cer" name for the exported item, and click Save.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You will be prompted to enter a new export password for the item.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migration-postgres"><a class="anchor" href="#migration-postgres"></a>9.5. Migration from H2 to Postgres</h3>
<div class="paragraph">
<p>Starting from version 3, Ontrack uses Postgres instead of H2 for its back-end.</p>
</div>
<div class="sect3">
<h4 id="migration-postgres-prerequisites"><a class="anchor" href="#migration-postgres-prerequisites"></a>9.5.1. Prerequisites</h4>
<div class="paragraph">
<p>Before you actually start the migration, please make sure you have the following
elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a copy of the H2 database file to migrate (typically a <code>data.mv.db</code> file) and
the associated credentials</p>
</li>
<li>
<p>an access to the Postgres database to migrate to and the associated
credentials</p>
</li>
<li>
<p>a copy of the secret files</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a <a href="#installation-docker">Docker</a> installation, the database is located
at <code>/var/ontrack/data/database/data.mv.db</code> and the secret files in
<code>/var/ontrack/data/files/security/secrets</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a <a href="#installation-rpm">RPM</a> or <a href="#installation-debian">Debian</a> installation,
the database is located at <code>/usr/lib/ontrack/database/data.mv.db</code> and the
secret files in <code>/usr/lib/ontrack/files/security/secrets</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="migration-postgres-tool"><a class="anchor" href="#migration-postgres-tool"></a>9.5.2. Migration tool</h4>
<div class="paragraph">
<p>The migration tool is part of the Ontrack release and can be downloaded
as <code>ontrack-postgresql-migration.jar</code>
in the <a href="https://github.com/nemerosa/ontrack/releases">GitHub release page</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="migration-postgres-run"><a class="anchor" href="#migration-postgres-run"></a>9.5.3. Running the migration</h4>
<div class="paragraph">
<p>Create a directory, called <code>${MIGRATION}</code> in the rest of this section, and</p>
</div>
<div class="ulist">
<ul>
<li>
<p>copy the <code>data.mv.db</code> database file in this directory</p>
</li>
<li>
<p>copy the <code>ontrack-postgresql-migration.jar</code> migration tool in this directory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">java -jar ontrack-postgresql-migration.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the tool will look for the H2 database file in the current
directory, using <code>ontrack</code> / <code>ontrack</code> as credentials.</p>
</div>
<div class="paragraph">
<p>By default, the tool will use a Postgres database located at
<code>jdbc:postgresql://localhost:5432/ontrack</code>, using <code>ontrack</code> / <code>ontrack</code> as
credentials.</p>
</div>
<div class="paragraph">
<p>You can change those default values using the configuration options below.</p>
</div>
</div>
<div class="sect3">
<h4 id="migration-postgres-options"><a class="anchor" href="#migration-postgres-options"></a>9.5.4. Migration tool options</h4>
<div class="paragraph">
<p>Migration options can either be specified on the command line or by
creating a local <code>application.properties</code> file.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.cleanup</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code>, all previous tables will be <strong>deleted</strong>. This forces
  a migration from scratch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.skip-events</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If set to <code>true</code>, the events will not be migrated. This can speed up
  the migration but can have side effects since some entities will not
  be associated with their creation event.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.h2.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jdbc:h2:./data;MODE=MYSQL;DB_CLOSE_ON_EXIT=FALSE;DEFRAG_ALWAYS=TRUE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC URL to the H2 database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.h2.username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User used to connect to the H2 database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.h2.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password used to connect to the H2 database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.postgresql.url</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jdbc:postgresql://localhost:5432/ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDBC URL to the Postgres database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.postgresql.username</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">User used to connect to the Postgres database</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack.migration.postgresql.password</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ontrack</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password used to connect to the Postgres database</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="migration-postgres-options"><a class="anchor" href="#migration-postgres-options"></a>9.5.5. Secret files</h4>
<div class="paragraph">
<p>The <code>master.key</code> and
<code>net.nemerosa.ontrack.security.EncryptionServiceImpl.encryption</code> files
must be copied and put in the <a href="#installation">correct place</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For a development environment, put those files in
<code>work/files/security/secrets</code>, relatively to the workspace root.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="appendix-postgres-flyway"><a class="anchor" href="#appendix-postgres-flyway"></a>9.6. Postgres and Flyway</h3>
<div class="paragraph">
<p>The creation and updates of the Ontrack schema in Postgres is managed using <a href="https://flywaydb.org/">Flyway</a>.</p>
</div>
<div class="paragraph">
<p>The configuration is initialized in the <code>net.nemerosa.ontrack.repository.RepositoryConfig</code> class and SQL files
are stored in <code>ontrack-database/src/main/resources/ontrack/sql</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As of now, <a href="#extending">extensions</a> cannot contribute to the schema.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The actual migration is processed using the <code>net.nemerosa.ontrack.service.support.StartupStrategy</code> component. Once
the database has been upgraded, all <code>StartupService</code> implementations are started in heir specified order.</p>
</div>
</div>
<div class="sect2">
<h3 id="postgres-production-data"><a class="anchor" href="#postgres-production-data"></a>9.7. Using production data</h3>
<div class="paragraph">
<p>Some times, when <a href="#development">developing</a> Ontrack or working with
<a href="#extending">extensions</a>, it might be useful to copy the production data
locally.</p>
</div>
<div class="paragraph">
<p>Make sure to have <code>pg_dump</code> and <code>psql</code> tools available in your working
environment.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
They are part of the Postgres installation but can be downloaded
individually from the <a href="https://www.postgresql.org/download/">download page</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To export the data from the <em>source</em> database in a local <code>ontrack.sql</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">pg_dump --dbname ontrack --host &lt;source-host&gt; --port 5432 \
   --username &lt;source-user&gt; &gt; ontrack.sql</code></pre>
</div>
</div>
<div class="paragraph">
<p>To import this data into the <em>target</em> database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">psql --dbname ontrack --host &lt;target-host&gt; --port 5432 \
   --username &lt;target-user&gt; &lt; ontrack.sql</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
the target database must be <em>empty</em> (no table, no sequences).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the migration of data is done, do not forget to also copy the secret
files and to put them in the correct location.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a <a href="#installation-docker">Docker</a> installation, the secret files are in
<code>/var/ontrack/data/files/security/secrets</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a <a href="#installation-rpm">RPM</a> or <a href="#installation-debian">Debian</a> installation,
the secret files are in <code>/usr/lib/ontrack/files/security/secrets</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In the <a href="#development">development environment</a>,
the secret files are in
<code>work/files/security/secrets</code>, relatively to the workspace root..</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="dsl-doc"><a class="anchor" href="#dsl-doc"></a>9.8. DSL Reference</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" colspan="3"><p class="tableblock">Class summary</p></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock">Class</p></th>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack">Ontrack</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource">AbstractResource</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account">Account</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-accountgroup">AccountGroup</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-accountgroup-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin">Admin</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-authenticationsource">AuthenticationSource</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-authenticationsource-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch">Branch</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-properties">Properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build">Build</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-properties">Properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config">Config</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-document">Document</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-document-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-groupmapping">GroupMapping</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-groupmapping-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ldapsettings">LDAPSettings</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedpromotionlevel">PredefinedPromotionLevel</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedpromotionlevel-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedvalidationstamp">PredefinedValidationStamp</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedvalidationstamp-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project">Project</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-properties">Properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties">ProjectEntityProperties</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel">PromotionLevel</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-properties">Properties</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionrun">PromotionRun</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionrun-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult">SearchResult</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationrun">ValidationRun</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationrun-methods">Methods</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp">ValidationStamp</a></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-methods">Methods</a></p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="dsl-ontrack"><a class="anchor" href="#dsl-ontrack"></a>9.8.1. Ontrack</h4>
<div class="paragraph">
<p>An Ontrack instance is usually bound to the <code>ontrack</code> identifier and is the root for all DSL calls.</p>
</div>
<table id="dsl-ontrack-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-branch"><code>branch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Branch branch(String project, String branch)</code>
</p><p class="tableblock">Looks for a branch in a project. Fails if not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-build"><code>build</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Build build(String project, String branch, String build)</code>
</p><p class="tableblock">Looks for a build by name. Fails if not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-configure"><code>configure</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object configure(Closure closure)</code>
</p><p class="tableblock">Configures the general settings of Ontrack. See <a href="#dsl-config">Config</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-delete"><code>delete</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object delete(String url)</code>
</p><p class="tableblock">Runs an arbitrary DELETE request for a relative path and returns JSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-download"><code>download</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Document download(String url)</code>
</p><p class="tableblock">Downloads an arbitrary document using a relative path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-findProject"><code>findProject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Project findProject(String name)</code>
</p><p class="tableblock">Finds a project using its name. Returns null if not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-get"><code>get</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object get(String url)</code>
</p><p class="tableblock">Runs an arbitrary GET request for a relative path and returns JSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-getAdmin"><code>getAdmin</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Admin getAdmin()</code>
</p><p class="tableblock">Access to the administration of Ontrack</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-getConfig"><code>getConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Config getConfig()</code>
</p><p class="tableblock">Access to the general configuration of Ontrack</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-getProjects"><code>getProjects</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Project&gt; getProjects()</code>
</p><p class="tableblock">Gets the list of projects</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-graphQLQuery"><code>graphQLQuery</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object graphQLQuery(String query, Map variables = [:])</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-post"><code>post</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object post(String url, Object data)</code>
</p><p class="tableblock">Runs an arbitrary POST request for a relative path and some data, and returns JSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-project-closure"><code>project</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Project project(String name, String description = '', Closure closure)</code>
</p><p class="tableblock">Finds or creates a project, and configures it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-project"><code>project</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Project project(String name, String description = '')</code>
</p><p class="tableblock">Finds or creates a project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-promotionLevel"><code>promotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionLevel promotionLevel(String project, String branch, String promotionLevel)</code>
</p><p class="tableblock">Looks for a promotion level by name. Fails if not found.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-put"><code>put</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object put(String url, Object data)</code>
</p><p class="tableblock">Runs an arbitrary PUT request for a relative path and some data, and returns JSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-search"><code>search</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;SearchResult&gt; search(String token)</code>
</p><p class="tableblock">Launches a global search based on a token.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-text"><code>text</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object text(String url)</code>
</p><p class="tableblock">Runs an arbitrary GET request for a relative path and returns text</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-upload"><code>upload</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object upload(String url, String name, Object o)</code>
</p><p class="tableblock">Uploads some arbitrary binary data on a relative path and returns some JSON. See <a href="#dsl-ontrack-upload-type"><code>upload</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-upload-type"><code>upload</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object upload(String url, String name, Object o, String contentType)</code>
</p><p class="tableblock">Uploads some typed data on a relative path and returns some JSON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-ontrack-validationStamp"><code>validationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidationStamp validationStamp(String project, String branch, String validationStamp)</code>
</p><p class="tableblock">Looks for a validation stamp by name. Fails if not found.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-branch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">branch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Branch branch(String project, String branch)</code></p>
</div>
<div class="paragraph">
<p>Looks for a branch in a project. Fails if not found.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-branch">Branch</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-build" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">build</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Build build(String project, String branch, String build)</code></p>
</div>
<div class="paragraph">
<p>Looks for a build by name. Fails if not found.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def build = ontrack.build('prj', 'master', '1.0.0-12')
assert build.name == '1.0.0-12'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-configure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">configure</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object configure(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configures the general settings of Ontrack. See <a href="#dsl-config">Config</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-delete" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">delete</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object delete(String url)</code></p>
</div>
<div class="paragraph">
<p>Runs an arbitrary DELETE request for a relative path and returns JSON</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-download" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">download</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Document download(String url)</code></p>
</div>
<div class="paragraph">
<p>Downloads an arbitrary document using a relative path.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-document">Document</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-findProject" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">findProject</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Project findProject(String name)</code></p>
</div>
<div class="paragraph">
<p>Finds a project using its name. Returns null if not found.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-project">Project</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.findProject('unexisting')
assert project == null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-get" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">get</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object get(String url)</code></p>
</div>
<div class="paragraph">
<p>Runs an arbitrary GET request for a relative path and returns JSON</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-getAdmin" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAdmin</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Admin getAdmin()</code></p>
</div>
<div class="paragraph">
<p>Access to the administration of Ontrack</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-admin">Admin</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-getConfig" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getConfig</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Config getConfig()</code></p>
</div>
<div class="paragraph">
<p>Access to the general configuration of Ontrack</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-config">Config</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-getProjects" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProjects</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Project&gt; getProjects()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of projects</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-project">Project</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def projects = ontrack.projects
assert projects instanceof Collection</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-graphQLQuery" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">graphQLQuery</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object graphQLQuery(String query, Map variables = [:])</code></p>
</div>
<div class="paragraph">
<p>The <code>graphQLQuery</code> runs a <a href="http://graphql.org/">GraphQL</a> query against the Ontrack model.</p>
</div>
<div class="paragraph">
<p>It returns a JSON representation of an <a href="https://github.com/graphql-java/graphql-java/blob/master/src/main/java/graphql/ExecutionResult.java"><code>ExecutionResult</code></a>
object containing both the data and any error message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def result = ontrack.graphQLQuery("""{
    projects(name: "P") {
        name
        branches {
            name
        }
    }
}""")

assert result.errors != null &amp;&amp; result.errors.empty
assert result.data.projects.get(0).name == "P"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>graphQLQuery</code> method accepts an additional <code>variables</code> map parameter to define any GraphQL variable used in
the query. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def result = ontrack.graphQLQuery("""{
    projects(id: $projectId) {
        name
        branches {
            name
        }
    }
}""", [projectId: 10])</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#integration-graphql">GraphQL support</a> for more information about the GraphQL Ontrack integration.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-post" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">post</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object post(String url, Object data)</code></p>
</div>
<div class="paragraph">
<p>Runs an arbitrary POST request for a relative path and some data, and returns JSON</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-project-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">project</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Project project(String name, String description = '', Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Finds or creates a project, and configures it.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-project">Project</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('my-project', 'My project') {
    // Configuring the project
}
assert project.name == 'my-project'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-project" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">project</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Project project(String name, String description = '')</code></p>
</div>
<div class="paragraph">
<p>Finds or creates a project.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-project">Project</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('my-project', 'My project')
assert project.name == 'my-project'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-promotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">promotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionLevel promotionLevel(String project, String branch, String promotionLevel)</code></p>
</div>
<div class="paragraph">
<p>Looks for a promotion level by name. Fails if not found.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionlevel">PromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-put" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">put</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object put(String url, Object data)</code></p>
</div>
<div class="paragraph">
<p>Runs an arbitrary PUT request for a relative path and some data, and returns JSON</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-search" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">search</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;SearchResult&gt; search(String token)</code></p>
</div>
<div class="paragraph">
<p>Launches a global search based on a token.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-searchresult">SearchResult</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-text" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">text</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object text(String url)</code></p>
</div>
<div class="paragraph">
<p>Runs an arbitrary GET request for a relative path and returns text</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-upload" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">upload</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object upload(String url, String name, Object o)</code></p>
</div>
<div class="paragraph">
<p>Uploads some arbitrary binary data on a relative path and returns some JSON. See <a href="#dsl-ontrack-upload-type"><code>upload</code></a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-upload-type" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">upload</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object upload(String url, String name, Object o, String contentType)</code></p>
</div>
<div class="paragraph">
<p>Uploads some typed data on a relative path and returns some JSON</p>
</div>
<div class="paragraph">
<p>Creates a multi-part upload request where the <code>name</code> part contains the content of the given input <code>o</code> object. The
content depends on the type of object:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for a <code>net.nemerosa.ontrack.dsl.Document</code>, uploads this document - the <code>contentType</code> parameter is then ignored</p>
</li>
<li>
<p>for a <code>File</code> or <code>URL</code>, the content of the file is uploaded, using the provided <code>contentType</code></p>
</li>
<li>
<p>for a <code>byte</code> array, the content of the array is uploaded, using the provided <code>contentType</code></p>
</li>
<li>
<p>for a <code>String</code>:</p>
<div class="ulist">
<ul>
<li>
<p>if starting with <code>classpath:</code>, the remainder of the string is used as a resource path (see <code>URL</code> above)</p>
</li>
<li>
<p>if a valid <code>URL</code>, we use the string as a URL - see above</p>
</li>
<li>
<p>if any other case, we consider the string to be the path to a file - see <code>File</code> above</p>
</li>
</ul>
</div>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-ontrack-validationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">validationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ValidationStamp validationStamp(String project, String branch, String validationStamp)</code></p>
</div>
<div class="paragraph">
<p>Looks for a validation stamp by name. Fails if not found.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationstamp">ValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-abstractprojectresource"><a class="anchor" href="#dsl-abstractprojectresource"></a>9.8.2. AbstractProjectResource</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-abstractprojectresource-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-config"><code>config</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object config(Closure closure)</code>
</p><p class="tableblock">Configures this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-delete"><code>delete</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object delete()</code>
</p><p class="tableblock">Deletes this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getDecoration"><code>getDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getDecoration(String type)</code>
</p><p class="tableblock">Gets the data for the first decoration of a given type. If no decoration is available, returns null.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-decorations-type"><code>getDecorations</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;&gt; getDecorations(String type)</code>
</p><p class="tableblock">Returns the list of decoration data (JSON) for a given decoration type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getDecorations"><code>getDecorations</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;&gt; getDecorations()</code>
</p><p class="tableblock">Returns the list of decorations for this entity. Each item has a <code>decorationType</code> type name and <code>data</code> as JSON.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getDescription"><code>getDescription</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getDescription()</code>
</p><p class="tableblock">Returns any description attached to this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getId"><code>getId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int getId()</code>
</p><p class="tableblock">Returns the numeric ID of this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getJenkinsJobDecoration"><code>getJenkinsJobDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getJenkinsJobDecoration()</code>
</p><p class="tableblock">Gets the Jenkins decoration for this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getMessageDecoration"><code>getMessageDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String&gt; getMessageDecoration()</code>
</p><p class="tableblock">Gets any message for this entity</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-getName"><code>getName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getName()</code>
</p><p class="tableblock">Returns the name of this entity.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-property-get"><code>getProperty</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getProperty(String type, boolean required)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-property-get-required"><code>property</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object property(String type)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractprojectresource-property"><code>property</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object property(String type, Object data)</code>
</p><p class="tableblock">Sets the value for a property of this entity. Prefer using dedicated DSL methods.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-config" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">config</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object config(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configures this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-delete" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">delete</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object delete()</code></p>
</div>
<div class="paragraph">
<p>Deletes this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getDecoration(String type)</code></p>
</div>
<div class="paragraph">
<p>Gets the data for the first decoration of a given type. If no decoration is available, returns null.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-decorations-type" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDecorations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;&gt; getDecorations(String type)</code></p>
</div>
<div class="paragraph">
<p>Returns the list of decoration data (JSON) for a given decoration type.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getDecorations" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDecorations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;&gt; getDecorations()</code></p>
</div>
<div class="paragraph">
<p>Returns the list of decorations for this entity. Each item has a <code>decorationType</code> type name and <code>data</code> as JSON.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getDescription" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDescription</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getDescription()</code></p>
</div>
<div class="paragraph">
<p>Returns any description attached to this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getId" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getId</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>int getId()</code></p>
</div>
<div class="paragraph">
<p>Returns the numeric ID of this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getJenkinsJobDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getJenkinsJobDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getJenkinsJobDecoration()</code></p>
</div>
<div class="paragraph">
<p>Gets the Jenkins decoration for this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getMessageDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getMessageDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Map&lt;String&gt; getMessageDecoration()</code></p>
</div>
<div class="paragraph">
<p>Gets any message for this entity</p>
</div>
<div class="paragraph">
<p>The message is returned as a map containing:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>type</code> of message: <code>ERROR</code>, <code>WARNING</code> or <code>INFO</code></p>
</li>
<li>
<p>the actual <code>text</code> of the message</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The returned map is <code>null</code> is no message is associated with this entity.</p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('prj')
def branch = ontrack.branch('prj', 'test')
def build = ontrack.build('prj', 'test', '1')
assert project.messageDecoration == null
assert branch.messageDecoration == null
assert build.messageDecoration == null
project.config.message('Information', 'INFO')
assert project.messageDecoration == [type: 'INFO', text: 'Information']
branch.config.message('Warning', 'WARNING')
assert branch.messageDecoration == [type: 'WARNING', text: 'Warning']
build.config.message('Error', 'ERROR')
assert build.messageDecoration == [type: 'ERROR', text: 'Error']</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-getName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getName()</code></p>
</div>
<div class="paragraph">
<p>Returns the name of this entity.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-property-get" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProperty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getProperty(String type, boolean required)</code></p>
</div>
<div class="paragraph">
<p>Gets a property on the project entity.</p>
</div>
<div class="paragraph">
<p>If <code>required</code> is set to <code>false</code> and if the property does not exist or is not set, <code>null</code> will be returned.</p>
</div>
<div class="paragraph">
<p>If <code>required</code> is set to <code>true</code> and if the property does not exist or is not set, a
<code>net.nemerosa.ontrack.dsl.PropertyNotFoundException</code> is thrown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('PRJ')
def value = project.getProperty('com.my.UnsetPropertyType', false)
assert value == null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-property-get-required" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object property(String type)</code></p>
</div>
<div class="paragraph">
<p>Gets a required property on the project entity.</p>
</div>
<div class="paragraph">
<p>If the property does not exist or is not set, a <code>net.nemerosa.ontrack.dsl.PropertyNotFoundException</code> is thrown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('PRJ')
def value = project.property('com.my.PropertyType')</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractprojectresource-property" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object property(String type, Object data)</code></p>
</div>
<div class="paragraph">
<p>Sets the value for a property of this entity. Prefer using dedicated DSL methods.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-abstractresource"><a class="anchor" href="#dsl-abstractresource"></a>9.8.3. AbstractResource</h4>
<table id="dsl-abstractresource-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource-getNode"><code>getNode</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getNode()</code>
</p><p class="tableblock">Gets the internal JSON representation of this resource.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource-getPage"><code>getPage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getPage()</code>
</p><p class="tableblock">Gets the Web page address for this resource.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource-link"><code>link</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String link(String name)</code>
</p><p class="tableblock">Gets a link address.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-abstractresource-optionalLink"><code>optionalLink</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String optionalLink(String name)</code>
</p><p class="tableblock">Gets a link address if it exists.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractresource-getNode" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getNode</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getNode()</code></p>
</div>
<div class="paragraph">
<p>Gets the internal JSON representation of this resource.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractresource-getPage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getPage()</code></p>
</div>
<div class="paragraph">
<p>Gets the Web page address for this resource.</p>
</div>
<div class="paragraph">
<p>This method returns the URL of the Web page which displays this resource.</p>
</div>
<div class="paragraph">
<p>This is equivalent to calling <code>link('page')</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractresource-link" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String link(String name)</code></p>
</div>
<div class="paragraph">
<p>Gets a link address.</p>
</div>
<div class="paragraph">
<p>The <code>name</code> of the link refers to a link which is embedded in the JSON representation of the resource. In the JSON,
the link name is prefixed by <code>_</code> but the <code>name</code> does not have too.</p>
</div>
<div class="paragraph">
<p>For example, <code>link('create')</code> and <code>link('_create')</code> are equivalent.</p>
</div>
<div class="paragraph">
<p>If the link does not exist, an <code>ResourceMissingLinkException</code> error is thrown.</p>
</div>
<div class="paragraph">
<p>The value of the link can be called using the <a href="#dsl-ontrack">Ontrack</a> methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.projects[0]
def projectJson = ontrack.get(project.link('self'))</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-abstractresource-optionalLink" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">optionalLink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String optionalLink(String name)</code></p>
</div>
<div class="paragraph">
<p>Gets a link address if it exists.</p>
</div>
<div class="paragraph">
<p>This is the same than the <a href="#dsl-abstractresource-link"><code>link</code></a> method, but returns <code>null</code> is the link does not exist instead of failing.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-account"><a class="anchor" href="#dsl-account"></a>9.8.4. Account</h4>
<div class="paragraph">
<p>Representation of a user account.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-account-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getAccountGroups"><code>getAccountGroups</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;AccountGroup&gt; getAccountGroups()</code>
</p><p class="tableblock">List of groups this account belongs to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getAuthenticationSource"><code>getAuthenticationSource</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AuthenticationSource getAuthenticationSource()</code>
</p><p class="tableblock">Source of the account: LDAP, built-in, &#8230;&#8203;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getEmail"><code>getEmail</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getEmail()</code>
</p><p class="tableblock">Email for the account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getFullName"><code>getFullName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getFullName()</code>
</p><p class="tableblock">Display name for the account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getId"><code>getId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int getId()</code>
</p><p class="tableblock">Unique ID for the account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getName"><code>getName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getName()</code>
</p><p class="tableblock">User name, used for signing in.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-account-getRole"><code>getRole</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getRole()</code>
</p><p class="tableblock">Role for the user: admin or not.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getAccountGroups" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccountGroups</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;AccountGroup&gt; getAccountGroups()</code></p>
</div>
<div class="paragraph">
<p>List of groups this account belongs to.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-accountgroup">AccountGroup</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getAuthenticationSource" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAuthenticationSource</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>AuthenticationSource getAuthenticationSource()</code></p>
</div>
<div class="paragraph">
<p>Source of the account: LDAP, built-in, &#8230;&#8203;</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-authenticationsource">AuthenticationSource</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getEmail" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getEmail</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getEmail()</code></p>
</div>
<div class="paragraph">
<p>Email for the account.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getFullName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getFullName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getFullName()</code></p>
</div>
<div class="paragraph">
<p>Display name for the account.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getId" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getId</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>int getId()</code></p>
</div>
<div class="paragraph">
<p>Unique ID for the account.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getName()</code></p>
</div>
<div class="paragraph">
<p>User name, used for signing in.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-account-getRole" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getRole</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getRole()</code></p>
</div>
<div class="paragraph">
<p>Role for the user: admin or not.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-accountgroup"><a class="anchor" href="#dsl-accountgroup"></a>9.8.5. AccountGroup</h4>
<div class="paragraph">
<p>Account group. Just a name and a description.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-accountgroup-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-accountgroup-getDescription"><code>getDescription</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getDescription()</code>
</p><p class="tableblock">Description of the group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-accountgroup-getId"><code>getId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int getId()</code>
</p><p class="tableblock">Unique ID for the group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-accountgroup-getName"><code>getName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getName()</code>
</p><p class="tableblock">Name of the group. Unique.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-accountgroup-getDescription" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDescription</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getDescription()</code></p>
</div>
<div class="paragraph">
<p>Description of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-accountgroup-getId" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getId</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>int getId()</code></p>
</div>
<div class="paragraph">
<p>Unique ID for the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-accountgroup-getName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getName()</code></p>
</div>
<div class="paragraph">
<p>Name of the group. Unique.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-admin"><a class="anchor" href="#dsl-admin"></a>9.8.6. Admin</h4>
<div class="paragraph">
<p>Administration management</p>
</div>
<table id="dsl-admin-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-account"><code>account</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Account account(String name, String fullName, String email, String password = '', List groupNames = [])</code>
</p><p class="tableblock">Creates or updates an account.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-accountGroup"><code>accountGroup</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AccountGroup accountGroup(String name, String description)</code>
</p><p class="tableblock">Creates or updates an account group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getAccountGlobalPermissions"><code>getAccountGlobalPermissions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Role&gt; getAccountGlobalPermissions(String accountName)</code>
</p><p class="tableblock">Gets the list of global roles an account has. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getAccountGroupGlobalPermissions"><code>getAccountGroupGlobalPermissions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Role&gt; getAccountGroupGlobalPermissions(String groupName)</code>
</p><p class="tableblock">Gets the list of global roles an account group has. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getAccountGroupProjectPermissions"><code>getAccountGroupProjectPermissions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Role&gt; getAccountGroupProjectPermissions(String projectName, String groupName)</code>
</p><p class="tableblock">Gets the list of roles an account group has on a project. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getAccountProjectPermissions"><code>getAccountProjectPermissions</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Role&gt; getAccountProjectPermissions(String projectName, String accountName)</code>
</p><p class="tableblock">Gets the list of roles an account has on a project. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getAccounts"><code>getAccounts</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Account&gt; getAccounts()</code>
</p><p class="tableblock">Returns the list of all accounts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getGroups"><code>getGroups</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;AccountGroup&gt; getGroups()</code>
</p><p class="tableblock">Returns the list of all groups.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-getLdapMappings"><code>getLdapMappings</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;GroupMapping&gt; getLdapMappings()</code>
</p><p class="tableblock">Gets the list of LDAP mappings.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-ldapMapping"><code>ldapMapping</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GroupMapping ldapMapping(String name, String groupName)</code>
</p><p class="tableblock">Creates or updates a LDAP mapping.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-setAccountGlobalPermission"><code>setAccountGlobalPermission</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void setAccountGlobalPermission(String accountName, String globalRole)</code>
</p><p class="tableblock">Sets a global role on an account. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-setAccountGroupGlobalPermission"><code>setAccountGroupGlobalPermission</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void setAccountGroupGlobalPermission(String groupName, String globalRole)</code>
</p><p class="tableblock">Sets a global role on an account group. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-setAccountGroupProjectPermission"><code>setAccountGroupProjectPermission</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void setAccountGroupProjectPermission(String projectName, String groupName, String projectRole)</code>
</p><p class="tableblock">Sets a project role on an account group. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-admin-setAccountProjectPermission"><code>setAccountProjectPermission</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void setAccountProjectPermission(String projectName, String accountName, String projectRole)</code>
</p><p class="tableblock">Sets a project role on an account. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-account" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">account</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Account account(String name, String fullName, String email, String password = '', List groupNames = [])</code></p>
</div>
<div class="paragraph">
<p>Creates or updates an account.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-account">Account</a>
This method is used only to create <em>built-in</em> accounts. There is no need to create <a href="#ldap">LDAP-based</a> accounts.</p>
</div>
<div class="paragraph">
<p>The <code>name</code>, <code>fullName</code> and <code>email</code> parameters are required and unique. The password is required only when
creating a new account, not when updating it.</p>
</div>
<div class="paragraph">
<p>The list of groups the account must belong to is provided using the names of the groups.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin {
    account 'test', 'Test user', 'xxx'
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-accountGroup" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">accountGroup</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>AccountGroup accountGroup(String name, String description)</code></p>
</div>
<div class="paragraph">
<p>Creates or updates an account group.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-accountgroup">AccountGroup</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getAccountGlobalPermissions" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccountGlobalPermissions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Role&gt; getAccountGlobalPermissions(String accountName)</code></p>
</div>
<div class="paragraph">
<p>Gets the list of global roles an account has. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getAccountGroupGlobalPermissions" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccountGroupGlobalPermissions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Role&gt; getAccountGroupGlobalPermissions(String groupName)</code></p>
</div>
<div class="paragraph">
<p>Gets the list of global roles an account group has. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getAccountGroupProjectPermissions" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccountGroupProjectPermissions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Role&gt; getAccountGroupProjectPermissions(String projectName, String groupName)</code></p>
</div>
<div class="paragraph">
<p>Gets the list of roles an account group has on a project. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getAccountProjectPermissions" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccountProjectPermissions</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Role&gt; getAccountProjectPermissions(String projectName, String accountName)</code></p>
</div>
<div class="paragraph">
<p>Gets the list of roles an account has on a project. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getAccounts" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccounts</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Account&gt; getAccounts()</code></p>
</div>
<div class="paragraph">
<p>Returns the list of all accounts.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-account">Account</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getGroups" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGroups</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;AccountGroup&gt; getGroups()</code></p>
</div>
<div class="paragraph">
<p>Returns the list of all groups.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-accountgroup">AccountGroup</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-getLdapMappings" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getLdapMappings</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;GroupMapping&gt; getLdapMappings()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of LDAP mappings.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-groupmapping">GroupMapping</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-ldapMapping" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ldapMapping</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>GroupMapping ldapMapping(String name, String groupName)</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a LDAP mapping.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-groupmapping">GroupMapping</a>
The <code>name</code> parameter is the name of the group in the LDAP.</p>
</div>
<div class="paragraph">
<p>The <code>groupName</code> parameter is the name of the group in Ontrack. It must exist.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.admin {
    accountGroup 'MyGroup', 'An Ontrack group'
    ldapMapping 'GroupInLDAP', 'MyGroup'
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-setAccountGlobalPermission" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setAccountGlobalPermission</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void setAccountGlobalPermission(String accountName, String globalRole)</code></p>
</div>
<div class="paragraph">
<p>Sets a global role on an account. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-setAccountGroupGlobalPermission" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setAccountGroupGlobalPermission</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void setAccountGroupGlobalPermission(String groupName, String globalRole)</code></p>
</div>
<div class="paragraph">
<p>Sets a global role on an account group. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-setAccountGroupProjectPermission" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setAccountGroupProjectPermission</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void setAccountGroupProjectPermission(String projectName, String groupName, String projectRole)</code></p>
</div>
<div class="paragraph">
<p>Sets a project role on an account group. See <a href="#dsl-usecases-security-account-group-permissions">Account group permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-admin-setAccountProjectPermission" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setAccountProjectPermission</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>void setAccountProjectPermission(String projectName, String accountName, String projectRole)</code></p>
</div>
<div class="paragraph">
<p>Sets a project role on an account. See <a href="#dsl-usecases-security-account-permissions">Account permissions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-authenticationsource"><a class="anchor" href="#dsl-authenticationsource"></a>9.8.7. AuthenticationSource</h4>
<div class="paragraph">
<p>Authentication source for an account - indicates how the account is authenticated: LDAP, built-in, etc.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-authenticationsource-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-authenticationsource-getId"><code>getId</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getId()</code>
</p><p class="tableblock">Identifier for the source: ldap, password</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-authenticationsource-getName"><code>getName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getName()</code>
</p><p class="tableblock">Display name for the source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-authenticationsource-isAllowingPasswordChange"><code>isAllowingPasswordChange</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean isAllowingPasswordChange()</code>
</p><p class="tableblock">Does this source allow to change the password?</p></td>
</tr>
</tbody>
</table>
<table id="dsl-authenticationsource-getId" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getId</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getId()</code></p>
</div>
<div class="paragraph">
<p>Identifier for the source: ldap, password</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-authenticationsource-getName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getName()</code></p>
</div>
<div class="paragraph">
<p>Display name for the source</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-authenticationsource-isAllowingPasswordChange" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">isAllowingPasswordChange</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean isAllowingPasswordChange()</code></p>
</div>
<div class="paragraph">
<p>Does this source allow to change the password?</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-branch"><a class="anchor" href="#dsl-branch"></a>9.8.8. Branch</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<div class="paragraph">
<p>Go to the <a href="#dsl-branch-methods">methods</a></p>
</div>
<table id="dsl-branch-properties" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration properties</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>See also: <a href="#dsl-projectentityproperties">ProjectEntityProperties</a></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration property summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-artifactorySync"><code>artifactorySync</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object artifactorySync(String configuration, String buildName, String buildNameFilter = '*', int interval = 0)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-getArtifactorySync"><code>getArtifactorySync</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getArtifactorySync()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-getGitBranch"><code>getGitBranch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getGitBranch()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-getSvn"><code>getSvn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getSvn()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-getSvnSync"><code>getSvnSync</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getSvnSync()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-getSvnValidatorClosedIssues"><code>getSvnValidatorClosedIssues</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getSvnValidatorClosedIssues()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-gitBranch"><code>gitBranch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitBranch(String branch, Map params = [:])</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-svn"><code>svn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object svn(Map params = [:])</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-svnSync"><code>svnSync</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object svnSync(int interval = 0, boolean override = false)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branchproperties-svnValidatorClosedIssues"><code>svnValidatorClosedIssues</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object svnValidatorClosedIssues(Collection closedStatuses)</code></p></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-svn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: svn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object svn(Map params = [:])</code></p>
</div>
<div class="paragraph">
<p>To get the <a href="#usage-svn">SVN branch configuration</a>:</p>
</div>
<div class="paragraph">
<p><code>def getSvn()</code></p>
</div>
<div class="paragraph">
<p>To associate a branch with some Subversion properties:</p>
</div>
<div class="paragraph">
<p><code>def svn (Map&lt;String, ?&gt; params)</code></p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The project the branch belongs to must be <a href="#dsl-projectProperties-svn">configured for Subversion</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>branchPath</code> - required - the path to the branch, relative to the repository</p>
</li>
<li>
<p><code>link</code> - optional - type of build link:</p>
<div class="ulist">
<ul>
<li>
<p><code>tag</code> for build name as tag (default)</p>
</li>
<li>
<p><code>tagPattern</code> for build name as tag pattern</p>
</li>
<li>
<p><code>revision</code> for build name as revision</p>
</li>
<li>
<p><code>revisionPattern</code> for build name containing the revision</p>
</li>
<li>
<p>see the <a href="#usage-subversion">Working with Subversion</a> documentation for more details</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>data</code> - optional - configuration data for the link, typically <code>[pattern: '&#8230;&#8203;']</code> for <code>tagPattern</code> and <code>revisionPattern</code> links</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
       svn 'myconfig', '/project/trunk'
   }
   branch('mybranch') {
      config {
           svn branchPath: '/project/branches/mybranch',
               link: 'revisionPattern',
               data: [pattern: '2.0.*-{revision}']
       }
   }
}
def cfg = ontrack.branch('project', 'mybranch').config.svn
assert cfg.branchPath == '/project/branches/mybranch'
assert cfg.buildRevisionLink.id == 'revisionPattern'
assert cfg.buildRevisionLink.data.pattern == '11.8.4.*-{revision}'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-getSvn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getSvn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getSvn()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-branchproperties-svn">svn</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-gitBranch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: gitBranch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitBranch(String branch, Map params = [:])</code></p>
</div>
<div class="paragraph">
<p>Defines the <a href="#usage-git">Git properties</a> for an Ontrack branch. <code>branch</code> is the name of the Git branch. Possible
parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>buildCommitLink.id</code> &amp; <code>buildCommitLink.data</code> are the definition of the link between the Ontrack builds and the Git
commits. See the samples below.</p>
</li>
<li>
<p><code>override</code> - <code>true</code> or <code>false</code> - defines if the synchronisation overrides or not the existing builds (defaults
to <code>false</code>)</p>
</li>
<li>
<p><code>buildTagInterval</code> - interval in minutes between each synchronisation between the builds and Git branch. <code>0</code> (default)
to disable. Note that not all build commit links allow for synchronisation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>for a branch whose build names are long commits (the default):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.branch('project') {
   branch('1.0') {
      config {
         gitBranch 'release/1.0'
      }
   }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>for a branch whose build names are short commits:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.branch('project') {
   branch('1.0') {
      config {
         gitBranch 'release/1.0', [
            buildCommitLink: [
               id: 'commit',
               data: [
                  abbreviated: true
               ]
            ]
         ]
      }
   }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>for a branch whose build names are associated to Git tags following a given pattern</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.branch('project') {
   branch('1.0') {
      config {
         gitBranch 'release/1.0', [
            buildCommitLink: [
               id: 'tagPattern',
               data: [
                  pattern: '1.0.*'
               ]
            ]
         ]
      }
   }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>for a branch whose build are associated to Git commits using a Git property:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.branch('project') {
   branch('1.0') {
      config {
         gitBranch 'release/1.0', [
            buildCommitLink: [
               id: 'git-commit-property'
            ]
         ]
      }
   }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The builds of this branch can be associated with a Git commit using the
<a href="#dsl-buildProperties-gitCommit"><code>build.config.gitCommit</code></a> method.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-getGitBranch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getGitBranch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getGitBranch()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-branchproperties-gitBranch">gitBranch</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-svnValidatorClosedIssues" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: svnValidatorClosedIssues</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object svnValidatorClosedIssues(Collection closedStatuses)</code></p>
</div>
<div class="paragraph">
<p>A <a href="#usage-svn">SVN-enabled branch</a> can be associated with a validator
in order to validate if there are some anomalies for the issues in the change logs.</p>
</div>
<div class="paragraph">
<p><code>def svnValidatorClosedIssues(Collection&lt;String&gt; closedStatuses)</code></p>
</div>
<div class="paragraph">
<p>Sets the list of issues statuses which can raise warnings if one of the issues is present <em>after</em> the change log.</p>
</div>
<div class="paragraph">
<p><code>def getSvnValidatorClosedIssues()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of statuses to look for.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   svn 'myconfig', url: 'svn://localhost'
}
ontrack.project('project') {
   config {
       svn 'myconfig', '/project/trunk'
   }
   branch('test') {
       config {
           svn '/project/branches/mybranch', '/project/tags/{build:mybranch-*}'
           svnValidatorClosedIssues(['Closed'])
       }
   }
}
assert ontrack.branch('project', 'test').config.svnValidatorClosedIssues.closedStatuses == ['Closed']</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-getSvnValidatorClosedIssues" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getSvnValidatorClosedIssues</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getSvnValidatorClosedIssues()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-branchproperties-svnValidatorClosedIssues">svnValidatorClosedIssues</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-svnSync" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: svnSync</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object svnSync(int interval = 0, boolean override = false)</code></p>
</div>
<div class="paragraph">
<p>For a <a href="#usage-subversion">Subversion-enabled branch</a>, an automated
synchronisation can be set in order to regularly create builds from the list
of tags in Subversion.</p>
</div>
<div class="paragraph">
<p><code>def svnSync(int interval = 0, boolean override = false)</code></p>
</div>
<div class="paragraph">
<p>Sets a synchronisation every <code>interval</code> minutes (<code>0</code> meaning no sync at all).
The <code>override</code> flag is used to allow existing builds to be overridden.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   svn 'myconfig', url: 'svn://localhost'
}
ontrack.project('project') {
   config {
       svn 'myconfig', '/project/trunk'
   }
   branch('test') {
       config {
           svn '/project/branches/mybranch', '/project/tags/{build:mybranch-*}'
           svnSync 30
       }
   }
}
def sync = ontrack.branch('project', 'test').config.svnSync
assert sync.override == false
assert sync.interval == 30</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-getSvnSync" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getSvnSync</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getSvnSync()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-branchproperties-svnSync">svnSync</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-artifactorySync" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: artifactorySync</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object artifactorySync(String configuration, String buildName, String buildNameFilter = '*', int interval = 0)</code></p>
</div>
<div class="paragraph">
<p>Branch builds can be synchronised with <a href="#usage-artifactory">Artifactory</a>:</p>
</div>
<div class="paragraph">
<p><code>def artifactorySync(String configuration, String buildName, String buildNameFilter = '*', int interval = 0)</code></p>
</div>
<div class="paragraph">
<p>and the corresponding configuration can be accessed:</p>
</div>
<div class="paragraph">
<p><code>def getArtifactorySync()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   artifactory 'Artifactory', 'http://artifactory'
}
ontrack.project('project') {
   branch('test') {
       config {
           artifactorySync 'Artifactory', 'test', 'test-*', 30
       }
   }
}
def sync = ontrack.branch('project', 'test').config.artifactorySync
assert sync.configuration.name == 'Artifactory'
assert sync.buildName == 'test'
assert sync.buildNameFilter == 'test-*'
assert sync.interval == 30</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="#dsl-config-artifactory">Artifactory configuration</a> to have access to the list of available configurations.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branchproperties-getArtifactorySync" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getArtifactorySync</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getArtifactorySync()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-branchproperties-artifactorySync">artifactorySync</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-build-closure"><code>build</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Build build(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">Creates a build for the branch and configures it using a closure. See <a href="#dsl-branch-build"><code>build</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-build"><code>build</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Build build(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">Creates a build for the branch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-call"><code>call</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object call(Closure closure)</code>
</p><p class="tableblock">Configures the branch using a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-disable"><code>disable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object disable()</code>
</p><p class="tableblock">Disables the branch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-download"><code>download</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String download(String path)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-enable"><code>enable</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object enable()</code>
</p><p class="tableblock">Enables the branch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-filter"><code>filter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Build&gt; filter(String filterType, Map filterConfig)</code>
</p><p class="tableblock">Runs any filter and returns the list of corresponding builds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getConfig"><code>getConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BranchProperties getConfig()</code>
</p><p class="tableblock">Access to the branch properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getInstance"><code>getInstance</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TemplateInstance getInstance()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getLastPromotedBuilds"><code>getLastPromotedBuilds</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Build&gt; getLastPromotedBuilds()</code>
</p><p class="tableblock">Returns the last promoted builds.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getProject"><code>getProject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getProject()</code>
</p><p class="tableblock">Returns the name of the project the branch belongs to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getPromotionLevels"><code>getPromotionLevels</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;PromotionLevel&gt; getPromotionLevels()</code>
</p><p class="tableblock">Gets the list of promotion levels for this branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getType"><code>getType</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getType()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-getValidationStamps"><code>getValidationStamps</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;ValidationStamp&gt; getValidationStamps()</code>
</p><p class="tableblock">Gets the list of validation stamps for this branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-instance"><code>instance</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Branch instance(String sourceName, Map params)</code>
</p><p class="tableblock">Creates or updates a new branch from this branch template. See <a href="#dsl-templates">DSL Branch template definitions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-isDisabled"><code>isDisabled</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean isDisabled()</code>
</p><p class="tableblock">Gets the disabled state of the branch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-link"><code>link</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object link(String templateName, boolean manual = true, Map parameters)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-promotionLevel"><code>promotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionLevel promotionLevel(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">Creates a promotion level for this branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-promotionLevel-closure"><code>promotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionLevel promotionLevel(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">Creates a promotion level for this branch and configures it using a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-standardFilter"><code>standardFilter</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Build&gt; standardFilter(Map filterConfig)</code>
</p><p class="tableblock">Returns a list of builds for the branch, filtered according to given criteria.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-sync"><code>sync</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object sync()</code>
</p><p class="tableblock">Synchronizes the branch template with its associated instances. Will fail if this branch is not a template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-syncInstance"><code>syncInstance</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object syncInstance()</code>
</p><p class="tableblock">Synchronises the branch instance with its associated template. Will fail if this branch is not a template instance.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-template"><code>template</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object template(Closure closure)</code>
</p><p class="tableblock">Configure the branch as a template definition - see <a href="#dsl-templates">DSL Branch template definitions</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-unlink"><code>unlink</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object unlink()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-validationStamp-closure"><code>validationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidationStamp validationStamp(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">Creates a validation stamp for this branch and configures it using a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-branch-validationStamp"><code>validationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidationStamp validationStamp(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">Creates a validation stamp for this branch.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-build-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">build</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Build build(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Creates a build for the branch and configures it using a closure. See <a href="#dsl-branch-build"><code>build</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-build" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">build</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Build build(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>Creates a build for the branch</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a>
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def build = ontrack.branch('project', 'branch').build('123', '', true)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Settings the <code>getIfExists</code> parameter to <code>true</code> will return the build if it already exists, and will fail if set
to <code>false</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-call" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">call</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object call(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configures the branch using a closure.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-disable" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">disable</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object disable()</code></p>
</div>
<div class="paragraph">
<p>Disables the branch</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-download" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">download</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String download(String path)</code></p>
</div>
<div class="paragraph">
<p>Download a file from the branch SCM.</p>
</div>
<div class="paragraph">
<p>The branch <em>must</em> be associated with a SCM branch, for <a href="#usage-git">Git</a> or <a href="#usage-subversion">Subversion</a>. If not,
the call will fail.</p>
</div>
<div class="paragraph">
<p>The <code>path</code> is relative to the root of the branch in the SCM and is always returned as text.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For security, only users allowed to configure the project will be able to download a file from the branch.
           See <a href="#security">Security</a> for the list of roles.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See also <a href="#dsl-scm">DSL SCM extensions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-enable" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">enable</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object enable()</code></p>
</div>
<div class="paragraph">
<p>Enables the branch</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-filter" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">filter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Build&gt; filter(String filterType, Map filterConfig)</code></p>
</div>
<div class="paragraph">
<p>Runs any filter and returns the list of corresponding builds.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a>
This is a low level method and more specialised methods should instead be used like
<a href="#dsl-branch-standardfilter"><code>standardFilter</code></a> and <a href="#dsl-branch-getLastPromotedBuilds"><code>getLastPromotedBuilds</code></a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getConfig" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getConfig</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>BranchProperties getConfig()</code></p>
</div>
<div class="paragraph">
<p>Access to the branch properties</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getInstance" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getInstance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>TemplateInstance getInstance()</code></p>
</div>
<div class="paragraph">
<p>If the branch is a <a href="#templates">template instance</a>, returns a <code>TemplateInstance</code> object which contains the list of
this instance parameters as a <code>Map</code> in the <code>parameters</code> property. Otherwise returns <code>null</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   branch('template') {
       template {
           parameter 'paramName', 'A parameter'
       }
   }
}
ontrack.branch(project, 'template').instance 'TEST', [
       paramName: 'paramValue'
]
def instance = ontrack.branch(project, 'TEST').instance
assert instance.parameters == [paramName: 'paramValue']</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getLastPromotedBuilds" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getLastPromotedBuilds</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Build&gt; getLastPromotedBuilds()</code></p>
</div>
<div class="paragraph">
<p>Returns the last promoted builds.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a>
For example, to get the last promoted build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def buildName = ontrack.branch('project', 'branch').lastPromotedBuilds[0].name</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getProject" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProject</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getProject()</code></p>
</div>
<div class="paragraph">
<p>Returns the name of the project the branch belongs to.</p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def branch = ontrack.branch('prj', 'master')
assert branch.project == 'prj'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getPromotionLevels" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPromotionLevels</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;PromotionLevel&gt; getPromotionLevels()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of promotion levels for this branch.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionlevel">PromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getType" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getType</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getType()</code></p>
</div>
<div class="paragraph">
<p>Returns the type of the branch when it comes to <a href="#templates">templating</a>.</p>
</div>
<div class="paragraph">
<p>Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CLASSIC</p>
</li>
<li>
<p>TEMPLATE_DEFINITION</p>
</li>
<li>
<p>TEMPLATE_INSTANCE</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-getValidationStamps" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getValidationStamps</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;ValidationStamp&gt; getValidationStamps()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of validation stamps for this branch.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationstamp">ValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-instance" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">instance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Branch instance(String sourceName, Map params)</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a new branch from this branch template. See <a href="#dsl-templates">DSL Branch template definitions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-isDisabled" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">isDisabled</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean isDisabled()</code></p>
</div>
<div class="paragraph">
<p>Gets the disabled state of the branch</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-link" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">link</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object link(String templateName, boolean manual = true, Map parameters)</code></p>
</div>
<div class="paragraph">
<p>Links a <a href="#templates">branch</a> to an existing template. It will fail if the branch is already linked to a template
or is a template definition itself. See <a href="#dsl-branch-unlink"><code>unlink</code></a> to unlink a branch to its template.</p>
</div>
<div class="paragraph">
<p>The <code>templateName</code> is the name of the branch template, and the <code>parameters</code> map contains the values needed
to instantiate the template.</p>
</div>
<div class="paragraph">
<p>You can put the <code>manual</code> flag to <code>false</code> if the template definition does not need any parameter to create
the instance.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-promotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">promotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionLevel promotionLevel(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>Creates a promotion level for this branch.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionlevel">PromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-promotionLevel-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">promotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionLevel promotionLevel(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Creates a promotion level for this branch and configures it using a closure.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionlevel">PromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-standardFilter" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">standardFilter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Build&gt; standardFilter(Map filterConfig)</code></p>
</div>
<div class="paragraph">
<p>Returns a list of builds for the branch, filtered according to given criteria.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a>
For example, to get the last build of a given promotion:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def branch = ontrack.branch('project', 'branch')
def builds = branch.standardFilter count: 1, withPromotionLevel: 'BRONZE'
def buildName = builds[0].name</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Builds are always returned from the most recent one to
           the oldest.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>standardFilter</code> method accepts the following parameters:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>count</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of builds to be returned. Defaults to <code>10</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sincePromotionLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a <a href="#model">promotion level</a>. After reaching the first build having
  this promotion, no further build is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withPromotionLevel</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a <a href="#model">promotion level</a>. Only builds having this promotion are
  returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>afterDate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> date. Only builds having
  been created on or after this date are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>beforeDate</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> date. Only builds having
  been created on or before this date are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sinceValidationStamp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a <a href="#model">validation stamp</a>. After reaching the first build having
  this validation (whatever the status), no further build is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sinceValidationStampStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refines the <code>sinceValidationStamp</code> criteria to check on the status of the
  validation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withValidationStamp</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a <a href="#model">validation stamp</a>. Only builds having this validation
  (whatever the status) are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withValidationStampStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refines the <code>withValidationStamp</code> criteria to check on the status of the
  validation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withProperty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Qualified name of a property (full class name of the <code>PropertyType</code>). Only
  builds having this property being set are returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>withPropertyValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refines the <code>withProperty</code> criteria to check the property value. The way the
  value is matched with the actual value depends on the property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sinceProperty</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Qualified name of a property (full class name of the <code>PropertyType</code>).After
  reaching the first build having this property being set, no further build
  is returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sincePropertyValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refines the <code>sinceProperty</code> criteria to check the property value. The way the
  value is matched with the actual value depends on the property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedFrom</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects builds which are <em>linked from</em> the build selected by the criteria.
  See <a href="#builds-links">Build links</a> for the exact syntax.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedFromPromotion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The build must be linked FROM a build having this promotion (requires "Linked from")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedTo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects builds which are <em>linked to</em> the build selected by the criteria.
  See <a href="#builds-links">Build links</a> for the exact syntax.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedToPromotion</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The build must be linked TO a build having this promotion (requires "Linked to")</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-sync" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">sync</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object sync()</code></p>
</div>
<div class="paragraph">
<p>Synchronizes the branch template with its associated instances. Will fail if this branch is not a template.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-syncInstance" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">syncInstance</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object syncInstance()</code></p>
</div>
<div class="paragraph">
<p>Synchronises the branch instance with its associated template. Will fail if this branch is not a template instance.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-template" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">template</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object template(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configure the branch as a template definition - see <a href="#dsl-templates">DSL Branch template definitions</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-unlink" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">unlink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object unlink()</code></p>
</div>
<div class="paragraph">
<p>Disconnects the branch template instance from its template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">assert ontrack.branch('project', 'test').type == 'TEMPLATE_INSTANCE'
ontrack.branch('project', 'test').unlink()
assert ontrack.branch('project', 'test').type == 'CLASSIC'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-validationStamp-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">validationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ValidationStamp validationStamp(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Creates a validation stamp for this branch and configures it using a closure.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationstamp">ValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-branch-validationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">validationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ValidationStamp validationStamp(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>Creates a validation stamp for this branch.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationstamp">ValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-build"><a class="anchor" href="#dsl-build"></a>9.8.9. Build</h4>
<div class="paragraph">
<p>In order to get the change log between two builds, look at the documentation at <a href="#dsl-usecases-changelogs">DSL Change logs</a>.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<div class="paragraph">
<p>Go to the <a href="#dsl-build-methods">methods</a></p>
</div>
<table id="dsl-build-properties" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration properties</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>See also: <a href="#dsl-projectentityproperties">ProjectEntityProperties</a></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration property summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-getGitCommit"><code>getGitCommit</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getGitCommit()</code>
</p><p class="tableblock">Gets the Git commit associated to this build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-getJenkinsBuild"><code>getJenkinsBuild</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getJenkinsBuild()</code>
</p><p class="tableblock">Gets the Jenkins build property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-getLabel"><code>getLabel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getLabel()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-gitCommit"><code>gitCommit</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitCommit(String commit)</code>
</p><p class="tableblock">Sets a Git commmit associated to this build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-jenkinsBuild"><code>jenkinsBuild</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jenkinsBuild(String configuration, String job, int buildNumber)</code>
</p><p class="tableblock">Associates a Jenkins build with this build.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-buildproperties-label"><code>label</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object label(String name)</code></p></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-label" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: label</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object label(String name)</code></p>
</div>
<div class="paragraph">
<p>A label or release can be attached to a build using:</p>
</div>
<div class="paragraph">
<p><code>def label(String name)</code></p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.build('project', 'branch', 'build').config {
   label 'RC1'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the label associated with a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def name = ontrack.build('project', 'branch', 'build').config.label
assert name == 'RC1'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-getLabel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getLabel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getLabel()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-buildproperties-label">label</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-jenkinsBuild" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: jenkinsBuild</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jenkinsBuild(String configuration, String job, int buildNumber)</code></p>
</div>
<div class="paragraph">
<p>Associates a Jenkins build with this build.</p>
</div>
<div class="paragraph">
<p>The <code>configuration</code> parameter is the name of an existing Jenkins configuration.</p>
</div>
<div class="paragraph">
<p>The <code>job</code> parameter is the path to the Jenkins job. For a job <code>test</code> as the Jenkins root, it would be only <code>test</code>
but for a job <code>test2</code> in a folder <code>parent2</code> which is itself in a folder <code>parent1</code> at the root, this would
be <code>parent1/parent2/test2</code>.</p>
</div>
<div class="paragraph">
<p>The <code>buildNumber</code> is the number of the Jenkins build.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
this link is created automatically when using the
<a href="https://wiki.jenkins-ci.org/display/JENKINS/Ontrack+plugin">Ontrack Jenkins plug-in</a>.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-getJenkinsBuild" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getJenkinsBuild</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getJenkinsBuild()</code></p>
</div>
<div class="paragraph">
<p>Gets the Jenkins build property.</p>
</div>
<div class="paragraph">
<p>Returns an object describing the associated Jenkins build or <code>null</code> if none.</p>
</div>
<div class="paragraph">
<p>The returned object contains the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>configuration</code> object, having itself a <code>name</code> and a <code>url</code> attribute</p>
</li>
<li>
<p>a <code>name</code> - path to the job in Jenkins</p>
</li>
<li>
<p>a <code>url</code> - absolute URL to the build page</p>
</li>
<li>
<p>a <code>pathComponents</code> list of string - same than <code>path</code> but as list of separate components</p>
</li>
<li>
<p>a <code>build</code> number</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Even if a link to a Jenkins build is registered, this does not mean that the actual Jenkins build
           still actually exists.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-gitCommit" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: gitCommit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitCommit(String commit)</code></p>
</div>
<div class="paragraph">
<p>Sets a Git commmit associated to this build.</p>
</div>
<div class="paragraph">
<p>When <a href="#usage-git">working with Git</a>, it is needed to associate a build with a commit. It can be done by using the
build name itself as a commit indicator (full, short, or tag) or by putting the commit as a build property:</p>
</div>
<div class="paragraph">
<p><code>def gitCommit(String commit)</code></p>
</div>
<div class="paragraph">
<p>To get the commit back:</p>
</div>
<div class="paragraph">
<p><code>def getGitCommit()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   branch('test') {
       build('1') {
           config {
               gitCommit 'adef13'
           }
       }
   }
}
assert ontrack.build('project', 'test', '1').config.gitCommit == 'adef13'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-buildproperties-getGitCommit" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getGitCommit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getGitCommit()</code></p>
</div>
<div class="paragraph">
<p>Gets the Git commit associated to this build.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-buildLink"><code>buildLink</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object buildLink(String project, String build)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-call"><code>call</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object call(Closure closure)</code>
</p><p class="tableblock">Configuration of the build in a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getBranch"><code>getBranch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getBranch()</code>
</p><p class="tableblock">Gets the build branch name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getBuildLinks"><code>getBuildLinks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Build&gt; getBuildLinks()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getConfig"><code>getConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BuildProperties getConfig()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getProject"><code>getProject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getProject()</code>
</p><p class="tableblock">Gets the build project name.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getPromotionRuns"><code>getPromotionRuns</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;PromotionRun&gt; getPromotionRuns()</code>
</p><p class="tableblock">Gets the list of promotion runs for this build</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getSvnRevisionDecoration"><code>getSvnRevisionDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Long getSvnRevisionDecoration()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-getValidationRuns"><code>getValidationRuns</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;ValidationRun&gt; getValidationRuns()</code>
</p><p class="tableblock">Gets the list of validation runs for this build</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-promote"><code>promote</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionRun promote(String promotion, Closure closure)</code>
</p><p class="tableblock">Promotes this build to the given promotion level and configures the created <a href="#dsl-promotionrun">promotion run</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-promote"><code>promote</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionRun promote(String promotion)</code>
</p><p class="tableblock">Promotes this build to the given promotion level.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-validate-closure"><code>validate</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidationRun validate(String validationStamp, String validationStampStatus = 'PASSED', Closure closure)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-build-validate"><code>validate</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ValidationRun validate(String validationStamp, String validationStampStatus = 'PASSED')</code></p></td>
</tr>
</tbody>
</table>
<table id="dsl-build-buildLink" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">buildLink</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object buildLink(String project, String build)</code></p>
</div>
<div class="paragraph">
<p>A <a href="#model">build</a> can be linked to other builds.</p>
</div>
<div class="paragraph">
<p>To create links:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def build = ...
build.buildLink 'project1', '11.0'
build.buildLink 'project2', '2.3.1'</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Several links can be attached to a build, by calling the <code>buildLink</code> method several times.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The target project and build <em>must</em> exist.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To get the list of linked builds:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def links = build.buildLinks
assert links.size == 2
def link = links[0]
assert link.project = 'project1'
assert link.branch = '...'
assert link.name = '11.0'
assert link.page = '...' // URL to the build page</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>page</code> property of the link is a URL to the page of the link.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-call" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">call</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object call(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configuration of the build in a closure.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getBranch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getBranch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getBranch()</code></p>
</div>
<div class="paragraph">
<p>Gets the build branch name.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getBuildLinks" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getBuildLinks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Build&gt; getBuildLinks()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-build-buildLink">buildLink</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getConfig" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getConfig</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>BuildProperties getConfig()</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getProject" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProject</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getProject()</code></p>
</div>
<div class="paragraph">
<p>Gets the build project name.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getPromotionRuns" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPromotionRuns</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;PromotionRun&gt; getPromotionRuns()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of promotion runs for this build</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionrun">PromotionRun</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getSvnRevisionDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getSvnRevisionDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Long getSvnRevisionDecoration()</code></p>
</div>
<div class="paragraph">
<p>Returns any <a href="#usage-subversion">Subversion</a> revision attached to this build.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def build = ontrack.build('project', 'branch', '1')
Long revision = build.svnRevisionDecoration
assert revision != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-getValidationRuns" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getValidationRuns</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;ValidationRun&gt; getValidationRuns()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of validation runs for this build</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationrun">ValidationRun</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-promote" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">promote</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionRun promote(String promotion, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Promotes this build to the given promotion level and configures the created <a href="#dsl-promotionrun">promotion run</a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionrun">PromotionRun</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-promote" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">promote</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionRun promote(String promotion)</code></p>
</div>
<div class="paragraph">
<p>Promotes this build to the given promotion level.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-promotionrun">PromotionRun</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-validate-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">validate</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ValidationRun validate(String validationStamp, String validationStampStatus = 'PASSED', Closure closure)</code></p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationrun">ValidationRun</a>
Validates the build using the given validation stamp and status - possible values for the status are:
<code>PASSED</code>, <code>FAILED</code>, <code>DEFECTIVE</code>, <code>EXPLAINED</code>, <code>FIXED</code>, <code>INTERRUPTED</code>, <code>INVESTIGATING</code>, <code>WARNING</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-build-validate" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">validate</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ValidationRun validate(String validationStamp, String validationStampStatus = 'PASSED')</code></p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-validationrun">ValidationRun</a>
<a href="#dsl-build-validate">Validates</a> the build using the given validation stamp and status - and configures the
resulting <a href="#dsl-validationrun">validation run</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-config"><a class="anchor" href="#dsl-config"></a>9.8.10. Config</h4>
<div class="paragraph">
<p>General configuration of Ontrack.</p>
</div>
<table id="dsl-config-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-artifactory"><code>artifactory</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object artifactory(String name, String url, String user = '', String password = '')</code>
</p><p class="tableblock">Creates or updates a Artifactory configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getArtifactory"><code>getArtifactory</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getArtifactory()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getGit"><code>getGit</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getGit()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getGitHub"><code>getGitHub</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getGitHub()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getGitLab"><code>getGitLab</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getGitLab()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getGrantProjectViewToAll"><code>getGrantProjectViewToAll</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getGrantProjectViewToAll()</code>
</p><p class="tableblock">Checks if the projects are accessible in anonymous mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getJenkins"><code>getJenkins</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getJenkins()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getJira"><code>getJira</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getJira()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getLdapSettings"><code>getLdapSettings</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LDAPSettings getLdapSettings()</code>
</p><p class="tableblock">Gets the global LDAP settings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getPredefinedPromotionLevels"><code>getPredefinedPromotionLevels</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;PredefinedPromotionLevel&gt; getPredefinedPromotionLevels()</code>
</p><p class="tableblock">Gets the list of promotion levels. See <a href="#dsl-projectproperties-autoPromotionLevel"><code>autoPromotionLevel</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getPredefinedValidationStamps"><code>getPredefinedValidationStamps</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;PredefinedValidationStamp&gt; getPredefinedValidationStamps()</code>
</p><p class="tableblock">Gets the list of validation stamps. See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getStash"><code>getStash</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getStash()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-getSvn"><code>getSvn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getSvn()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-git"><code>git</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object git(Map parameters, String name)</code>
</p><p class="tableblock">Creates or update a Git configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-github"><code>gitHub</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitHub(String name)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-github-name"><code>gitHub</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitHub(Map parameters, String name)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-gitLab"><code>gitLab</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitLab(Map parameters, String name)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-jenkins"><code>jenkins</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jenkins(String name, String url, String user = '', String password = '')</code>
</p><p class="tableblock">Creates or updates a Jenkins configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-jira"><code>jira</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jira(String name, String url, String user = '', String password = '')</code>
</p><p class="tableblock">Creates or updates a JIRA configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-predefinedPromotionLevel"><code>predefinedPromotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PredefinedPromotionLevel predefinedPromotionLevel(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">See <a href="#dsl-projectproperties-autoPromotionLevel">autoPromotionLevel</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-predefinedPromotionLevel-config"><code>predefinedPromotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PredefinedPromotionLevel predefinedPromotionLevel(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">See <a href="#dsl-projectproperties-autoPromotionLevel"><code>autoPromotionLevel</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-predefinedValidationStamp"><code>predefinedValidationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PredefinedValidationStamp predefinedValidationStamp(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-predefinedValidationStamp-config"><code>predefinedValidationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PredefinedValidationStamp predefinedValidationStamp(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-setGrantProjectViewToAll"><code>setGrantProjectViewToAll</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object setGrantProjectViewToAll(boolean grantProjectViewToAll)</code>
</p><p class="tableblock">Sets if the projects are accessible in anonymous mode.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-setLdapSettings"><code>setLdapSettings</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object setLdapSettings(LDAPSettings settings)</code>
</p><p class="tableblock">Sets the global LDAP settings</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-stash"><code>stash</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object stash(Map parameters, String name)</code>
</p><p class="tableblock">Creates or updates a BitBucket configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-config-svn"><code>svn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object svn(Map parameters, String name)</code>
</p><p class="tableblock">Creates a or updates a Subversion configuration.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-config-artifactory" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">artifactory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object artifactory(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a Artifactory configuration.</p>
</div>
<div class="paragraph">
<p>Access to <a href="#usage-artifactory">Artifactory</a> is done through the configurations:</p>
</div>
<div class="paragraph">
<p><code>def artifactory(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>The list of Artifactory configurations is accessible:</p>
</div>
<div class="paragraph">
<p><code>List&lt;String&gt; getArtifactory()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   artifactory 'Artifactory', 'http://artifactory'
}
assert ontrack.config.artifactory.find { it == 'Artifactory' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getArtifactory" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getArtifactory</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getArtifactory()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-artifactory">artifactory</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getGit" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getGit()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-git">git</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getGitHub" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGitHub</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getGitHub()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-github">gitHub</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getGitLab" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGitLab</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getGitLab()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-gitLab">gitLab</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getGrantProjectViewToAll" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGrantProjectViewToAll</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean getGrantProjectViewToAll()</code></p>
</div>
<div class="paragraph">
<p>Checks if the projects are accessible in anonymous mode.</p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.config.grantProjectViewToAll = false
assert !ontrack.config.grantProjectViewToAll</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getJenkins" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getJenkins</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getJenkins()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-jenkins">jenkins</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getJira" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getJira</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getJira()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-jira">jira</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getLdapSettings" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getLdapSettings</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>LDAPSettings getLdapSettings()</code></p>
</div>
<div class="paragraph">
<p>Gets the global LDAP settings</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-ldapsettings">LDAPSettings</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getPredefinedPromotionLevels" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPredefinedPromotionLevels</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;PredefinedPromotionLevel&gt; getPredefinedPromotionLevels()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of promotion levels. See <a href="#dsl-projectproperties-autoPromotionLevel"><code>autoPromotionLevel</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedpromotionlevel">PredefinedPromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getPredefinedValidationStamps" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPredefinedValidationStamps</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;PredefinedValidationStamp&gt; getPredefinedValidationStamps()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of validation stamps. See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedvalidationstamp">PredefinedValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getStash" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getStash</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getStash()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-stash">stash</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-getSvn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getSvn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getSvn()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-svn">svn</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-git" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">git</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object git(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>Creates or update a Git configuration</p>
</div>
<div class="paragraph">
<p>When working with <a href="#usage-git">Git</a>, the access to the Git repositories must be configured.</p>
</div>
<div class="paragraph">
<p><code>def git(Map&lt;String, ?&gt; parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>The <code>name</code> is the identifier of the configuration - if it already exists, it will be updated.</p>
</div>
<div class="paragraph">
<p>The parameters are the following:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>remote</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the remote location</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user used to connect to GitHub (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">password used to connect to GitHub (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commitLink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link to a commit, using <code>{commit}</code> as placeholder</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fileAtCommitLink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Link to a file at a given commit, using <code>{commit}</code> and <code>{path}</code> as placeholders</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexationInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval (in minutes) between each synchronisation (Ontrack maintains internally a clone of
  the GitHub repository)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">issueServiceConfigurationIdentifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">identifier for the linked issues (see example <a href="#usage-jira">here</a>)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See the <a href="#usage-git">documentation</a> to know the meaning of those parameters.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   git 'ontrack', remote: 'https://github.com/nemerosa/ontrack.git', user: 'test', password: 'secret'
}
assert ontrack.config.git.find { it == 'ontrack' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-github" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">gitHub</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitHub(String name)</code></p>
</div>
<div class="paragraph">
<p>When working with <a href="#usage-github">GitHub</a>, the access to the GitHub API must be configured.</p>
</div>
<div class="paragraph">
<p><code>def gitHub(Map&lt;String, ?&gt; parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>The <code>name</code> is the identifier of the configuration - if it already exists, it will be updated.</p>
</div>
<div class="paragraph">
<p>The parameters are the following:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>url</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the GitHub URL - is set by default to <code><a href="https://github.com" class="bare">https://github.com</a></code> if not filled in, allowing for using GitHub
  enterprise as well</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user used to connect to GitHub (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">password used to connect to GitHub (optional)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">oauth2Token</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OAuth token to use instead of a user/password (optional)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>See <a href="#usage-github">Working with GitHub</a> to know the meaning of those parameters.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   gitHub 'github.com', oauth2Token: 'ABCDEF'
}
assert ontrack.config.gitHub.find { it == 'github.com' } != null</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also configure an anonymous access to <a href="https://github.com" class="bare">https://github.com</a> (not recommended) by doing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   gitHub 'github.com'
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-github-name" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">gitHub</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitHub(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-config-github">gitHub</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-gitLab" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">gitLab</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitLab(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>When working with <a href="#usage-gitlab">GitLab</a>, the access to the GitLab API must be configured.</p>
</div>
<div class="paragraph">
<p><code>def gitLab(Map&lt;String, ?&gt; parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>The <code>name</code> is the identifier of the configuration - if it already exists, it will be updated.</p>
</div>
<div class="paragraph">
<p>The parameters are the following:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>url</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the URL to the GitLab application, without any repository nor project reference</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>user</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user used to connect to GitHub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>password</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Personal Access Token</strong> associated with the user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ignoreSslCertificate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to <code>true</code> if SSL checks must be disabled (optional, default to <code>false</code>)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>password</code> field must be a <strong>Personal Access Token</strong> - using the actual password is <strong>not</strong> supported.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   gitLab 'AcmeGitLab', url: 'https://gitlab.acme.com', user: 'user', password: 'abcdef'
}
assert ontrack.config.gitLab.find { it == 'AcmeGitLab' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-jenkins" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">jenkins</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jenkins(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a Jenkins configuration.</p>
</div>
<div class="paragraph">
<p>Access to <a href="#usage-jenkins">Jenkins</a> is done through the configurations:</p>
</div>
<div class="paragraph">
<p><code>def jenkins(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>The list of Jenkins configurations is accessible:</p>
</div>
<div class="paragraph">
<p><code>List&lt;String&gt; getJenkins()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jenkins 'Jenkins', 'http://jenkins'
}
assert ontrack.config.jenkins.find { it == 'Jenkins' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-jira" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">jira</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jira(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a JIRA configuration.</p>
</div>
<div class="paragraph">
<p>Access to <a href="#usage-jira">JIRA</a> is done through the configurations:</p>
</div>
<div class="paragraph">
<p><code>def jira(String name, String url, String user = '', String password = '')</code></p>
</div>
<div class="paragraph">
<p>The list of JIRA configurations is accessible:</p>
</div>
<div class="paragraph">
<p><code>List&lt;String&gt; getJira()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jira 'JIRA', 'http://jira'
}
assert ontrack.config.jira.find { it == 'JIRA' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-predefinedPromotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">predefinedPromotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PredefinedPromotionLevel predefinedPromotionLevel(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoPromotionLevel">autoPromotionLevel</a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedpromotionlevel">PredefinedPromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-predefinedPromotionLevel-config" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">predefinedPromotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PredefinedPromotionLevel predefinedPromotionLevel(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoPromotionLevel"><code>autoPromotionLevel</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedpromotionlevel">PredefinedPromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-predefinedValidationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">predefinedValidationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PredefinedValidationStamp predefinedValidationStamp(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedvalidationstamp">PredefinedValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-predefinedValidationStamp-config" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">predefinedValidationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PredefinedValidationStamp predefinedValidationStamp(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-predefinedvalidationstamp">PredefinedValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-setGrantProjectViewToAll" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setGrantProjectViewToAll</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object setGrantProjectViewToAll(boolean grantProjectViewToAll)</code></p>
</div>
<div class="paragraph">
<p>Sets if the projects are accessible in anonymous mode.</p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.config.grantProjectViewToAll = true
assert ontrack.config.grantProjectViewToAll</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-setLdapSettings" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">setLdapSettings</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object setLdapSettings(LDAPSettings settings)</code></p>
</div>
<div class="paragraph">
<p>Sets the global LDAP settings</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-stash" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">stash</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object stash(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>Creates or updates a BitBucket configuration.</p>
</div>
<div class="paragraph">
<p>When working with <a href="#dsl-usage-bitbucket">BitBucket</a>, the access
to the BitBucket application must be configured.</p>
</div>
<div class="paragraph">
<p><code>def stash(Map&lt;String, ?&gt; parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>The <code>name</code> is the identifier of the configuration - if it already exists, it will be updated.</p>
</div>
<div class="paragraph">
<p>The parameters are the following:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>url</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the URL of the Stash instance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user L user used to connect to Stash (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   stash 'MyStash', url: 'https://stask.example.com'
}
assert ontrack.config.stash.find { it == 'MyStash' } != null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-config-svn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">svn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object svn(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>Creates a or updates a Subversion configuration.</p>
</div>
<div class="paragraph">
<p>In order to create, update and access a Subversion configuration, use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   svn 'myconfig', url: 'https://myhost/repo'
}
def names = ontrack.config.svn*.name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The configuration password is always returned blank.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some parameters, like <code>url</code> are required. List of parameters is:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>url</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL of the Subversion repository (required)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tagFilterPattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">browserForPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">browserForRevision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">browserForChange</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexationInterval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indexationStart</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">revision to start the indexation from (1 by default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">issueServiceConfigurationIdentifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">identifier for the issue service (optional) - see <a href="#usage-jira">here</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example of issue link (with JIRA):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jira 'MyJIRAConfig', 'http://jira'
   svn 'myconfig', url: 'https://myhost/repo', issueServiceConfigurationIdentifier: 'jira//MyJIRAConfig'
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-document"><a class="anchor" href="#dsl-document"></a>9.8.11. Document</h4>
<div class="paragraph">
<p>Definition for a document, for upload and download methods. See also <a href="#dsl-usecases-images">DSL Images and documents</a>.</p>
</div>
<table id="dsl-document-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-document-getContent"><code>getContent</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byte[] getContent()</code>
</p><p class="tableblock">Returns the content of the document as an array of bytes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-document-getType"><code>getType</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getType()</code>
</p><p class="tableblock">Returns the MIME type of the document.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-document-isEmpty"><code>isEmpty</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean isEmpty()</code>
</p><p class="tableblock">Returns true is the document is empty and has no content.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-document-getContent" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getContent</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>byte[] getContent()</code></p>
</div>
<div class="paragraph">
<p>Returns the content of the document as an array of bytes.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-document-getType" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getType</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getType()</code></p>
</div>
<div class="paragraph">
<p>Returns the MIME type of the document.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-document-isEmpty" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">isEmpty</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean isEmpty()</code></p>
</div>
<div class="paragraph">
<p>Returns true is the document is empty and has no content.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-groupmapping"><a class="anchor" href="#dsl-groupmapping"></a>9.8.12. GroupMapping</h4>
<div class="paragraph">
<p>Mapping between a LDAP group and an account group.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-groupmapping-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-groupmapping-getGroupName"><code>getGroupName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getGroupName()</code>
</p><p class="tableblock">Name of the Ontrack account group.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-groupmapping-getName"><code>getName</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getName()</code>
</p><p class="tableblock">Name of the LDAP group.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-groupmapping-getGroupName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getGroupName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getGroupName()</code></p>
</div>
<div class="paragraph">
<p>Name of the Ontrack account group.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-groupmapping-getName" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getName</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getName()</code></p>
</div>
<div class="paragraph">
<p>Name of the LDAP group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-ldapsettings"><a class="anchor" href="#dsl-ldapsettings"></a>9.8.13. LDAPSettings</h4>
<div class="paragraph">
<p>LDAP settings parameters.</p>
</div>
<div class="paragraph">
<p>The LDAP settings are defined using the following values:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set to <code>true</code> to actually enable the LDAP Authentication</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">url</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL to the LDAP end point. For example, <code>ldaps://ldap.company.com:636</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">searchBase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DN for the search root, for example, <code>dc=company,dc=com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">searchFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query to look for an account. <code>{0}</code> is replaced by the account name.
  For example, <code>(sAMAccountName={0})</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service account user to connect to the LDAP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">password</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password of the service account user to connect to the LDAP.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fullNameAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute which contains the display name of the account. Defaults to <code>cn</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">emailAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attribute which contains the email of the account. Default to <code>email</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupAttribute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple attribute name which contains the groups the account belong to.
  Defaults to <code>memberOf</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">groupFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When getting the list of groups for an account, filter this list using the
  <code>OU</code> attribute of the group. Defaults to blank (no filtering)</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When <a href="#dsl-config-getLdapSettings"><em>getting</em></a> the LDAP settings,
           the <code>password</code> field is always returned as an empty string.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, to set the LDAP settings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.config.ldapSettings = [
        enabled     : true,
        url         : 'ldaps://ldap.company.com:636',
        searchBase  : 'dc=company,dc=com',
        searchFilter: '(sAMAccountName={0})',
        user        : 'service',
        password    : 'secret',
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dsl-predefinedpromotionlevel"><a class="anchor" href="#dsl-predefinedpromotionlevel"></a>9.8.14. PredefinedPromotionLevel</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-predefinedpromotionlevel-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedpromotionlevel-getImage"><code>getImage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Document getImage()</code>
</p><p class="tableblock">Downloads the image for the promotion level. See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedpromotionlevel-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o)</code>
</p><p class="tableblock">Sets the image for this validation stamp (must be a PNG file). See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-predefinedpromotionlevel-getImage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getImage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Document getImage()</code></p>
</div>
<div class="paragraph">
<p>Downloads the image for the promotion level. See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-document">Document</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-predefinedpromotionlevel-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o)</code></p>
</div>
<div class="paragraph">
<p>Sets the image for this validation stamp (must be a PNG file). See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-predefinedvalidationstamp"><a class="anchor" href="#dsl-predefinedvalidationstamp"></a>9.8.15. PredefinedValidationStamp</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<table id="dsl-predefinedvalidationstamp-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedvalidationstamp-getImage"><code>getImage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Document getImage()</code>
</p><p class="tableblock">Downloads the image for the validation stamp. See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-predefinedvalidationstamp-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o)</code>
</p><p class="tableblock">Sets the image for this validation stamp (must be a PNG file). See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-predefinedvalidationstamp-getImage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getImage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Document getImage()</code></p>
</div>
<div class="paragraph">
<p>Downloads the image for the validation stamp. See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-document">Document</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-predefinedvalidationstamp-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o)</code></p>
</div>
<div class="paragraph">
<p>Sets the image for this validation stamp (must be a PNG file). See <a href="#dsl-usecases-images">DSL Images and documents</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-project"><a class="anchor" href="#dsl-project"></a>9.8.16. Project</h4>
<div class="paragraph">
<p>The project is the main <a href="#model">entity</a> of Ontrack.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">// Getting a project
def project = ontrack.project('project')
project {
   // Creates a branch for the project
   branch('1.0')
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<div class="paragraph">
<p>Go to the <a href="#dsl-project-methods">methods</a></p>
</div>
<table id="dsl-project-properties" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration properties</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>See also: <a href="#dsl-projectentityproperties">ProjectEntityProperties</a></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration property summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-autoPromotionLevel"><code>autoPromotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object autoPromotionLevel(boolean autoCreate = true)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-autoValidationStamp"><code>autoValidationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object autoValidationStamp(boolean autoCreate = true, boolean autoCreateIfNotPredefined = false)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getAutoPromotionLevel"><code>getAutoPromotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getAutoPromotionLevel()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getAutoValidationStamp"><code>getAutoValidationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getAutoValidationStamp()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getGit"><code>getGit</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getGit()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getGitLab"><code>getGitLab</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getGitLab()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getJiraFollowLinks"><code>getJiraFollowLinks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;String&gt; getJiraFollowLinks()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getStale"><code>getStale</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getStale()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getStash"><code>getStash</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getStash()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-getSvn"><code>getSvn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getSvn()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-git"><code>git</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object git(String name)</code>
</p><p class="tableblock">Configures the project for Git.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-gitHub"><code>gitHub</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitHub(Map parameters, String name)</code>
</p><p class="tableblock">Configures the project for GitHub.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-gitLab"><code>gitLab</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object gitLab(Map parameters, String name)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-jiraFollowLinks-collection"><code>jiraFollowLinks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jiraFollowLinks(Collection linkNames)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-jiraFollowLinks"><code>jiraFollowLinks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jiraFollowLinks(String[] linkNames)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-stale"><code>stale</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object stale(int disablingDuration = 0, int deletingDuration = 0, List promotionsToKeep = [])</code>
</p><p class="tableblock">Setup of stale branches management.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-stash"><code>stash</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object stash(String name, String project, String repository, int indexationInterval = 0, String issueServiceConfigurationIdentifier = '')</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectproperties-svn"><code>svn</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object svn(String name, String projectPath)</code>
</p><p class="tableblock">Configures the project for Subversion.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-stale" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: stale</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object stale(int disablingDuration = 0, int deletingDuration = 0, List promotionsToKeep = [])</code></p>
</div>
<div class="paragraph">
<p>Setup of stale branches management.</p>
</div>
<div class="paragraph">
<p><a href="#branches-stale">Stale branches</a> can be automatically disabled or even deleted.</p>
</div>
<div class="paragraph">
<p>To enable this property on a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project').config {
   stale 15, 30
}

def property = ontrack.project('project').config.stale
assert property.disablingDuration == 15
assert property.deletingDuration == 30
assert property.promotionsToKeep == []</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to make sure to keep branches which have been promoted to some levels. For example, if you want
to keep branches which have been promoted to <code>PRODUCTION</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project').config {
   stale 15, 30, ['PRODUCTION']
}

def property = ontrack.project('project').config.stale
assert property.disablingDuration == 15
assert property.deletingDuration == 30
assert property.promotionsToKeep == ['PRODUCTION']</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-gitLab" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: gitLab</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitLab(Map parameters, String name)</code></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getGitLab" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getGitLab</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getGitLab()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-gitLab">gitLab</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-gitHub" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: gitHub</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object gitHub(Map parameters, String name)</code></p>
</div>
<div class="paragraph">
<p>Configures the project for GitHub.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-stash" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: stash</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object stash(String name, String project, String repository, int indexationInterval = 0, String issueServiceConfigurationIdentifier = '')</code></p>
</div>
<div class="paragraph">
<p>Associates the project with the <a href="#usage-bitbucket">BitBucket configuration</a> with the given <code>name</code> and specifies
the project in BitBucket and the repository.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jira 'MyJIRA', 'https://jira.example.com', 'user', 'password'
   stash 'MyStash', repository: 'https://stash.example.com', 'user', 'password'
}
ontrack.project('project') {
   config {
       stash 'MyStash', 'PROJECT', 'my-repo', 30, "jira//MyJIRA"
   }
}
assert ontrack.project('project').config.stash.configuration.name == 'MyStash'
assert ontrack.project('project').config.stash.project == 'PROJECT'
assert ontrack.project('project').config.stash.repository == 'my-repo'
assert ontrack.project('project').config.stash.indexationInterval == 30
assert ontrack.project('project').config.stash.issueServiceConfigurationIdentifier == "jira//MyJIRA"
assert ontrack.project('project').config.stash.repositoryUrl == 'https://stash.example.com/projects/PROJECT/repos/my-repo'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getStash" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getStash</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getStash()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-stash">stash</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-git" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: git</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object git(String name)</code></p>
</div>
<div class="paragraph">
<p>Configures the project for Git.</p>
</div>
<div class="paragraph">
<p>Associates a project with a <a href="#usage-git">Git configuration</a>.</p>
</div>
<div class="paragraph">
<p><code>def git(String name)</code></p>
</div>
<div class="paragraph">
<p>Gets the associated Git configuration:</p>
</div>
<div class="paragraph">
<p><code>def getGit()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   git 'ontrack', remote: 'https://github.com/nemerosa/ontrack.git', user: 'test', password: 'secret'
}
ontrack.project('project') {
   config {
       git 'ontrack'
   }
}
def cfg = ontrack.project('project').config.git
assert cfg.configuration.name == 'ontrack'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getGit" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getGit</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getGit()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-git">git</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-svn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: svn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object svn(String name, String projectPath)</code></p>
</div>
<div class="paragraph">
<p>Configures the project for Subversion.</p>
</div>
<div class="paragraph">
<p>To associate a project with an existing <a href="#dsl-config-svn">Subversion configuration</a>:</p>
</div>
<div class="paragraph">
<p><code>def svn (String name, String projectPath)</code></p>
</div>
<div class="paragraph">
<p>To get the SVN project configuration:</p>
</div>
<div class="paragraph">
<p><code>def getSvn()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
       svn 'myconfig', '/project/trunk'
   }
}
def cfg = ontrack.project('project').config.svn
assert cfg.configuration.name == 'myconfig'
assert cfg.projectPath == '/project/trunk'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getSvn" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getSvn</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getSvn()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-svn">svn</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getStale" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getStale</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getStale()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-stale">stale</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-jiraFollowLinks-collection" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: jiraFollowLinks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jiraFollowLinks(Collection linkNames)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-jiraFollowLinks">jiraFollowLinks</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-jiraFollowLinks" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: jiraFollowLinks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jiraFollowLinks(String[] linkNames)</code></p>
</div>
<div class="paragraph">
<p>Links between <a href="#usage-jira">JIRA issues</a> can be followed when getting information about issues.</p>
</div>
<div class="paragraph">
<p>The links to follow can be configured at the project&#8217;s level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>def jiraFollowLinks(String&#8230;&#8203; linkNames)</code></p>
</li>
<li>
<p><code>def jiraFollowLinks(Collection&lt;String&gt; linkNames)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The list of links to follow is accessible through:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>List&lt;String&gt; getJiraFollowLinks()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
       jiraFollowLinks 'Clones', 'Depends'
   }
}
assert ontrack.project('project').config.jiraFollowLinks == ['Clones', 'Depends']</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getJiraFollowLinks" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getJiraFollowLinks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;String&gt; getJiraFollowLinks()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-jiraFollowLinks">jiraFollowLinks</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-autoValidationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: autoValidationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object autoValidationStamp(boolean autoCreate = true, boolean autoCreateIfNotPredefined = false)</code></p>
</div>
<div class="paragraph">
<p>Validation stamps can be <a href="#validation-stamps-auto">automatically created</a> for a branch, from a list of predefined
validation stamps, if the "Auto validation stamps" property is enabled on a project.</p>
</div>
<div class="paragraph">
<p>To enable this property on a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
      autoValidationStamp()
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
      autoValidationStamp(true)
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also edit the property so that a validation stamp is created even when
<a href="#validation-stamps-auto-creation-if-not-predefined">no predefined validation stamp</a>
does exit. In this case, the validation stamp will be created with the required name and without any image. To
enable this feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
      autoValidationStamp(true, true)
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the value of this property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">boolean auto = ontrack.project('project').autoValidationStamp</code></pre>
</div>
</div>
<div class="paragraph">
<p>The list of predefined validation stamps is accessible using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def stamps = ontrack.config.predefinedValidationStamps</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item contains the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code></p>
</li>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>description</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Its image is accessible through the <code>image</code> property.</p>
</div>
<div class="paragraph">
<p>In order to create/update predefined validation stamps, use the following method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.config.predefinedValidationStamp('VS') {
   image new File('my/image.png')
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You need Administrator rights to be able to update the predefined validation stamps.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getAutoValidationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getAutoValidationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean getAutoValidationStamp()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoValidationStamp">autoValidationStamp</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-autoPromotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: autoPromotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object autoPromotionLevel(boolean autoCreate = true)</code></p>
</div>
<div class="paragraph">
<p>Promotion levels can be <a href="#promotion-levels-auto-creation">automatically created</a> for a branch, from a list of
predefined promotion levels, if the "Auto promotion levels" property is enabled on a project.</p>
</div>
<div class="paragraph">
<p>To enable this property on a project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
      autoPromotionLevel()
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
      autoPromotionLevel(true)
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get the value of this property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">boolean auto = ontrack.project('project').autoPromotionLevel</code></pre>
</div>
</div>
<div class="paragraph">
<p>The list of predefined promotion levels is accessible using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def stamps = ontrack.config.predefinedPromotionLevels</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item contains the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code></p>
</li>
<li>
<p><code>name</code></p>
</li>
<li>
<p><code>description</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Its image is accessible through the <code>image</code> property.</p>
</div>
<div class="paragraph">
<p>In order to create/update predefined promotion levels, use the following method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.config.predefinedPromotionLevel('VS') {
   image new File('my/image.png')
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You need Administrator rights to be able to update the predefined promotion levels.
</td>
</tr>
</table>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectproperties-getAutoPromotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getAutoPromotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean getAutoPromotionLevel()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectproperties-autoPromotionLevel">autoPromotionLevel</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-project-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-branch"><code>branch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Branch branch(String name, String description = '', boolean getIfExists = false)</code>
</p><p class="tableblock">Retrieves or creates a branch for the project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-branch-closure"><code>branch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Branch branch(String name, String description = '', boolean getIfExists = false, Closure closure)</code>
</p><p class="tableblock">Retrieves or creates a branch for the project, and then configures it.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-getBranches"><code>getBranches</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Branch&gt; getBranches()</code>
</p><p class="tableblock">Gets the list of branches for the project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-getConfig"><code>getConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ProjectProperties getConfig()</code>
</p><p class="tableblock">Access to the project properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-project-search"><code>search</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;Build&gt; search(Map form)</code>
</p><p class="tableblock">Searches for builds in the project.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-project-branch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">branch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Branch branch(String name, String description = '', boolean getIfExists = false)</code></p>
</div>
<div class="paragraph">
<p>Retrieves or creates a branch for the project</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-branch">Branch</a>
If the branch already exists, the <code>getIfExists</code> parameter is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>if <code>false</code> (default), an error is thrown</p>
</li>
<li>
<p>if <code>true</code>, the existing branch is returned</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the branch does not exist, it is created.</p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('test')
def branch = project.branch('new-branch')</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-project-branch-closure" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">branch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Branch branch(String name, String description = '', boolean getIfExists = false, Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Retrieves or creates a branch for the project, and then configures it.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-branch">Branch</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-project-getBranches" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getBranches</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Branch&gt; getBranches()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of branches for the project.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-branch">Branch</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-project-getConfig" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getConfig</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>ProjectProperties getConfig()</code></p>
</div>
<div class="paragraph">
<p>Access to the project properties</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-project-search" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">search</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;Build&gt; search(Map form)</code></p>
</div>
<div class="paragraph">
<p>Searches for builds in the project.</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-build">Build</a>
Possible options are:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parameter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maximumCount</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of results to return</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>branchName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression for the branch a build belong to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buildName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regular expression for the build name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>buildExactMatch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Considers the <code>buildName</code> as being an exact match, and
  not a regular expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>promotionName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a promotion level a build is promoted to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>validationStampName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of a validation stamp a build has been validated
  to with status <code>PASSED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">??none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>property</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Qualified name of a property that the build must have</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>propertyValue</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Together with <code>property</code>, refines the filter by checking
  the value of the build property. The way the value is matched with the actual
  value depends on the property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedFrom</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects builds which are <em>linked from</em> the build selected by
  the criteria. See <a href="#builds-links">Build links</a> for the exact syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>linkedTo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selects builds which are <em>linked to</em> the build selected by the
  criteria. See <a href="#builds-links">Build links</a> for the exact syntax.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example of build searches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('project')
def builds = project.search()
def build = project.search(maximumCount: 1)[0]
def build = project.search(promotionName: 'BRONZE', maximumCount: 1)[0]
ontrack.project('project') {
   branch 'MyBranch'
}
assert ontrack.project('project').branches.find { it.name == 'MyBranch' }</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-projectentityproperties"><a class="anchor" href="#dsl-projectentityproperties"></a>9.8.17. ProjectEntityProperties</h4>
<table id="dsl-projectentityproperties-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-getJenkinsBuild"><code>getJenkinsBuild</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getJenkinsBuild()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-getJenkinsJob"><code>getJenkinsJob</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getJenkinsJob()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-getLinks"><code>getLinks</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Map&lt;String,String&gt; getLinks()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-getMessage"><code>getMessage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getMessage()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-getMetaInfo"><code>getMetaInfo</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>List&lt;MetaInfo&gt; getMetaInfo()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-jenkinsBuild"><code>jenkinsBuild</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jenkinsBuild(String configuration, String job, int build)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-jenkinsJob"><code>jenkinsJob</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object jenkinsJob(String configuration, String job)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-links"><code>links</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object links(Map links)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-message"><code>message</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object message(String text, String type = 'INFO')</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-metaInfo-name"><code>metaInfo</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object metaInfo(String name, String value, String link = null, String category = null)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-metaInfo"><code>metaInfo</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object metaInfo(Map map)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-property"><code>property</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object property(String type, Map data)</code>
</p><p class="tableblock">Sets a property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-projectentityproperties-property-get"><code>property</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object property(String type, boolean required = true)</code></p></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-getJenkinsBuild" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getJenkinsBuild</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getJenkinsBuild()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-jenkinsBuild">jenkinsBuild</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-getJenkinsJob" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getJenkinsJob</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getJenkinsJob()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-jenkinsJob">jenkinsJob</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-getLinks" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getLinks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Map&lt;String,String&gt; getLinks()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-links">links</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-getMessage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getMessage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getMessage()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-message">message</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-getMetaInfo" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getMetaInfo</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>List&lt;MetaInfo&gt; getMetaInfo()</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-metaInfo">metaInfo</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-jenkinsBuild" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">jenkinsBuild</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jenkinsBuild(String configuration, String job, int build)</code></p>
</div>
<div class="paragraph">
<p>For builds, promotion runs and validation runs, it is possible to attach a reference to a Jenkins build:</p>
</div>
<div class="paragraph">
<p><code>def jenkinsBuild(String configuration, String job, int buildNumber)</code></p>
</div>
<div class="paragraph">
<p>or to get the build reference:</p>
</div>
<div class="paragraph">
<p><code>def getJenkinsBuild()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jenkins 'Jenkins', 'http://jenkins'
}
def name = uid('P')
def project = ontrack.project(name)
def branch = project.branch('test') {
   promotionLevel('COPPER')
   validationStamp('TEST')
}
def build = branch.build('1') {
   config {
       jenkinsBuild 'Jenkins', 'MyBuild', 1
   }
   promote('COPPER') {
       config {
           jenkinsBuild 'Jenkins', 'MyPromotion', 1
       }
   }
   validate('TEST') {
       config {
           jenkinsBuild 'Jenkins', 'MyValidation', 1
       }
   }
}

def j = ontrack.build(name, 'test', '1').config.jenkinsBuild
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyBuild'
assert j.build == 1
assert j.url == 'http://jenkins/job/MyBuild/1'


j = ontrack.build(name, 'test', '1').promotionRuns[0].config.jenkinsBuild
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyPromotion'
assert j.build == 1
assert j.url == 'http://jenkins/job/MyPromotion/1'


j = ontrack.build(name, 'test', '1').validationRuns[0].config.jenkinsBuild
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyValidation'
assert j.build == 1
assert j.url == 'http://jenkins/job/MyValidation/1'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <a href="https://wiki.jenkins-ci.org/display/JENKINS/CloudBees+Folders+Plugin">Jenkins folders</a> are supported by
giving the full job name. For example, the job name to give to the job in <em>A &gt; B &gt; C</em> would be <code>A/job/B/job/C</code> or
even <code>A/B/C</code>.</p>
</div>
<div class="paragraph">
<p>See also the <a href="#dsl-projectEntityProperties-jenkinsJob">Jenkins job property</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-jenkinsJob" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">jenkinsJob</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object jenkinsJob(String configuration, String job)</code></p>
</div>
<div class="paragraph">
<p>Projects, branches, promotion levels and validation stamps can have a reference to a Jenkins job:</p>
</div>
<div class="paragraph">
<p><code>def jenkinsJob(String configuration, String job)</code></p>
</div>
<div class="paragraph">
<p>or to get the job reference:</p>
</div>
<div class="paragraph">
<p><code>def getJenkinsJob()</code></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.configure {
   jenkins 'Jenkins', 'http://jenkins'
}
ontrack.project('project') {
   config {
       jenkinsJob 'Jenkins', 'MyProject'
   }
   branch('test') {
       config {
           jenkinsJob 'Jenkins', 'MyBranch'
       }
       promotionLevel('COPPER') {
           config {
               jenkinsJob 'Jenkins', 'MyPromotion'
           }
       }
       validationStamp('TEST') {
           config {
               jenkinsJob 'Jenkins', 'MyValidation'
           }
       }
   }
}

def j = ontrack.project('project').config.jenkinsJob
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyProject'
assert j.url == 'http://jenkins/job/MyProject'

j = ontrack.branch('project', 'test').config.jenkinsJob
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyBranch'
assert j.url == 'http://jenkins/job/MyBranch'

j = ontrack.promotionLevel('project', 'test', 'COPPER').config.jenkinsJob
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyPromotion'
assert j.url == 'http://jenkins/job/MyPromotion'

j = ontrack.validationStamp('project', 'test', 'TEST').config.jenkinsJob
assert j.configuration.name == 'Jenkins'
assert j.job == 'MyValidation'
assert j.url == 'http://jenkins/job/MyValidation'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that <a href="https://wiki.jenkins-ci.org/display/JENKINS/CloudBees+Folders+Plugin">Jenkins folders</a> are supported by giving
the full job name. For example, the job name to give to the job in <em>A &gt; B &gt; C</em> would be <code>A/job/B/job/C</code> or even <code>A/B/C</code>.</p>
</div>
<div class="paragraph">
<p>See also the <a href="#dsl-projectEntityProperties-jenkinsBuild">Jenkins build property</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-links" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">links</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object links(Map links)</code></p>
</div>
<div class="paragraph">
<p>Arbitrary named links can be associated with projects, branches, etc.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('project') {
   config {
       links 'project': 'http://project'
   }
   branch('test') {
       config {
           links 'branch': 'http://branch'
       }
       build('1') {
           config {
               links 'build': 'http://build'
           }
       }
   }
}
assert ontrack.project('project').config.links.project == 'http://project'
assert ontrack.branch('project', 'test').config.links.branch == 'http://branch'
assert ontrack.build('project', 'test', '1').config.links.build == 'http://build'</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-message" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">message</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object message(String text, String type = 'INFO')</code></p>
</div>
<div class="paragraph">
<p>An arbitrary message, together with a message type, can be associated with any <a href="#model">entity</a>.</p>
</div>
<div class="paragraph">
<p>To set the message on any entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">entity.message(String text, String type = 'INFO')</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following types of messages are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>INFO</code></p>
</li>
<li>
<p><code>WARNING</code></p>
</li>
<li>
<p><code>ERROR</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, on a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.build('project', 'branch', '1').config {
   message 'My message', 'WARNING'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get a message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def msg = ontrack.build('project', 'branch', '1').config.message
assert msg.type == 'WARNING'
assert msg.text == 'My message'</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#property-message">Message property</a> for more details about this property.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-metaInfo-name" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">metaInfo</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object metaInfo(String name, String value, String link = null, String category = null)</code></p>
</div>
<div class="paragraph">
<p>See <a href="#dsl-projectentityproperties-metaInfo">metaInfo</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-metaInfo" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">metaInfo</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object metaInfo(Map map)</code></p>
</div>
<div class="paragraph">
<p>Arbitrary <a href="#property-meta">meta information properties</a> can be associated with any <a href="#model">entity</a>.</p>
</div>
<div class="paragraph">
<p>To set a list of meta information properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">entity.config {
   metaInfo A: '1', B: '2'
}</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
This method does not allow to set links and will erase any previous meta information.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following method is the preferred one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.build('project', 'branch', '1').config {
   metaInfo 'name1', 'value1'
   metaInfo 'name2', 'value2', 'http://link2'
   metaInfo 'name3', 'value3', 'http://link3', 'Category'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows to keep any previous meta information property and to specify links if needed.</p>
</div>
<div class="paragraph">
<p>To get the meta information, for example on the previous build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def list = ontrack.build('project', 'branch', '1').config.metaInfo
assert list.size() == 3
assert list[0].name = 'name1'
assert list[0].value = 'value1'
assert list[0].link = null
assert list[0].category = null
assert list[1].name = 'name2'
assert list[1].value = 'value2'
assert list[1].link = 'http://link2'
assert list[1].category = null
assert list[2].name = 'name3'
assert list[2].value = 'value3'
assert list[2].link = 'http://link3'
assert list[2].category = 'Category'</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#property-meta">Meta information property</a> for more details about this property.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-property" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object property(String type, Map data)</code></p>
</div>
<div class="paragraph">
<p>Sets a property.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-projectentityproperties-property-get" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">property</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object property(String type, boolean required = true)</code></p>
</div>
<div class="paragraph">
<p>Gets a property on the project entity.</p>
</div>
<div class="paragraph">
<p>If <code>required</code> is set to <code>false</code> and if the property does not exist or is not set, <code>null</code> will be returned.</p>
</div>
<div class="paragraph">
<p>If <code>required</code> is set to <code>true</code> and if the property does not exist or is not set, a
<code>net.nemerosa.ontrack.dsl.PropertyNotFoundException</code> is thrown.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def project = ontrack.project('PRJ')
def value = project.getProperty('com.my.UnsetPropertyType', false)
assert value == null</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-promotionlevel"><a class="anchor" href="#dsl-promotionlevel"></a>9.8.18. PromotionLevel</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<div class="paragraph">
<p>Go to the <a href="#dsl-promotionlevel-methods">methods</a></p>
</div>
<table id="dsl-promotionlevel-properties" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration properties</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Builds can be <a href="#promotion-levels-auto-promotion">auto promoted</a> to a <a href="#model">promotion level</a> when this latter is
configured to do so.</p>
</div>
<div class="paragraph">
<p>A promotion level is configured for auto promotion using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.promotionLevel('project', 'branch', 'promotionLevel').config {
   autoPromotion 'VS1', 'VS2'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>VS1</code>, <code>VS2</code> are the <a href="#model">validation stamps</a> which must be <code>PASSED</code> in order to promote a build automatically.</p>
</div>
<div class="paragraph">
<p>To get the list of validation stamps for the auto promotion of a promotion level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def validationStamps = ontrack.promotionLevel('project', 'branch', 'promotionLevel')
   .config
   .autoPromotion
   .validationStamps</code></pre>
</div>
</div>
<div class="paragraph">
<p>The validation stamps used to define an auto promotion can also be defined using regular expressions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.promotionLevel('project', 'branch', 'promotionLevel').config {
   autoPromotion [], 'VS.*'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this sample, all validation stamps whose name starts with <code>VS</code> will participate in the promotion.</p>
</div>
<div class="paragraph">
<p>You can also exclude validation stamps using their name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.promotionLevel('project', 'branch', 'promotionLevel').config {
   autoPromotion [], 'VS.*', 'VS/.1'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this sample, all validation stamps whose name starts with <code>VS</code> will participate in the promotion, but for the
<code>VS.1</code> one.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-projectentityproperties">ProjectEntityProperties</a></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Configuration property summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevelproperties-autoPromotion"><code>autoPromotion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object autoPromotion(String[] validationStamps)</code>
</p><p class="tableblock">Sets the validation stamps participating into the auto promotion.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevelproperties-autoPromotion"><code>autoPromotion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object autoPromotion(Collection validationStamps, String include = '', String exclude = '')</code>
</p><p class="tableblock">Sets the validation stamps participating into the auto promotion, and sets the include/exclude settings.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevelproperties-getAutoPromotion"><code>getAutoPromotion</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>boolean getAutoPromotion()</code>
</p><p class="tableblock">Checks if the promotion level is set in auto promotion.</p></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevelproperties-autoPromotion" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: autoPromotion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object autoPromotion(String[] validationStamps)</code></p>
</div>
<div class="paragraph">
<p>Sets the validation stamps participating into the auto promotion.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevelproperties-autoPromotion" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: autoPromotion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object autoPromotion(Collection validationStamps, String include = '', String exclude = '')</code></p>
</div>
<div class="paragraph">
<p>Sets the validation stamps participating into the auto promotion, and sets the include/exclude settings.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevelproperties-getAutoPromotion" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration: getAutoPromotion</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>boolean getAutoPromotion()</code></p>
</div>
<div class="paragraph">
<p>Checks if the promotion level is set in auto promotion.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-call"><code>call</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object call(Closure closure)</code>
</p><p class="tableblock">Configuration of the promotion level with a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-getAutoPromotionPropertyDecoration"><code>getAutoPromotionPropertyDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Boolean getAutoPromotionPropertyDecoration()</code>
</p><p class="tableblock">Checks if this promotion level is set in <a href="#promotion-levels-auto-promotion">auto decoration mode</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-getBranch"><code>getBranch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getBranch()</code>
</p><p class="tableblock">Name of the associated branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-getConfig"><code>getConfig</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PromotionLevelProperties getConfig()</code>
</p><p class="tableblock">Access to the promotion level properties</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-getImage"><code>getImage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Document getImage()</code>
</p><p class="tableblock">Gets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-getProject"><code>getProject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getProject()</code>
</p><p class="tableblock">Name of the associated project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o)</code>
</p><p class="tableblock">Sets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionlevel-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o, String contentType)</code>
</p><p class="tableblock">Sets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-call" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">call</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object call(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configuration of the promotion level with a closure.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-getAutoPromotionPropertyDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAutoPromotionPropertyDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Boolean getAutoPromotionPropertyDecoration()</code></p>
</div>
<div class="paragraph">
<p>Checks if this promotion level is set in <a href="#promotion-levels-auto-promotion">auto decoration mode</a>.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-getBranch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getBranch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getBranch()</code></p>
</div>
<div class="paragraph">
<p>Name of the associated branch.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-getConfig" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getConfig</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>PromotionLevelProperties getConfig()</code></p>
</div>
<div class="paragraph">
<p>Access to the promotion level properties</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-getImage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getImage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Document getImage()</code></p>
</div>
<div class="paragraph">
<p>Gets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-document">Document</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-getProject" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProject</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getProject()</code></p>
</div>
<div class="paragraph">
<p>Name of the associated project.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o)</code></p>
</div>
<div class="paragraph">
<p>Sets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionlevel-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o, String contentType)</code></p>
</div>
<div class="paragraph">
<p>Sets the promotion level image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-promotionrun"><a class="anchor" href="#dsl-promotionrun"></a>9.8.19. PromotionRun</h4>
<div class="paragraph">
<p>You can get a promotion run by promoting a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def run = ontrack.build('project', 'branch', '1').promote('BRONZE')
assert run.promotionLevel.name == 'BRONZE'</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by getting the list of promotion runs for a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def runs = ontrack.build('project', 'branch', '1').promotionRuns
assert runs.size() == 1
assert runs[0].promotionLevel.name == 'BRONZE'</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<table id="dsl-promotionrun-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-promotionrun-getPromotionLevel"><code>getPromotionLevel</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getPromotionLevel()</code>
</p><p class="tableblock">Gets the associated promotion level (JSON)</p></td>
</tr>
</tbody>
</table>
<table id="dsl-promotionrun-getPromotionLevel" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPromotionLevel</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getPromotionLevel()</code></p>
</div>
<div class="paragraph">
<p>Gets the associated promotion level (JSON)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-searchresult"><a class="anchor" href="#dsl-searchresult"></a>9.8.20. SearchResult</h4>
<div class="paragraph">
<p>The <code>SearchResult</code> class is used for listing the results of a <a href="#dsl-ontrack-search">search</a>.</p>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractresource">AbstractResource</a></p>
</div>
<div class="paragraph">
<p>Sample:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ontrack.project('prj')
def results = ontrack.search('prj')
assert results.size() == 1
assert results[0].title == 'Project prj'
assert results[0].page == 'https://host/#/project/1'
assert results[0].page == 'https://host/#/project/1'</code></pre>
</div>
</div>
<table id="dsl-searchresult-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-getAccuracy"><code>getAccuracy</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>int getAccuracy()</code>
</p><p class="tableblock">Gets a percentage of accuracy about the result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-getDescription"><code>getDescription</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getDescription()</code>
</p><p class="tableblock">Gets a description for the search result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-getPage"><code>getPage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getPage()</code>
</p><p class="tableblock">Gets the URI to display the search result details (Web).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-getTitle"><code>getTitle</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getTitle()</code>
</p><p class="tableblock">Gets the display name for the search result.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-searchresult-getUri"><code>getUri</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getUri()</code>
</p><p class="tableblock">Gets the URI to access the search result details (API).</p></td>
</tr>
</tbody>
</table>
<table id="dsl-searchresult-getAccuracy" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getAccuracy</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>int getAccuracy()</code></p>
</div>
<div class="paragraph">
<p>Gets a percentage of accuracy about the result.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-searchresult-getDescription" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getDescription</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getDescription()</code></p>
</div>
<div class="paragraph">
<p>Gets a description for the search result.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-searchresult-getPage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getPage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getPage()</code></p>
</div>
<div class="paragraph">
<p>Gets the URI to display the search result details (Web).</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-searchresult-getTitle" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getTitle</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getTitle()</code></p>
</div>
<div class="paragraph">
<p>Gets the display name for the search result.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-searchresult-getUri" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getUri</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getUri()</code></p>
</div>
<div class="paragraph">
<p>Gets the URI to access the search result details (API).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-validationrun"><a class="anchor" href="#dsl-validationrun"></a>9.8.21. ValidationRun</h4>
<div class="paragraph">
<p>You can get a validation run by validating a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def run = ontrack.build(branch.project, branch.name, '2').validate('SMOKE', 'FAILED')
assert run.validationStamp.name == 'SMOKE'
assert run.validationRunStatuses[0].statusID.id == 'FAILED'
assert run.validationRunStatuses[0].statusID.name == 'Failed'
assert run.status == 'FAILED'</code></pre>
</div>
</div>
<div class="paragraph">
<p>or by getting the list of validation runs for a build:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">def runs = ontrack.build(branch.project, branch.name, '2').validationRuns
assert runs.size() == 1
assert runs[0].validationStamp.name == 'SMOKE'
assert runs[0].validationRunStatuses[0].statusID.id == 'FAILED'
assert runs[0].status == 'FAILED'</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<table id="dsl-validationrun-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationrun-getStatus"><code>getStatus</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getStatus()</code>
</p><p class="tableblock">Gets the status for this validation run.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationrun-getValidationRunStatuses"><code>getValidationRunStatuses</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getValidationRunStatuses()</code>
</p><p class="tableblock">Gets the list of statuses (JSON)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationrun-getValidationStamp"><code>getValidationStamp</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getValidationStamp()</code>
</p><p class="tableblock">Gets the associated validation stamp (JSON)</p></td>
</tr>
</tbody>
</table>
<table id="dsl-validationrun-getStatus" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getStatus</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getStatus()</code></p>
</div>
<div class="paragraph">
<p>Gets the status for this validation run.</p>
</div>
<div class="paragraph">
<p>Possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DEFECTIVE</p>
</li>
<li>
<p>EXPLAINED</p>
</li>
<li>
<p>FAILED</p>
</li>
<li>
<p>FIXED</p>
</li>
<li>
<p>INTERRUPTED</p>
</li>
<li>
<p>INVESTIGATING</p>
</li>
<li>
<p>PASSED</p>
</li>
<li>
<p>WARNING</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationrun-getValidationRunStatuses" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getValidationRunStatuses</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getValidationRunStatuses()</code></p>
</div>
<div class="paragraph">
<p>Gets the list of statuses (JSON)</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationrun-getValidationStamp" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getValidationStamp</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getValidationStamp()</code></p>
</div>
<div class="paragraph">
<p>Gets the associated validation stamp (JSON)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="dsl-validationstamp"><a class="anchor" href="#dsl-validationstamp"></a>9.8.22. ValidationStamp</h4>
<div class="paragraph">
<p>See also: <a href="#dsl-abstractprojectresource">AbstractProjectResource</a></p>
</div>
<table id="dsl-validationstamp-methods" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top" colspan="2"><p class="tableblock">Method summary</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-call"><code>call</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object call(Closure closure)</code>
</p><p class="tableblock">Configuration of the promotion level with a closure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-getBranch"><code>getBranch</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getBranch()</code>
</p><p class="tableblock">Name of the associated branch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-getImage"><code>getImage</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Document getImage()</code>
</p><p class="tableblock">Gets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-getProject"><code>getProject</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String getProject()</code>
</p><p class="tableblock">Name of the associated project.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-getValidationStampWeatherDecoration"><code>getValidationStampWeatherDecoration</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object getValidationStampWeatherDecoration()</code>
</p><p class="tableblock">Gets the validation stamp weather decoration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o)</code>
</p><p class="tableblock">Sets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#dsl-validationstamp-image"><code>image</code></a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Object image(Object o, String contentType)</code>
</p><p class="tableblock">Sets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-call" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">call</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object call(Closure closure)</code></p>
</div>
<div class="paragraph">
<p>Configuration of the promotion level with a closure.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-getBranch" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getBranch</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getBranch()</code></p>
</div>
<div class="paragraph">
<p>Name of the associated branch.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-getImage" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getImage</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Document getImage()</code></p>
</div>
<div class="paragraph">
<p>Gets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div>
<div class="paragraph">
<p>See: <a href="#dsl-document">Document</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-getProject" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getProject</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>String getProject()</code></p>
</div>
<div class="paragraph">
<p>Name of the associated project.</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-getValidationStampWeatherDecoration" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">getValidationStampWeatherDecoration</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object getValidationStampWeatherDecoration()</code></p>
</div>
<div class="paragraph">
<p>Gets the validation stamp weather decoration.</p>
</div>
<div class="paragraph">
<p>The "weather" of the validation stamp is the status of the last 4 builds having been validated for this
validation stamp on the corresponding branch.</p>
</div>
<div class="paragraph">
<p>The returned object contains two attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>weather</code> which can have one of the following values:</p>
<div class="ulist">
<ul>
<li>
<p><code>sunny</code></p>
</li>
<li>
<p><code>sunAndClouds</code></p>
</li>
<li>
<p><code>clouds</code></p>
</li>
<li>
<p><code>rain</code></p>
</li>
<li>
<p><code>storm</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>text</code> - a display text for the weather type</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o)</code></p>
</div>
<div class="paragraph">
<p>Sets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div></div></td>
</tr>
</tbody>
</table>
<table id="dsl-validationstamp-image" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>Object image(Object o, String contentType)</code></p>
</div>
<div class="paragraph">
<p>Sets the validation stamp image (see <a href="#dsl-usecases-images">DSL Images and documents</a>)</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-10-25 21:04:13 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>prettyPrint()</script>
</body>
</html>